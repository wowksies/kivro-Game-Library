"use strict";(()=>{var xc=Object.create;var ti=Object.defineProperty;var kc=Object.getOwnPropertyDescriptor;var Sc=Object.getOwnPropertyNames;var Tc=Object.getPrototypeOf,Rc=Object.prototype.hasOwnProperty;var Cc=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),Ac=(s,e)=>{for(var t in e)ti(s,t,{get:e[t],enumerable:!0})},Ic=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Sc(e))!Rc.call(s,i)&&i!==t&&ti(s,i,{get:()=>e[i],enumerable:!(r=kc(e,i))||r.enumerable});return s};var Pc=(s,e,t)=>(t=s!=null?xc(Tc(s)):{},Ic(e||!s||!s.__esModule?ti(t,"default",{value:s,enumerable:!0}):t,s));var Yl=Cc((qp,jr)=>{"use strict";jr.exports=oa;jr.exports.isMobile=oa;jr.exports.default=oa;var Cd=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,Ad=/CrOS/,Id=/android|ipad|playbook|silk/i;function oa(s){s||(s={});let e=s.ua;if(!e&&typeof navigator<"u"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;let t=Cd.test(e)&&!Ad.test(e)||!!s.tablet&&Id.test(e);return!t&&s.tablet&&s.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(t=!0),t}});var Zs=class{shouldDeduplicate(){return!1}};var Yt=class{queue=[];timeout=null;BATCH_DELAY_MS=100;distinctId;sessionId;apiOrigin;deduplicationService;constructor(e){let{distinctId:t,sessionId:r,apiOrigin:i,deduplicationService:n}=e;this.distinctId=t,this.sessionId=r,this.apiOrigin=i,this.deduplicationService=n||new Zs,window.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&this.flush()})}logProjectEvent(e,t,r,i){if(this.deduplicationService.shouldDeduplicate("project",e,t))return;let n={project_id:e,type:t,attributes:r,...i&&{comment_id:i}};this.queue.push(n),this.scheduleBatch()}logPostEvent(e,t,r){this.deduplicationService.shouldDeduplicate("comment",e,t)||(this.queue.push({comment_id:e,type:t,attributes:r}),this.scheduleBatch())}scheduleBatch(){this.timeout===null&&(this.timeout=setTimeout(()=>this.flush(),this.BATCH_DELAY_MS))}async flush(){if(this.queue.length===0)return;let e=[...this.queue];this.queue=[],this.timeout&&(clearTimeout(this.timeout),this.timeout=null);let t={events:e.map(r=>({...r,attributes:{...r.attributes,$session_id:this.sessionId}})),distinct_id:this.distinctId};try{await fetch(`${this.apiOrigin}/api/v1/activity/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),keepalive:!0})}catch(r){console.error("Failed to send event batch:",r)}}};function wa(s){let e=new Yt(s),t=d=>Array.from(document.querySelectorAll("[w-pid]")).indexOf(d)+1,r=d=>{let h=d.closest("[w-fid]");if(!h)return;let p=Array.from(h.querySelectorAll("[w-pid]"));return{feed_id:h.getAttribute("w-fid")??"",rank:p.indexOf(d)+1}},i=(d,h)=>{let p=d.getAttribute("w-pid"),g=d.getAttribute("w-pver"),v=d.getAttribute("w-cid");if(p){let{feed_id:_,rank:S}=r(d)??{},O={rank_dom:t(d),rank_feed:S,feed_id:_,projectVersion:g},A=Object.fromEntries(Object.entries(O).filter(([I,M])=>M!==void 0));if(e.logProjectEvent(p,h,A,v||void 0),s.onDebugEvent){let I=v?{...A,comment_id:v}:A;s.onDebugEvent(h,p,I)}}},n=new IntersectionObserver(d=>{d.forEach(h=>{h.isIntersecting&&(i(h.target,"impression"),n.unobserve(h.target))})}),a=d=>{d.hasAttribute("w-pid")&&n.observe(d)},o=d=>{d.nodeType===Node.ELEMENT_NODE&&(a(d),d.childNodes.forEach(p=>{o(p)}))};document.querySelectorAll("[w-pid]").forEach(d=>{o(d)});let l=new MutationObserver(d=>{d.forEach(h=>{h.type==="childList"&&h.addedNodes.forEach(p=>{o(p)})})});l.observe(document,{childList:!0,subtree:!0});let c=new Set,u=d=>{let p=d.target.closest("[w-pid]"),g=p?.getAttribute("w-pid");p&&g&&(c.has(g)||(i(p,"impression_click"),c.add(g)))};return document.addEventListener("click",u,!0),()=>{n.disconnect(),l.disconnect(),document.removeEventListener("click",u,!0)}}var f=typeof window<"u"?window:void 0,de=typeof globalThis<"u"?globalThis:f,Ao=Array.prototype,Ea=Ao.forEach,xa=Ao.indexOf,me=de?.navigator,k=de?.document,ue=de?.location,gi=de?.fetch,vi=de!=null&&de.XMLHttpRequest&&"withCredentials"in new de.XMLHttpRequest?de.XMLHttpRequest:void 0,ka=de?.AbortController,ce=me?.userAgent,R=f??{},Je={DEBUG:!1,LIB_VERSION:"1.268.1"};function Sa(s,e,t,r,i,n,a){try{var o=s[n](a),l=o.value}catch(c){return void t(c)}o.done?e(l):Promise.resolve(l).then(r,i)}function Ta(s){return function(){var e=this,t=arguments;return new Promise(function(r,i){var n=s.apply(e,t);function a(l){Sa(n,r,i,a,o,"next",l)}function o(l){Sa(n,r,i,a,o,"throw",l)}a(void 0)})}}function b(){return b=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(s[r]=t[r])}return s},b.apply(null,arguments)}function Io(s,e){if(s==null)return{};var t={};for(var r in s)if({}.hasOwnProperty.call(s,r)){if(e.indexOf(r)!==-1)continue;t[r]=s[r]}return t}var Oc=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function N(s,e){return s.indexOf(e)!==-1}var Dr=function(s){return s.trim()},mi=function(s){return s.replace(/^\$/,"")},Dc=Array.isArray,Po=Object.prototype,Oo=Po.hasOwnProperty,Mr=Po.toString,z=Dc||function(s){return Mr.call(s)==="[object Array]"},we=s=>typeof s=="function",G=s=>s===Object(s)&&!z(s),Qt=s=>{if(G(s)){for(var e in s)if(Oo.call(s,e))return!1;return!0}return!1},y=s=>s===void 0,Z=s=>Mr.call(s)=="[object String]",_i=s=>Z(s)&&s.trim().length===0,Qe=s=>s===null,U=s=>y(s)||Qe(s),re=s=>Mr.call(s)=="[object Number]",Pe=s=>Mr.call(s)==="[object Boolean]",Mc=s=>s instanceof FormData,Lc=s=>N(Oc,s);function yi(s){return s===null||typeof s!="object"}function or(s,e){return Object.prototype.toString.call(s)==="[object "+e+"]"}function Do(s){return!y(Event)&&function(e,t){try{return e instanceof t}catch{return!1}}(s,Event)}var $c=[!0,"true",1,"1","yes"],si=s=>N($c,s),Nc=[!1,"false",0,"0","no"];function _e(s,e,t,r,i){return e>t&&(r.warn("min cannot be greater than max."),e=t),re(s)?s>t?(r.warn(" cannot be  greater than max: "+t+". Using max value instead."),t):s<e?(r.warn(" cannot be less than min: "+e+". Using min value instead."),e):s:(r.warn(" must be a number. using max or fallback. max: "+t+", fallback: "+i),_e(i||t,e,t,r))}var lr=class{stop(){this.t&&(clearInterval(this.t),this.t=void 0)}constructor(e){this.i=e,this.o={},this.h=()=>{Object.keys(this.o).forEach(t=>{var r=this.m(t)+this.S;r>=this.k?delete this.o[t]:this.$(t,r)})},this.m=t=>this.o[String(t)],this.$=(t,r)=>{this.o[String(t)]=r},this.consumeRateLimit=t=>{var r,i=(r=this.m(t))!=null?r:this.k;if((i=Math.max(i-1,0))===0)return!0;this.$(t,i);var n,a=i===0;return a&&((n=this.P)==null||n.call(this,t)),a},this.P=this.i.P,this.k=_e(this.i.bucketSize,0,100,this.i.I),this.S=_e(this.i.refillRate,0,this.k,this.i.I),this.R=_e(this.i.refillInterval,0,864e5,this.i.I),this.t=setInterval(()=>{this.h()},this.R)}},Ys,Ra,ri,Fc=s=>s instanceof Error;function jc(s){var e=globalThis._posthogChunkIds;if(e){var t=Object.keys(e);return ri&&t.length===Ra||(Ra=t.length,ri=t.reduce((r,i)=>{Ys||(Ys={});var n=Ys[i];if(n)r[n[0]]=n[1];else for(var a=s(i),o=a.length-1;o>=0;o--){var l=a[o],c=l?.filename,u=e[i];if(c&&u){r[c]=u,Ys[i]=[c,u];break}}return r},{})),ri}}var rs="?";function bi(s,e,t,r){var i={platform:"web:javascript",filename:s,function:e==="<anonymous>"?rs:e,in_app:!0};return y(t)||(i.lineno=t),y(r)||(i.colno=r),i}var Mo=(s,e)=>{var t=s.indexOf("safari-extension")!==-1,r=s.indexOf("safari-web-extension")!==-1;return t||r?[s.indexOf("@")!==-1?s.split("@")[0]:rs,t?"safari-extension:"+e:"safari-web-extension:"+e]:[s,e]},Uc=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Bc=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,qc=/\((\S*)(?::(\d+))(?::(\d+))\)/,Hc=s=>{var e=Uc.exec(s);if(e){var[,t,r,i]=e;return bi(t,rs,+r,+i)}var n=Bc.exec(s);if(n){if(n[2]&&n[2].indexOf("eval")===0){var a=qc.exec(n[2]);a&&(n[2]=a[1],n[3]=a[2],n[4]=a[3])}var[o,l]=Mo(n[1]||rs,n[2]);return bi(l,o,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},zc=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Wc=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Vc=s=>{var e=zc.exec(s);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){var t=Wc.exec(e[3]);t&&(e[1]=e[1]||"eval",e[3]=t[1],e[4]=t[2],e[5]="")}var r=e[3],i=e[1]||rs;return[i,r]=Mo(i,r),bi(r,i,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},Ca=/\(error: (.*)\)/,Aa=50;function Gc(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return function(r){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],a=r.split(`
`),o=i;o<a.length;o++){var l=a[o];if(!(l.length>1024)){var c=Ca.test(l)?l.replace(Ca,"$1"):l;if(!c.match(/\S*Error: /)){for(var u of e){var d=u(c);if(d){n.push(d);break}}if(n.length>=Aa)break}}}return function(h){if(!h.length)return[];var p=Array.from(h);return p.reverse(),p.slice(0,Aa).map(g=>{return b({},g,{filename:g.filename||(v=p,v[v.length-1]||{}).filename,function:g.function||rs});var v})}(n)}}var wi=class{buildFromUnknown(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t&&t.mechanism||{handled:!0,type:"generic"},i=this.buildCoercingContext(r,t,0).apply(e),n=this.buildParsingContext(),a=this.parseStacktrace(i,n);return{$exception_list:this.convertToExceptionList(a,r),$exception_level:"error"}}coerceFallback(e){var t;return{type:"Error",value:"Unknown error",stack:(t=e.syntheticException)==null?void 0:t.stack,synthetic:!0}}parseStacktrace(e,t){var r,i;return e.cause!=null&&(r=this.parseStacktrace(e.cause,t)),e.stack!=""&&e.stack!=null&&(i=this.applyChunkIds(this.stackParser(e.stack,e.synthetic?1:0),t.chunkIdMap)),b({},e,{cause:r,stack:i})}applyChunkIds(e,t){return e.map(r=>(r.filename&&t&&(r.chunk_id=t[r.filename]),r))}applyCoercers(e,t){for(var r of this.coercers)if(r.match(e))return r.coerce(e,t);return this.coerceFallback(t)}applyModifiers(e){var t=this;return Ta(function*(){var r=e;for(var i of t.modifiers)r=yield i(r);return r})()}modifyFrames(e){var t=this;return Ta(function*(){var r;e.cause!=null&&(r=yield t.modifyFrames(e.cause));var i=[];return e.stack!=null&&(i=yield t.applyModifiers(e.stack)),b({},e,{cause:r,stack:i})})()}convertToExceptionList(e,t){var r,i,n,a={type:e.type,value:e.value,mechanism:{type:(r=t.type)!=null?r:"generic",handled:(i=t.handled)==null||i,synthetic:(n=e.synthetic)!=null&&n}};e.stack&&(a.stacktrace={type:"raw",frames:e.stack});var o=[a];return e.cause!=null&&o.push(...this.convertToExceptionList(e.cause,b({},t,{handled:!0}))),o}buildParsingContext(){return{chunkIdMap:jc(this.stackParser)}}buildCoercingContext(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(n,a)=>{if(a<=4){var o=this.buildCoercingContext(e,t,a);return this.applyCoercers(n,o)}};return b({},t,{syntheticException:r==0?t.syntheticException:void 0,mechanism:e,apply:n=>i(n,r),next:n=>i(n,r+1)})}constructor(e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r=[]),this.coercers=e,this.modifiers=r,this.stackParser=Gc(...t)}},Ei=class{match(e){return this.isDOMException(e)||this.isDOMError(e)}coerce(e,t){var r=Z(e.stack);return{type:this.getType(e),value:this.getValue(e),stack:r?e.stack:void 0,cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return this.isDOMError(e)?"DOMError":"DOMException"}getValue(e){var t=e.name||(this.isDOMError(e)?"DOMError":"DOMException");return e.message?t+": "+e.message:t}isDOMException(e){return or(e,"DOMException")}isDOMError(e){return or(e,"DOMError")}},xi=class{match(e){return(t=>t instanceof Error)(e)}coerce(e,t){return{type:this.getType(e),value:this.getMessage(e,t),stack:this.getStack(e),cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return e.name||e.constructor.name}getMessage(e,t){var r=e.message;return r.error&&typeof r.error.message=="string"?String(r.error.message):String(r)}getStack(e){return e.stacktrace||e.stack||void 0}},ki=class{match(e){return or(e,"ErrorEvent")&&e.error!=null}coerce(e,t){var r,i=t.apply(e.error);return i||{type:"ErrorEvent",value:e.message,stack:(r=t.syntheticException)==null?void 0:r.stack,synthetic:!0}}constructor(){}},Zc=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i,Si=class{match(e){return typeof e=="string"}coerce(e,t){var r,[i,n]=this.getInfos(e);return{type:i??"Error",value:n??e,stack:(r=t.syntheticException)==null?void 0:r.stack,synthetic:!0}}getInfos(e){var t="Error",r=e,i=e.match(Zc);return i&&(t=i[1],r=i[2]),[t,r]}},Yc=["fatal","error","warning","log","info","debug"];function Lo(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:40,t=Object.keys(s);if(t.sort(),!t.length)return"[object has no keys]";for(var r=t.length;r>0;r--){var i=t.slice(0,r).join(", ");if(!(i.length>e))return r===t.length||i.length<=e?i:i.slice(0,e)+"..."}return""}var Ti=class{match(e){return typeof e=="object"&&e!==null}coerce(e,t){var r,i=this.getErrorPropertyFromObject(e);return i?t.apply(i):{type:this.getType(e),value:this.getValue(e),stack:(r=t.syntheticException)==null?void 0:r.stack,level:this.isSeverityLevel(e.level)?e.level:"error",synthetic:!0}}getType(e){return Do(e)?e.constructor.name:"Error"}getValue(e){if("name"in e&&typeof e.name=="string"){var t="'"+e.name+"' captured as exception";return"message"in e&&typeof e.message=="string"&&(t+=" with message: '"+e.message+"'"),t}if("message"in e&&typeof e.message=="string")return e.message;var r=this.getObjectClassName(e);return(r&&r!=="Object"?"'"+r+"'":"Object")+" captured as exception with keys: "+Lo(e)}isSeverityLevel(e){return Z(e)&&!_i(e)&&Yc.indexOf(e)>=0}getErrorPropertyFromObject(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=e[t];if(Fc(r))return r}}getObjectClassName(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{return}}},Ri=class{match(e){return Do(e)}coerce(e,t){var r,i=e.constructor.name;return{type:i,value:i+" captured as exception with keys: "+Lo(e),stack:(r=t.syntheticException)==null?void 0:r.stack,synthetic:!0}}},Ci=class{match(e){return yi(e)}coerce(e,t){var r;return{type:"Error",value:"Primitive value captured as exception: "+String(e),stack:(r=t.syntheticException)==null?void 0:r.stack,synthetic:!0}}},Ai=class{match(e){return or(e,"PromiseRejectionEvent")}coerce(e,t){var r,i=this.getUnhandledRejectionReason(e);return yi(i)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(i),stack:(r=t.syntheticException)==null?void 0:r.stack,synthetic:!0}:t.apply(i)}getUnhandledRejectionReason(e){if(yi(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}},$o=s=>{var e={T:function(t){if(f&&(Je.DEBUG||R.POSTHOG_DEBUG)&&!y(f.console)&&f.console){for(var r=("__rrweb_original__"in f.console[t])?f.console[t].__rrweb_original__:f.console[t],i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];r(s,...n)}},info:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e.T("log",...r)},warn:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e.T("warn",...r)},error:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e.T("error",...r)},critical:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];console.error(s,...r)},uninitializedWarning:t=>{e.error("You must initialize PostHog before calling "+t)},createLogger:t=>$o(s+" "+t)};return e},E=$o("[PostHog.js]"),X=E.createLogger,Jc=X("[ExternalScriptsLoader]"),Ia=(s,e,t)=>{if(s.config.disable_external_dependency_loading)return Jc.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var r=k?.querySelectorAll("script");if(r){for(var i,n=function(){if(r[a].src===e){var l=r[a];return l.__posthog_loading_callback_fired?{v:t()}:(l.addEventListener("load",c=>{l.__posthog_loading_callback_fired=!0,t(void 0,c)}),l.onerror=c=>t(c),{v:void 0})}},a=0;a<r.length;a++)if(i=n())return i.v}var o=()=>{if(!k)return t("document not found");var l=k.createElement("script");if(l.type="text/javascript",l.crossOrigin="anonymous",l.src=e,l.onload=d=>{l.__posthog_loading_callback_fired=!0,t(void 0,d)},l.onerror=d=>t(d),s.config.prepare_external_dependency_script&&(l=s.config.prepare_external_dependency_script(l)),!l)return t("prepare_external_dependency_script returned null");var c,u=k.querySelectorAll("body > script");u.length>0?(c=u[0].parentNode)==null||c.insertBefore(l,u[0]):k.body.appendChild(l)};k!=null&&k.body?o():k?.addEventListener("DOMContentLoaded",o)};R.__PosthogExtensions__=R.__PosthogExtensions__||{},R.__PosthogExtensions__.loadExternalDependency=(s,e,t)=>{var r="/static/"+e+".js?v="+s.version;if(e==="remote-config"&&(r="/array/"+s.config.token+"/config.js"),e==="toolbar"){var i=3e5;r=r+"&t="+Math.floor(Date.now()/i)*i}var n=s.requestRouter.endpointFor("assets",r);Ia(s,n,t)},R.__PosthogExtensions__.loadSiteApp=(s,e,t)=>{var r=s.requestRouter.endpointFor("api",e);Ia(s,r,t)};var cr={};function pt(s,e,t){if(z(s)){if(Ea&&s.forEach===Ea)s.forEach(e,t);else if("length"in s&&s.length===+s.length){for(var r=0,i=s.length;r<i;r++)if(r in s&&e.call(t,s[r],r)===cr)return}}}function q(s,e,t){if(!U(s)){if(z(s))return pt(s,e,t);if(Mc(s)){for(var r of s.entries())if(e.call(t,r[1],r[0])===cr)return}else for(var i in s)if(Oo.call(s,i)&&e.call(t,s[i],i)===cr)return}}var Y=function(s){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return pt(t,function(i){for(var n in i)i[n]!==void 0&&(s[n]=i[n])}),s},Lr=function(s){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return pt(t,function(i){pt(i,function(n){s.push(n)})}),s};function ir(s){for(var e=Object.keys(s),t=e.length,r=new Array(t);t--;)r[t]=[e[t],s[e[t]]];return r}var Pa=function(s){try{return s()}catch{return}},Xc=function(s){return function(){try{for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.apply(this,t)}catch(i){E.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),E.critical(i)}}},Fn=function(s){var e={};return q(s,function(t,r){(Z(t)&&t.length>0||re(t))&&(e[r]=t)}),e};function Qc(s,e){return t=s,r=n=>Z(n)&&!Qe(e)?n.slice(0,e):n,i=new Set,function n(a,o){return a!==Object(a)?r?r(a,o):a:i.has(a)?void 0:(i.add(a),z(a)?(l=[],pt(a,c=>{l.push(n(c))})):(l={},q(a,(c,u)=>{i.has(c)||(l[u]=n(c,u))})),l);var l}(t);var t,r,i}var Kc=["herokuapp.com","vercel.app","netlify.app"];function eu(s){var e=s?.hostname;if(!Z(e))return!1;var t=e.split(".").slice(-2).join(".");for(var r of Kc)if(t===r)return!1;return!0}function No(s,e){for(var t=0;t<s.length;t++)if(e(s[t]))return s[t]}function V(s,e,t,r){var{capture:i=!1,passive:n=!0}=r??{};s?.addEventListener(e,t,{capture:i,passive:n})}var Fo="$people_distinct_id",Ss="__alias",Ts="__timers",Oa="$autocapture_disabled_server_side",Ii="$heatmaps_enabled_server_side",Da="$exception_capture_enabled_server_side",Pi="$error_tracking_suppression_rules",Ma="$error_tracking_capture_extension_exceptions",La="$web_vitals_enabled_server_side",jo="$dead_clicks_enabled_server_side",$a="$web_vitals_allowed_metrics",ii="$session_recording_remote_config",Oi="$session_recording_enabled_server_side",Na="$console_log_recording_enabled_server_side",Fa="$session_recording_network_payload_capture",ja="$session_recording_masking",Ua="$session_recording_canvas_recording",Ba="$replay_sample_rate",qa="$replay_minimum_duration",Ha="$replay_script_config",ur="$sesid",Kt="$session_is_sampled",Di="$session_recording_url_trigger_activated_session",Mi="$session_recording_event_trigger_activated_session",es="$enabled_feature_flags",Rs="$early_access_features",Li="$feature_flag_details",Cs="$stored_person_properties",St="$stored_group_properties",$i="$surveys",Js="$surveys_activated",dr="$flag_call_reported",Ge="$user_state",Ni="$client_session_props",Fi="$capture_rate_limit",ji="$initial_campaign_params",Ui="$initial_referrer_info",hr="$initial_person_info",pr="$epp",Uo="__POSTHOG_TOOLBAR__",_s="$posthog_cookieless",tu=[Fo,Ss,"__cmpns",Ts,Oi,Ii,ur,es,Pi,Ge,Rs,Li,St,Cs,$i,dr,Ni,Fi,ji,Ui,pr,hr];function za(s){return s instanceof Element&&(s.id===Uo||!(s.closest==null||!s.closest(".toolbar-global-fade-container")))}function $r(s){return!!s&&s.nodeType===1}function ft(s,e){return!!s&&!!s.tagName&&s.tagName.toLowerCase()===e.toLowerCase()}function Bo(s){return!!s&&s.nodeType===3}function qo(s){return!!s&&s.nodeType===11}function jn(s){return s?Dr(s).split(/\s+/):[]}function Wa(s){var e=f?.location.href;return!!(e&&s&&s.some(t=>e.match(t)))}function fr(s){var e="";switch(typeof s.className){case"string":e=s.className;break;case"object":e=(s.className&&"baseVal"in s.className?s.className.baseVal:null)||s.getAttribute("class")||"";break;default:e=""}return jn(e)}function Ho(s){return U(s)?null:Dr(s).split(/(\s+)/).filter(e=>is(e)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function Nr(s){var e="";return Bi(s)&&!Zo(s)&&s.childNodes&&s.childNodes.length&&q(s.childNodes,function(t){var r;Bo(t)&&t.textContent&&(e+=(r=Ho(t.textContent))!==null&&r!==void 0?r:"")}),Dr(e)}function zo(s){return y(s.target)?s.srcElement||null:(e=s.target)!=null&&e.shadowRoot?s.composedPath()[0]||null:s.target||null;var e}var Un=["a","button","form","input","select","textarea","label"];function Wo(s,e){if(y(e))return!0;var t,r=function(n){if(e.some(a=>n.matches(a)))return{v:!0}};for(var i of s)if(t=r(i))return t.v;return!1}function Vo(s){var e=s.parentNode;return!(!e||!$r(e))&&e}var Va=[".ph-no-rageclick",".ph-no-capture"],Bn=s=>!s||ft(s,"html")||!$r(s),Go=(s,e)=>{if(!f||Bn(s))return{parentIsUsefulElement:!1,targetElementList:[]};for(var t=!1,r=[s],i=s;i.parentNode&&!ft(i,"body");)if(qo(i.parentNode))r.push(i.parentNode.host),i=i.parentNode.host;else{var n=Vo(i);if(!n)break;if(e||Un.indexOf(n.tagName.toLowerCase())>-1)t=!0;else{var a=f.getComputedStyle(n);a&&a.getPropertyValue("cursor")==="pointer"&&(t=!0)}r.push(n),i=n}return{parentIsUsefulElement:t,targetElementList:r}};function su(s,e,t,r,i){var n,a,o,l;if(t===void 0&&(t=void 0),!f||Bn(s)||(n=t)!=null&&n.url_allowlist&&!Wa(t.url_allowlist)||(a=t)!=null&&a.url_ignorelist&&Wa(t.url_ignorelist))return!1;if((o=t)!=null&&o.dom_event_allowlist){var c=t.dom_event_allowlist;if(c&&!c.some(g=>e.type===g))return!1}var{parentIsUsefulElement:u,targetElementList:d}=Go(s,r);if(!function(g,v){var _=v?.element_allowlist;if(y(_))return!0;var S,O=function(I){if(_.some(M=>I.tagName.toLowerCase()===M))return{v:!0}};for(var A of g)if(S=O(A))return S.v;return!1}(d,t)||!Wo(d,(l=t)==null?void 0:l.css_selector_allowlist))return!1;var h=f.getComputedStyle(s);if(h&&h.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var p=s.tagName.toLowerCase();switch(p){case"html":return!1;case"form":return(i||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(i||["change","click"]).indexOf(e.type)>=0;default:return u?(i||["click"]).indexOf(e.type)>=0:(i||["click"]).indexOf(e.type)>=0&&(Un.indexOf(p)>-1||s.getAttribute("contenteditable")==="true")}}function Bi(s){for(var e=s;e.parentNode&&!ft(e,"body");e=e.parentNode){var t=fr(e);if(N(t,"ph-sensitive")||N(t,"ph-no-capture"))return!1}if(N(fr(s),"ph-include"))return!0;var r=s.type||"";if(Z(r))switch(r.toLowerCase()){case"hidden":case"password":return!1}var i=s.name||s.id||"";return!(Z(i)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(i.replace(/[^a-zA-Z0-9]/g,"")))}function Zo(s){return!!(ft(s,"input")&&!["button","checkbox","submit","reset"].includes(s.type)||ft(s,"select")||ft(s,"textarea")||s.getAttribute("contenteditable")==="true")}var Yo="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",ru=new RegExp("^(?:"+Yo+")$"),iu=new RegExp(Yo),Jo="\\d{3}-?\\d{2}-?\\d{4}",nu=new RegExp("^("+Jo+")$"),au=new RegExp("("+Jo+")");function is(s,e){return e===void 0&&(e=!0),!(U(s)||Z(s)&&(s=Dr(s),(e?ru:iu).test((s||"").replace(/[- ]/g,""))||(e?nu:au).test(s)))}function Xo(s){var e=Nr(s);return is(e=(e+" "+Qo(s)).trim())?e:""}function Qo(s){var e="";return s&&s.childNodes&&s.childNodes.length&&q(s.childNodes,function(t){var r;if(t&&((r=t.tagName)==null?void 0:r.toLowerCase())==="span")try{var i=Nr(t);e=(e+" "+i).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+Qo(t)).trim())}catch(n){E.error("[AutoCapture]",n)}}),e}function ou(s){return function(e){var t=e.map(r=>{var i,n,a="";if(r.tag_name&&(a+=r.tag_name),r.attr_class)for(var o of(r.attr_class.sort(),r.attr_class))a+="."+o.replace(/"/g,"");var l=b({},r.text?{text:r.text}:{},{"nth-child":(i=r.nth_child)!==null&&i!==void 0?i:0,"nth-of-type":(n=r.nth_of_type)!==null&&n!==void 0?n:0},r.href?{href:r.href}:{},r.attr_id?{attr_id:r.attr_id}:{},r.attributes),c={};return ir(l).sort((u,d)=>{var[h]=u,[p]=d;return h.localeCompare(p)}).forEach(u=>{var[d,h]=u;return c[Ga(d.toString())]=Ga(h.toString())}),a+=":",a+=ir(c).map(u=>{var[d,h]=u;return d+'="'+h+'"'}).join("")});return t.join(";")}(function(e){return e.map(t=>{var r,i,n={text:(r=t.$el_text)==null?void 0:r.slice(0,400),tag_name:t.tag_name,href:(i=t.attr__href)==null?void 0:i.slice(0,2048),attr_class:lu(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return ir(t).filter(a=>{var[o]=a;return o.indexOf("attr__")===0}).forEach(a=>{var[o,l]=a;return n.attributes[o]=l}),n})}(s))}function Ga(s){return s.replace(/"|\\"/g,'\\"')}function lu(s){var e=s.attr__class;return e?z(e)?e:jn(e):void 0}var gr=class{constructor(){this.clicks=[]}isRageClick(e,t,r){var i=this.clicks[this.clicks.length-1];if(i&&Math.abs(e-i.x)+Math.abs(t-i.y)<30&&r-i.timestamp<1e3){if(this.clicks.push({x:e,y:t,timestamp:r}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:t,timestamp:r}];return!1}},ni="$copy_autocapture",Xe=function(s){return s.GZipJS="gzip-js",s.Base64="base64",s}({});var cu=["localhost","127.0.0.1"],ns=s=>{var e=k?.createElement("a");return y(e)?null:(e.href=s,e)},uu=function(s,e){var t,r;e===void 0&&(e="&");var i=[];return q(s,function(n,a){y(n)||y(a)||a==="undefined"||(t=encodeURIComponent((o=>o instanceof File)(n)?n.name:n.toString()),r=encodeURIComponent(a),i[i.length]=r+"="+t)}),i.join(e)},vr=function(s,e){for(var t,r=((s.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),i=0;i<r.length;i++){var n=r[i].split("=");if(n[0]===e){t=n;break}}if(!z(t)||t.length<2)return"";var a=t[1];try{a=decodeURIComponent(a)}catch{E.error("Skipping decoding for malformed query param: "+a)}return a.replace(/\+/g," ")},qn=function(s,e,t){if(!s||!e||!e.length)return s;for(var r=s.split("#"),i=r[0]||"",n=r[1],a=i.split("?"),o=a[1],l=a[0],c=(o||"").split("&"),u=[],d=0;d<c.length;d++){var h=c[d].split("=");z(h)&&(e.includes(h[0])?u.push(h[0]+"="+t):u.push(c[d]))}var p=l;return o!=null&&(p+="?"+u.join("&")),n!=null&&(p+="#"+n),p},mr=function(s,e){var t=s.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},Za=X("[AutoCapture]");function ai(s,e){return e.length>s?e.slice(0,s)+"...":e}function du(s){if(s.previousElementSibling)return s.previousElementSibling;var e=s;do e=e.previousSibling;while(e&&!$r(e));return e}function hu(s,e,t,r){var i=s.tagName.toLowerCase(),n={tag_name:i};Un.indexOf(i)>-1&&!t&&(i.toLowerCase()==="a"||i.toLowerCase()==="button"?n.$el_text=ai(1024,Xo(s)):n.$el_text=ai(1024,Nr(s)));var a=fr(s);a.length>0&&(n.classes=a.filter(function(u){return u!==""})),q(s.attributes,function(u){var d;if((!Zo(s)||["name","id","class","aria-label"].indexOf(u.name)!==-1)&&(r==null||!r.includes(u.name))&&!e&&is(u.value)&&(d=u.name,!Z(d)||d.substring(0,10)!=="_ngcontent"&&d.substring(0,7)!=="_nghost")){var h=u.value;u.name==="class"&&(h=jn(h).join(" ")),n["attr__"+u.name]=ai(1024,h)}});for(var o=1,l=1,c=s;c=du(c);)o++,c.tagName===s.tagName&&l++;return n.nth_child=o,n.nth_of_type=l,n}function pu(s,e){for(var t,r,{e:i,maskAllElementAttributes:n,maskAllText:a,elementAttributeIgnoreList:o,elementsChainAsString:l}=e,c=[s],u=s;u.parentNode&&!ft(u,"body");)qo(u.parentNode)?(c.push(u.parentNode.host),u=u.parentNode.host):(c.push(u.parentNode),u=u.parentNode);var d,h=[],p={},g=!1,v=!1;if(q(c,I=>{var M=Bi(I);I.tagName.toLowerCase()==="a"&&(g=I.getAttribute("href"),g=M&&g&&is(g)&&g),N(fr(I),"ph-no-capture")&&(v=!0),h.push(hu(I,n,a,o));var W=function(Q){if(!Bi(Q))return{};var j={};return q(Q.attributes,function(De){if(De.name&&De.name.indexOf("data-ph-capture-attribute")===0){var ge=De.name.replace("data-ph-capture-attribute-",""),Ae=De.value;ge&&Ae&&is(Ae)&&(j[ge]=Ae)}}),j}(I);Y(p,W)}),v)return{props:{},explicitNoCapture:v};if(a||(s.tagName.toLowerCase()==="a"||s.tagName.toLowerCase()==="button"?h[0].$el_text=Xo(s):h[0].$el_text=Nr(s)),g){var _,S;h[0].attr__href=g;var O=(_=ns(g))==null?void 0:_.host,A=f==null||(S=f.location)==null?void 0:S.host;O&&A&&O!==A&&(d=g)}return{props:Y({$event_type:i.type,$ce_version:1},l?{}:{$elements:h},{$elements_chain:ou(h)},(t=h[0])!=null&&t.$el_text?{$el_text:(r=h[0])==null?void 0:r.$el_text}:{},d&&i.type==="click"?{$external_click_url:d}:{},p)}}var qi=class{constructor(e){this.C=!1,this.M=null,this.rageclicks=new gr,this.O=!1,this.instance=e,this.F=null}get A(){var e,t,r=G(this.instance.config.autocapture)?this.instance.config.autocapture:{};return r.url_allowlist=(e=r.url_allowlist)==null?void 0:e.map(i=>new RegExp(i)),r.url_ignorelist=(t=r.url_ignorelist)==null?void 0:t.map(i=>new RegExp(i)),r}D(){if(this.isBrowserSupported()){if(f&&k){var e=r=>{r=r||f?.event;try{this.j(r)}catch(i){Za.error("Failed to capture event",i)}};if(V(k,"submit",e,{capture:!0}),V(k,"change",e,{capture:!0}),V(k,"click",e,{capture:!0}),this.A.capture_copied_text){var t=r=>{r=r||f?.event,this.j(r,ni)};V(k,"copy",t,{capture:!0}),V(k,"cut",t,{capture:!0})}}}else Za.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.C&&(this.D(),this.C=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.O=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[Oa]:!!e.autocapture_opt_out}),this.M=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.F=e}getElementSelectors(e){var t,r=[];return(t=this.F)==null||t.forEach(i=>{var n=k?.querySelectorAll(i);n?.forEach(a=>{e===a&&r.push(i)})}),r}get isEnabled(){var e,t,r=(e=this.instance.persistence)==null?void 0:e.props[Oa],i=this.M;if(Qe(i)&&!Pe(r)&&!this.instance.L())return!1;var n=(t=this.M)!==null&&t!==void 0?t:!!r;return!!this.instance.config.autocapture&&!n}j(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var r,i=zo(e);Bo(i)&&(i=i.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(r=this.rageclicks)!=null&&r.isRageClick(e.clientX,e.clientY,new Date().getTime())&&function(h,p){if(!f||Bn(h))return!1;var g,v;if((g=Pe(p)?!!p&&Va:(v=p?.css_selector_ignorelist)!==null&&v!==void 0?v:Va)===!1)return!1;var{targetElementList:_}=Go(h,!1);return!Wo(_,g)}(i,this.instance.config.rageclick)&&this.j(e,"$rageclick");var n=t===ni;if(i&&su(i,e,this.A,n,n?["copy","cut"]:void 0)){var{props:a,explicitNoCapture:o}=pu(i,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.A.element_attribute_ignorelist,elementsChainAsString:this.O});if(o)return!1;var l=this.getElementSelectors(i);if(l&&l.length>0&&(a.$element_selectors=l),t===ni){var c,u=Ho(f==null||(c=f.getSelection())==null?void 0:c.toString()),d=e.type||"clipboard";if(!u)return!1;a.$selected_content=u,a.$copy_type=d}return this.instance.capture(t,a),!0}}}isBrowserSupported(){return we(k?.querySelectorAll)}};Math.trunc||(Math.trunc=function(s){return s<0?Math.ceil(s):Math.floor(s)}),Number.isInteger||(Number.isInteger=function(s){return re(s)&&isFinite(s)&&Math.floor(s)===s});var Ya="0123456789abcdef",Hi=class s{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,r,i){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(r)||!Number.isInteger(i)||e<0||t<0||r<0||i<0||e>0xffffffffffff||t>4095||r>1073741823||i>4294967295)throw new RangeError("invalid field value");var n=new Uint8Array(16);return n[0]=e/Math.pow(2,40),n[1]=e/Math.pow(2,32),n[2]=e/Math.pow(2,24),n[3]=e/Math.pow(2,16),n[4]=e/Math.pow(2,8),n[5]=e,n[6]=112|t>>>8,n[7]=t,n[8]=128|r>>>24,n[9]=r>>>16,n[10]=r>>>8,n[11]=r,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i,new s(n)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+Ya.charAt(this.bytes[t]>>>4)+Ya.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new s(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var r=this.bytes[t]-e.bytes[t];if(r!==0)return Math.sign(r)}return 0}},zi=class{constructor(){this.N=0,this.U=0,this.q=new Wi}generate(){var e=this.generateOrAbort();if(y(e)){this.N=0;var t=this.generateOrAbort();if(y(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.N)this.N=e,this.B();else{if(!(e+1e4>this.N))return;this.U++,this.U>4398046511103&&(this.N++,this.B())}return Hi.fromFieldsV7(this.N,Math.trunc(this.U/Math.pow(2,30)),this.U&Math.pow(2,30)-1,this.q.nextUint32())}B(){this.U=1024*this.q.nextUint32()+(1023&this.q.nextUint32())}},Ja,Ko=s=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<s.length;e++)s[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return s};f&&!y(f.crypto)&&crypto.getRandomValues&&(Ko=s=>crypto.getRandomValues(s));var Wi=class{constructor(){this.H=new Uint32Array(8),this.W=1/0}nextUint32(){return this.W>=this.H.length&&(Ko(this.H),this.W=0),this.H[this.W++]}},ht=()=>fu().toString(),fu=()=>(Ja||(Ja=new zi)).generate(),ys="",gu=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function vu(s,e){if(e){var t=function(i,n){if(n===void 0&&(n=k),ys)return ys;if(!n||["localhost","127.0.0.1"].includes(i))return"";for(var a=i.split("."),o=Math.min(a.length,8),l="dmn_chk_"+ht();!ys&&o--;){var c=a.slice(o).join("."),u=l+"=1;domain=."+c+";path=/";n.cookie=u+";max-age=3",n.cookie.includes(l)&&(n.cookie=u+";max-age=0",ys=c)}return ys}(s);if(!t){var r=(i=>{var n=i.match(gu);return n?n[0]:""})(s);r!==t&&E.info("Warning: cookie subdomain discovery mismatch",r,t),t=r}return t?"; domain=."+t:""}return""}var je={G:()=>!!k,V:function(s){E.error("cookieStore error: "+s)},J:function(s){if(k){try{for(var e=s+"=",t=k.cookie.split(";").filter(n=>n.length),r=0;r<t.length;r++){for(var i=t[r];i.charAt(0)==" ";)i=i.substring(1,i.length);if(i.indexOf(e)===0)return decodeURIComponent(i.substring(e.length,i.length))}}catch{}return null}},K:function(s){var e;try{e=JSON.parse(je.J(s))||{}}catch{}return e},Y:function(s,e,t,r,i){if(k)try{var n="",a="",o=vu(k.location.hostname,r);if(t){var l=new Date;l.setTime(l.getTime()+24*t*60*60*1e3),n="; expires="+l.toUTCString()}i&&(a="; secure");var c=s+"="+encodeURIComponent(JSON.stringify(e))+n+"; SameSite=Lax; path=/"+o+a;return c.length>3686.4&&E.warn("cookieStore warning: large cookie, len="+c.length),k.cookie=c,c}catch{return}},X:function(s,e){if(k!=null&&k.cookie)try{je.Y(s,"",-1,e)}catch{return}}},oi=null,J={G:function(){if(!Qe(oi))return oi;var s=!0;if(y(f))s=!1;else try{var e="__mplssupport__";J.Y(e,"xyz"),J.J(e)!=='"xyz"'&&(s=!1),J.X(e)}catch{s=!1}return s||E.error("localStorage unsupported; falling back to cookie store"),oi=s,s},V:function(s){E.error("localStorage error: "+s)},J:function(s){try{return f?.localStorage.getItem(s)}catch(e){J.V(e)}return null},K:function(s){try{return JSON.parse(J.J(s))||{}}catch{}return null},Y:function(s,e){try{f?.localStorage.setItem(s,JSON.stringify(e))}catch(t){J.V(t)}},X:function(s){try{f?.localStorage.removeItem(s)}catch(e){J.V(e)}}},mu=["distinct_id",ur,Kt,pr,hr],Xs=b({},J,{K:function(s){try{var e={};try{e=je.K(s)||{}}catch{}var t=Y(e,JSON.parse(J.J(s)||"{}"));return J.Y(s,t),t}catch{}return null},Y:function(s,e,t,r,i,n){try{J.Y(s,e,void 0,void 0,n);var a={};mu.forEach(o=>{e[o]&&(a[o]=e[o])}),Object.keys(a).length&&je.Y(s,a,t,r,i,n)}catch(o){J.V(o)}},X:function(s,e){try{f?.localStorage.removeItem(s),je.X(s,e)}catch(t){J.V(t)}}}),Qs={},_u={G:function(){return!0},V:function(s){E.error("memoryStorage error: "+s)},J:function(s){return Qs[s]||null},K:function(s){return Qs[s]||null},Y:function(s,e){Qs[s]=e},X:function(s){delete Qs[s]}},Et=null,ee={G:function(){if(!Qe(Et))return Et;if(Et=!0,y(f))Et=!1;else try{var s="__support__";ee.Y(s,"xyz"),ee.J(s)!=='"xyz"'&&(Et=!1),ee.X(s)}catch{Et=!1}return Et},V:function(s){E.error("sessionStorage error: ",s)},J:function(s){try{return f?.sessionStorage.getItem(s)}catch(e){ee.V(e)}return null},K:function(s){try{return JSON.parse(ee.J(s))||null}catch{}return null},Y:function(s,e){try{f?.sessionStorage.setItem(s,JSON.stringify(e))}catch(t){ee.V(t)}},X:function(s){try{f?.sessionStorage.removeItem(s)}catch(e){ee.V(e)}}},Ze=function(s){return s[s.PENDING=-1]="PENDING",s[s.DENIED=0]="DENIED",s[s.GRANTED=1]="GRANTED",s}({}),Vi=class{constructor(e){this._instance=e}get A(){return this._instance.config}get consent(){return this.Z()?Ze.DENIED:this.tt}isOptedOut(){return this.A.cookieless_mode==="always"||this.consent===Ze.DENIED||this.consent===Ze.PENDING&&(this.A.opt_out_capturing_by_default||this.A.cookieless_mode==="on_reject")}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===Ze.DENIED}optInOut(e){this.it.Y(this.et,e?1:0,this.A.cookie_expiration,this.A.cross_subdomain_cookie,this.A.secure_cookie)}reset(){this.it.X(this.et,this.A.cross_subdomain_cookie)}get et(){var{token:e,opt_out_capturing_cookie_prefix:t,consent_persistence_name:r}=this._instance.config;return r||(t?t+e:"__ph_opt_in_out_"+e)}get tt(){var e=this.it.J(this.et);return si(e)?Ze.GRANTED:N(Nc,e)?Ze.DENIED:Ze.PENDING}get it(){if(!this.rt){var e=this.A.opt_out_capturing_persistence_type;this.rt=e==="localStorage"?J:je;var t=e==="localStorage"?je:J;t.J(this.et)&&(this.rt.J(this.et)||this.optInOut(si(t.J(this.et))),t.X(this.et,this.A.cross_subdomain_cookie))}return this.rt}Z(){return!!this.A.respect_dnt&&!!No([me?.doNotTrack,me?.msDoNotTrack,R.doNotTrack],e=>si(e))}},Ks=X("[Dead Clicks]"),yu=()=>!0,bu=s=>{var e,t=!((e=s.instance.persistence)==null||!e.get_property(jo)),r=s.instance.config.capture_dead_clicks;return Pe(r)?r:t},_r=class{get lazyLoadedDeadClicksAutocapture(){return this.st}constructor(e,t,r){this.instance=e,this.isEnabled=t,this.onCapture=r,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[jo]:e?.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.nt(()=>{this.ot()})}nt(e){var t,r;(t=R.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(r=R.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this.instance,"dead-clicks-autocapture",i=>{i?Ks.error("failed to load script",i):e()})}ot(){var e;if(k){if(!this.st&&(e=R.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=G(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.st=R.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.st.start(k),Ks.info("starting...")}}else Ks.error("`document` not found. Cannot start.")}stop(){this.st&&(this.st.stop(),this.st=void 0,Ks.info("stopping..."))}},bs=X("[ExceptionAutocapture]"),Gi=class{constructor(e){var t,r,i;this.lt=()=>{var n;if(f&&this.isEnabled&&(n=R.__PosthogExtensions__)!=null&&n.errorWrappingFunctions){var a=R.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,o=R.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,l=R.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.ut&&this.A.capture_unhandled_errors&&(this.ut=a(this.captureException.bind(this))),!this.ht&&this.A.capture_unhandled_rejections&&(this.ht=o(this.captureException.bind(this))),!this.dt&&this.A.capture_console_errors&&(this.dt=l(this.captureException.bind(this)))}catch(c){bs.error("failed to start",c),this.vt()}}},this._instance=e,this.ct=!((t=this._instance.persistence)==null||!t.props[Da]),this.A=this.ft(),this.gt=new lr({refillRate:(r=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&r!==void 0?r:1,bucketSize:(i=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&i!==void 0?i:10,refillInterval:1e4,I:bs}),this.startIfEnabled()}ft(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return G(e)?t=b({},t,e):(y(e)?this.ct:e)&&(t=b({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.A.capture_console_errors||this.A.capture_unhandled_errors||this.A.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(bs.info("enabled"),this.nt(this.lt))}nt(e){var t,r;(t=R.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(r=R.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,"exception-autocapture",i=>{if(i)return bs.error("failed to load script",i);e()})}vt(){var e,t,r;(e=this.ut)==null||e.call(this),this.ut=void 0,(t=this.ht)==null||t.call(this),this.ht=void 0,(r=this.dt)==null||r.call(this),this.dt=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.ct=!!t||!1,this.A=this.ft(),this._instance.persistence&&this._instance.persistence.register({[Da]:this.ct}),this.startIfEnabled()}captureException(e){var t,r,i=(t=e==null||(r=e.$exception_list)==null||(r=r[0])==null?void 0:r.type)!==null&&t!==void 0?t:"Exception";this.gt.consumeRateLimit(i)?bs.info("Skipping exception capture because of client rate limiting.",{exception:i}):this._instance.exceptions.sendExceptionEvent(e)}};function Xa(s,e,t){try{if(!(e in s))return()=>{};var r=s[e],i=t(r);return we(i)&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__posthog_wrapped__:{enumerable:!1,value:!0}})),s[e]=i,()=>{s[e]=r}}catch{return()=>{}}}var Zi=class{constructor(e){var t;this._instance=e,this._t=(f==null||(t=f.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(E.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.yt&&this.yt(),this.yt=void 0,E.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(f&&f.history){var r=this;(e=f.history.pushState)!=null&&e.__posthog_wrapped__||Xa(f.history,"pushState",i=>function(n,a,o){i.call(this,n,a,o),r.bt("pushState")}),(t=f.history.replaceState)!=null&&t.__posthog_wrapped__||Xa(f.history,"replaceState",i=>function(n,a,o){i.call(this,n,a,o),r.bt("replaceState")}),this.wt()}}bt(e){try{var t,r=f==null||(t=f.location)==null?void 0:t.pathname;if(!r)return;r!==this._t&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this._t=r}catch(i){E.error("Error capturing "+e+" pageview",i)}}wt(){if(!this.yt){var e=()=>{this.bt("popstate")};V(f,"popstate",e),this.yt=()=>{f&&f.removeEventListener("popstate",e)}}}};function yr(s){var e,t;return((e=JSON.stringify(s,(t=[],function(r,i){if(G(i)){for(;t.length>0&&t[t.length-1]!==this;)t.pop();return t.includes(i)?"[Circular]":(t.push(i),i)}return i})))==null?void 0:e.length)||0}function Yi(s,e){if(e===void 0&&(e=66060288e-1),s.size>=e&&s.data.length>1){var t=Math.floor(s.data.length/2),r=s.data.slice(0,t),i=s.data.slice(t);return[Yi({size:yr(r),data:r,sessionId:s.sessionId,windowId:s.windowId}),Yi({size:yr(i),data:i,sessionId:s.sessionId,windowId:s.windowId})].flatMap(n=>n)}return[s]}var Ye=(s=>(s[s.DomContentLoaded=0]="DomContentLoaded",s[s.Load=1]="Load",s[s.FullSnapshot=2]="FullSnapshot",s[s.IncrementalSnapshot=3]="IncrementalSnapshot",s[s.Meta=4]="Meta",s[s.Custom=5]="Custom",s[s.Plugin=6]="Plugin",s))(Ye||{}),Ie=(s=>(s[s.Mutation=0]="Mutation",s[s.MouseMove=1]="MouseMove",s[s.MouseInteraction=2]="MouseInteraction",s[s.Scroll=3]="Scroll",s[s.ViewportResize=4]="ViewportResize",s[s.Input=5]="Input",s[s.TouchMove=6]="TouchMove",s[s.MediaInteraction=7]="MediaInteraction",s[s.StyleSheetRule=8]="StyleSheetRule",s[s.CanvasMutation=9]="CanvasMutation",s[s.Font=10]="Font",s[s.Log=11]="Log",s[s.Drag=12]="Drag",s[s.StyleDeclaration=13]="StyleDeclaration",s[s.Selection=14]="Selection",s[s.AdoptedStyleSheet=15]="AdoptedStyleSheet",s[s.CustomElement=16]="CustomElement",s))(Ie||{}),Ji="[SessionRecording]",Xi="redacted",er={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:s=>s,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com","bam.nr-data.net"]},wu=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],Eu=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],xu=["/s/","/e/","/i/"];function Qa(s,e,t,r){if(U(s))return s;var i=e?.["content-length"]||function(n){return new Blob([n]).size}(s);return Z(i)&&(i=parseInt(i)),i>t?Ji+" "+r+" body too large to record ("+i+" bytes)":s}function Ka(s,e){if(U(s))return s;var t=s;return is(t,!1)||(t=Ji+" "+e+" body "+Xi),q(Eu,r=>{var i,n;(i=t)!=null&&i.length&&((n=t)==null?void 0:n.indexOf(r))!==-1&&(t=Ji+" "+e+" body "+Xi+" as might contain: "+r)}),t}var ku=(s,e)=>{var t,r,i,n={payloadSizeLimitBytes:er.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...er.performanceEntryTypeToObserve],payloadHostDenyList:[...e.payloadHostDenyList||[],...er.payloadHostDenyList]},a=s.session_recording.recordHeaders!==!1&&e.recordHeaders,o=s.session_recording.recordBody!==!1&&e.recordBody,l=s.capture_performance!==!1&&e.recordPerformance,c=(t=n,i=Math.min(1e6,(r=t.payloadSizeLimitBytes)!==null&&r!==void 0?r:1e6),h=>(h!=null&&h.requestBody&&(h.requestBody=Qa(h.requestBody,h.requestHeaders,i,"Request")),h!=null&&h.responseBody&&(h.responseBody=Qa(h.responseBody,h.responseHeaders,i,"Response")),h)),u=h=>{return c(((v,_)=>{var S,O=ns(v.name),A=_.indexOf("http")===0?(S=ns(_))==null?void 0:S.pathname:_;A==="/"&&(A="");var I=O?.pathname.replace(A||"","");if(!(O&&I&&xu.some(M=>I.indexOf(M)===0)))return v})((g=(p=h).requestHeaders,U(g)||q(Object.keys(g??{}),v=>{wu.includes(v.toLowerCase())&&(g[v]=Xi)}),p),s.api_host));var p,g},d=we(s.session_recording.maskNetworkRequestFn);return d&&we(s.session_recording.maskCapturedNetworkRequestFn)&&E.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),d&&(s.session_recording.maskCapturedNetworkRequestFn=h=>{var p=s.session_recording.maskNetworkRequestFn({url:h.name});return b({},h,{name:p?.url})}),n.maskRequestFn=we(s.session_recording.maskCapturedNetworkRequestFn)?h=>{var p,g=u(h);return g&&(p=s.session_recording.maskCapturedNetworkRequestFn==null?void 0:s.session_recording.maskCapturedNetworkRequestFn(g))!==null&&p!==void 0?p:void 0}:h=>function(p){if(!y(p))return p.requestBody=Ka(p.requestBody,"Request"),p.responseBody=Ka(p.responseBody,"Response"),p}(u(h)),b({},er,n,{recordHeaders:a,recordBody:o,recordPerformance:l,recordInitialRequests:l})},Qi=class{constructor(e,t){var r,i;t===void 0&&(t={}),this.St={},this.kt=n=>{if(!this.St[n]){var a,o;this.St[n]=!0;var l=this.$t(n);(a=(o=this.i).onBlockedNode)==null||a.call(o,n,l)}},this.xt=n=>{var a=this.$t(n);if(a?.nodeName!=="svg"&&a instanceof Element){var o=a.closest("svg");if(o)return[this._rrweb.mirror.getId(o),o]}return[n,a]},this.$t=n=>this._rrweb.mirror.getNode(n),this.Et=n=>{var a,o,l,c,u,d,h,p;return((a=(o=n.removes)==null?void 0:o.length)!==null&&a!==void 0?a:0)+((l=(c=n.attributes)==null?void 0:c.length)!==null&&l!==void 0?l:0)+((u=(d=n.texts)==null?void 0:d.length)!==null&&u!==void 0?u:0)+((h=(p=n.adds)==null?void 0:p.length)!==null&&h!==void 0?h:0)},this.throttleMutations=n=>{if(n.type!==3||n.data.source!==0)return n;var a=n.data,o=this.Et(a);a.attributes&&(a.attributes=a.attributes.filter(c=>{var[u]=this.xt(c.id);return!this.gt.consumeRateLimit(u)&&c}));var l=this.Et(a);return l!==0||o===l?n:void 0},this._rrweb=e,this.i=t,this.gt=new lr({bucketSize:(r=this.i.bucketSize)!==null&&r!==void 0?r:100,refillRate:(i=this.i.refillRate)!==null&&i!==void 0?i:10,refillInterval:1e3,P:this.kt,I:E})}},Ee=Uint8Array,le=Uint16Array,as=Uint32Array,Hn=new Ee([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zn=new Ee([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),eo=new Ee([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),el=function(s,e){for(var t=new le(31),r=0;r<31;++r)t[r]=e+=1<<s[r-1];var i=new as(t[30]);for(r=1;r<30;++r)for(var n=t[r];n<t[r+1];++n)i[n]=n-t[r]<<5|r;return[t,i]},tl=el(Hn,2),Su=tl[0],Ki=tl[1];Su[28]=258,Ki[258]=28;for(en=el(zn,0)[1],br=new le(32768),H=0;H<32768;++H)lt=(43690&H)>>>1|(21845&H)<<1,lt=(61680&(lt=(52428&lt)>>>2|(13107&lt)<<2))>>>4|(3855&lt)<<4,br[H]=((65280&lt)>>>8|(255&lt)<<8)>>>1;var lt,en,br,H,Ds=function(s,e,t){for(var r=s.length,i=0,n=new le(e);i<r;++i)++n[s[i]-1];var a,o=new le(e);for(i=0;i<e;++i)o[i]=o[i-1]+n[i-1]<<1;if(t){a=new le(1<<e);var l=15-e;for(i=0;i<r;++i)if(s[i])for(var c=i<<4|s[i],u=e-s[i],d=o[s[i]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)a[br[d]>>>l]=c}else for(a=new le(r),i=0;i<r;++i)a[i]=br[o[s[i]-1]++]>>>15-s[i];return a},Tt=new Ee(288);for(H=0;H<144;++H)Tt[H]=8;for(H=144;H<256;++H)Tt[H]=9;for(H=256;H<280;++H)Tt[H]=7;for(H=280;H<288;++H)Tt[H]=8;var wr=new Ee(32);for(H=0;H<32;++H)wr[H]=5;var Tu=Ds(Tt,9,0),Ru=Ds(wr,5,0),sl=function(s){return(s/8>>0)+(7&s&&1)},rl=function(s,e,t){(t==null||t>s.length)&&(t=s.length);var r=new(s instanceof le?le:s instanceof as?as:Ee)(t-e);return r.set(s.subarray(e,t)),r},Ve=function(s,e,t){t<<=7&e;var r=e/8>>0;s[r]|=t,s[r+1]|=t>>>8},ws=function(s,e,t){t<<=7&e;var r=e/8>>0;s[r]|=t,s[r+1]|=t>>>8,s[r+2]|=t>>>16},li=function(s,e){for(var t=[],r=0;r<s.length;++r)s[r]&&t.push({s:r,f:s[r]});var i=t.length,n=t.slice();if(!i)return[new Ee(0),0];if(i==1){var a=new Ee(t[0].s+1);return a[t[0].s]=1,[a,1]}t.sort(function(M,W){return M.f-W.f}),t.push({s:-1,f:25001});var o=t[0],l=t[1],c=0,u=1,d=2;for(t[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=i-1;)o=t[t[c].f<t[d].f?c++:d++],l=t[c!=u&&t[c].f<t[d].f?c++:d++],t[u++]={s:-1,f:o.f+l.f,l:o,r:l};var h=n[0].s;for(r=1;r<i;++r)n[r].s>h&&(h=n[r].s);var p=new le(h+1),g=tn(t[u-1],p,0);if(g>e){r=0;var v=0,_=g-e,S=1<<_;for(n.sort(function(M,W){return p[W.s]-p[M.s]||M.f-W.f});r<i;++r){var O=n[r].s;if(!(p[O]>e))break;v+=S-(1<<g-p[O]),p[O]=e}for(v>>>=_;v>0;){var A=n[r].s;p[A]<e?v-=1<<e-p[A]++-1:++r}for(;r>=0&&v;--r){var I=n[r].s;p[I]==e&&(--p[I],++v)}g=e}return[new Ee(p),g]},tn=function(s,e,t){return s.s==-1?Math.max(tn(s.l,e,t+1),tn(s.r,e,t+1)):e[s.s]=t},to=function(s){for(var e=s.length;e&&!s[--e];);for(var t=new le(++e),r=0,i=s[0],n=1,a=function(l){t[r++]=l},o=1;o<=e;++o)if(s[o]==i&&o!=e)++n;else{if(!i&&n>2){for(;n>138;n-=138)a(32754);n>2&&(a(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(a(i),--n;n>6;n-=6)a(8304);n>2&&(a(n-3<<5|8208),n=0)}for(;n--;)a(i);n=1,i=s[o]}return[t.subarray(0,r),e]},Es=function(s,e){for(var t=0,r=0;r<e.length;++r)t+=s[r]*e[r];return t},sn=function(s,e,t){var r=t.length,i=sl(e+2);s[i]=255&r,s[i+1]=r>>>8,s[i+2]=255^s[i],s[i+3]=255^s[i+1];for(var n=0;n<r;++n)s[i+n+4]=t[n];return 8*(i+4+r)},so=function(s,e,t,r,i,n,a,o,l,c,u){Ve(e,u++,t),++i[256];for(var d=li(i,15),h=d[0],p=d[1],g=li(n,15),v=g[0],_=g[1],S=to(h),O=S[0],A=S[1],I=to(v),M=I[0],W=I[1],Q=new le(19),j=0;j<O.length;++j)Q[31&O[j]]++;for(j=0;j<M.length;++j)Q[31&M[j]]++;for(var De=li(Q,7),ge=De[0],Ae=De[1],ye=19;ye>4&&!ge[eo[ye-1]];--ye);var We,Me,Le,Vt,it=c+5<<3,wt=Es(i,Tt)+Es(n,wr)+a,$e=Es(i,h)+Es(n,v)+a+14+3*ye+Es(Q,ge)+(2*Q[16]+3*Q[17]+7*Q[18]);if(it<=wt&&it<=$e)return sn(e,u,s.subarray(l,l+c));if(Ve(e,u,1+($e<wt)),u+=2,$e<wt){We=Ds(h,p,0),Me=h,Le=Ds(v,_,0),Vt=v;var nt=Ds(ge,Ae,0);for(Ve(e,u,A-257),Ve(e,u+5,W-1),Ve(e,u+10,ye-4),u+=14,j=0;j<ye;++j)Ve(e,u+3*j,ge[eo[j]]);u+=3*ye;for(var Gt=[O,M],ae=0;ae<2;++ae){var be=Gt[ae];for(j=0;j<be.length;++j){var ve=31&be[j];Ve(e,u,nt[ve]),u+=ge[ve],ve>15&&(Ve(e,u,be[j]>>>5&127),u+=be[j]>>>12)}}}else We=Tu,Me=Tt,Le=Ru,Vt=wr;for(j=0;j<o;++j)if(r[j]>255){ve=r[j]>>>18&31,ws(e,u,We[ve+257]),u+=Me[ve+257],ve>7&&(Ve(e,u,r[j]>>>23&31),u+=Hn[ve]);var Zt=31&r[j];ws(e,u,Le[Zt]),u+=Vt[Zt],Zt>3&&(ws(e,u,r[j]>>>5&8191),u+=zn[Zt])}else ws(e,u,We[r[j]]),u+=Me[r[j]];return ws(e,u,We[256]),u+Me[256]},Cu=new as([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Au=function(){for(var s=new as(256),e=0;e<256;++e){for(var t=e,r=9;--r;)t=(1&t&&3988292384)^t>>>1;s[e]=t}return s}(),Iu=function(){var s=4294967295;return{p:function(e){for(var t=s,r=0;r<e.length;++r)t=Au[255&t^e[r]]^t>>>8;s=t},d:function(){return 4294967295^s}}},Pu=function(s,e,t,r,i){return function(n,a,o,l,c,u){var d=n.length,h=new Ee(l+d+5*(1+Math.floor(d/7e3))+c),p=h.subarray(l,h.length-c),g=0;if(!a||d<8)for(var v=0;v<=d;v+=65535){var _=v+65535;_<d?g=sn(p,g,n.subarray(v,_)):(p[v]=u,g=sn(p,g,n.subarray(v,d)))}else{for(var S=Cu[a-1],O=S>>>13,A=8191&S,I=(1<<o)-1,M=new le(32768),W=new le(I+1),Q=Math.ceil(o/3),j=2*Q,De=function(ei){return(n[ei]^n[ei+1]<<Q^n[ei+2]<<j)&I},ge=new as(25e3),Ae=new le(288),ye=new le(32),We=0,Me=0,Le=(v=0,0),Vt=0,it=0;v<d;++v){var wt=De(v),$e=32767&v,nt=W[wt];if(M[$e]=nt,W[wt]=$e,Vt<=v){var Gt=d-v;if((We>7e3||Le>24576)&&Gt>423){g=so(n,p,0,ge,Ae,ye,Me,Le,it,v-it,g),Le=We=Me=0,it=v;for(var ae=0;ae<286;++ae)Ae[ae]=0;for(ae=0;ae<30;++ae)ye[ae]=0}var be=2,ve=0,Zt=A,at=$e-nt&32767;if(Gt>2&&wt==De(v-at))for(var yc=Math.min(O,Gt)-1,bc=Math.min(32767,v),wc=Math.min(258,Gt);at<=bc&&--Zt&&$e!=nt;){if(n[v+be]==n[v+be-at]){for(var ot=0;ot<wc&&n[v+ot]==n[v+ot-at];++ot);if(ot>be){if(be=ot,ve=at,ot>yc)break;var Ec=Math.min(at,ot-2),ma=0;for(ae=0;ae<Ec;++ae){var Kr=v-at+ae+32768&32767,_a=Kr-M[Kr]+32768&32767;_a>ma&&(ma=_a,nt=Kr)}}}at+=($e=nt)-(nt=M[$e])+32768&32767}if(ve){ge[Le++]=268435456|Ki[be]<<18|en[ve];var ya=31&Ki[be],ba=31&en[ve];Me+=Hn[ya]+zn[ba],++Ae[257+ya],++ye[ba],Vt=v+be,++We}else ge[Le++]=n[v],++Ae[n[v]]}}g=so(n,p,u,ge,Ae,ye,Me,Le,it,v-it,g)}return rl(h,0,l+sl(g)+c)}(s,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(s.length)))):12+e.mem,t,r,!0)},rn=function(s,e,t){for(;t;++e)s[e]=t,t>>>=8},Ou=function(s,e){var t=e.filename;if(s[0]=31,s[1]=139,s[2]=8,s[8]=e.level<2?4:e.level==9?2:0,s[9]=3,e.mtime!=0&&rn(s,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){s[3]=8;for(var r=0;r<=t.length;++r)s[r+10]=t.charCodeAt(r)}},Du=function(s){return 10+(s.filename&&s.filename.length+1||0)};function il(s,e){e===void 0&&(e={});var t=Iu(),r=s.length;t.p(s);var i=Pu(s,e,Du(e),8),n=i.length;return Ou(i,e),rn(i,n-8,t.d()),rn(i,n-4,r),i}function nl(s,e){var t=s.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(s);for(var r=new Ee(s.length+(s.length>>>1)),i=0,n=function(c){r[i++]=c},a=0;a<t;++a){if(i+5>r.length){var o=new Ee(i+8+(t-a<<1));o.set(r),r=o}var l=s.charCodeAt(a);l<128||e?n(l):l<2048?(n(192|l>>>6),n(128|63&l)):l>55295&&l<57344?(n(240|(l=65536+(1047552&l)|1023&s.charCodeAt(++a))>>>18),n(128|l>>>12&63),n(128|l>>>6&63),n(128|63&l)):(n(224|l>>>12),n(128|l>>>6&63),n(128|63&l))}return rl(r,0,i)}function Mu(s,e){return function(t){for(var r=0,i=0;i<t.length;i++)r=(r<<5)-r+t.charCodeAt(i),r|=0;return Math.abs(r)}(s)%100<_e(100*e,0,100,E)}var gt="disabled",Wn="sampled",Er="active",Rt="buffering",Vn="paused",Gn="trigger",Ue=Gn+"_activated",ie=Gn+"_pending",Be=Gn+"_"+gt;function ro(s,e){return e.some(t=>t.matching==="regex"&&new RegExp(t.url).test(s))}var xr=class{constructor(e){this.Pt=e}triggerStatus(e){var t=this.Pt.map(r=>r.triggerStatus(e));return t.includes(Ue)?Ue:t.includes(ie)?ie:Be}stop(){this.Pt.forEach(e=>e.stop())}},kr=class{constructor(e){this.Pt=e}triggerStatus(e){var t=new Set;for(var r of this.Pt)t.add(r.triggerStatus(e));switch(t.delete(Be),t.size){case 0:return Be;case 1:return Array.from(t)[0];default:return ie}}stop(){this.Pt.forEach(e=>e.stop())}},nn=class{triggerStatus(){return ie}stop(){}},Sr=s=>"sessionRecording"in s,an=class{constructor(e){this.It=[],this.Rt=[],this.urlBlocked=!1,this._instance=e}onConfig(e){var t,r;this.It=(Sr(e)?(t=e.sessionRecording)==null?void 0:t.urlTriggers:e?.urlTriggers)||[],this.Rt=(Sr(e)?(r=e.sessionRecording)==null?void 0:r.urlBlocklist:e?.urlBlocklist)||[]}Tt(e){var t;return this.It.length===0?Be:((t=this._instance)==null?void 0:t.get_property(Di))===e?Ue:ie}triggerStatus(e){var t=this.Tt(e),r=t===Ue?Ue:t===ie?ie:Be;return this._instance.register_for_session({$sdk_debug_replay_url_trigger_status:r}),r}checkUrlTriggerConditions(e,t,r){if(f!==void 0&&f.location.href){var i=f.location.href,n=this.urlBlocked,a=ro(i,this.Rt);n&&a||(a&&!n?e():!a&&n&&t(),ro(i,this.It)&&r("url"))}}stop(){}},on=class{constructor(e){this.linkedFlag=null,this.linkedFlagSeen=!1,this.Ct=()=>{},this._instance=e}triggerStatus(){var e=ie;return U(this.linkedFlag)&&(e=Be),this.linkedFlagSeen&&(e=Ue),this._instance.register_for_session({$sdk_debug_replay_linked_flag_trigger_status:e}),e}onConfig(e,t){var r;if(this.linkedFlag=(Sr(e)?(r=e.sessionRecording)==null?void 0:r.linkedFlag:e?.linkedFlag)||null,!U(this.linkedFlag)&&!this.linkedFlagSeen){var i=Z(this.linkedFlag)?this.linkedFlag:this.linkedFlag.flag,n=Z(this.linkedFlag)?null:this.linkedFlag.variant;this.Ct=this._instance.onFeatureFlags((a,o)=>{var l=!1;if(G(o)&&i in o){var c=o[i];l=Pe(c)?c===!0:n?c===n:!!c}this.linkedFlagSeen=l,l&&t(i,n)})}}stop(){this.Ct()}},ln=class{constructor(e){this.Mt=[],this._instance=e}onConfig(e){var t;this.Mt=(Sr(e)?(t=e.sessionRecording)==null?void 0:t.eventTriggers:e?.eventTriggers)||[]}Ot(e){var t;return this.Mt.length===0?Be:((t=this._instance)==null?void 0:t.get_property(Mi))===e?Ue:ie}triggerStatus(e){var t=this.Ot(e),r=t===Ue?Ue:t===ie?ie:Be;return this._instance.register_for_session({$sdk_debug_replay_event_trigger_status:r}),r}stop(){}};function Lu(s){return s.isRecordingEnabled?Rt:gt}function $u(s){if(!s.receivedFlags)return Rt;if(!s.isRecordingEnabled)return gt;if(s.urlTriggerMatching.urlBlocked)return Vn;var e=s.isSampled===!0,t=new xr([s.eventTriggerMatching,s.urlTriggerMatching,s.linkedFlagMatching]).triggerStatus(s.sessionId);return e?Wn:t===Ue?Er:t===ie?Rt:s.isSampled===!1?gt:Er}function Nu(s){if(!s.receivedFlags)return Rt;if(!s.isRecordingEnabled)return gt;if(s.urlTriggerMatching.urlBlocked)return Vn;var e=new kr([s.eventTriggerMatching,s.urlTriggerMatching,s.linkedFlagMatching]).triggerStatus(s.sessionId),t=e!==Be,r=Pe(s.isSampled);return t&&e===ie?Rt:t&&e===Be||r&&!s.isSampled?gt:s.isSampled===!0?Wn:Er}var As="[SessionRecording]",K=X(As);function tr(){var s;return R==null||(s=R.__PosthogExtensions__)==null||(s=s.rrweb)==null?void 0:s.record}var Fu=3e5,ju=[Ie.MouseMove,Ie.MouseInteraction,Ie.Scroll,Ie.ViewportResize,Ie.Input,Ie.TouchMove,Ie.MediaInteraction,Ie.Drag],io=s=>({rrwebMethod:s,enqueuedAt:Date.now(),attempt:1});function xt(s){return function(e,t){for(var r="",i=0;i<e.length;){var n=e[i++];r+=String.fromCharCode(n)}return r}(il(nl(JSON.stringify(s))))}function no(s){return s.type===Ye.Custom&&s.data.tag==="sessionIdle"}var Tr=class{get sessionId(){return this.Ft}get At(){return this._instance.config.session_recording.session_idle_threshold_ms||3e5}get started(){return this.Dt}get jt(){if(!this._instance.sessionManager)throw new Error(As+" must be started with a valid sessionManager.");return this._instance.sessionManager}get Lt(){var e,t;return this.Nt.triggerStatus(this.sessionId)===ie?6e4:(e=(t=this._instance.config.session_recording)==null?void 0:t.full_snapshot_interval_millis)!==null&&e!==void 0?e:Fu}get Ut(){var e=this._instance.get_property(Kt);return Pe(e)?e:null}get zt(){var e,t,r=(e=this.H)==null?void 0:e.data[((t=this.H)==null?void 0:t.data.length)-1],{sessionStartTimestamp:i}=this.jt.checkAndGetSessionAndWindowId(!0);return r?r.timestamp-i:null}get qt(){var e=!!this._instance.get_property(Oi),t=!this._instance.config.disable_session_recording;return f&&e&&t}get Bt(){var e=!!this._instance.get_property(Na),t=this._instance.config.enable_recording_console_log;return t??e}get Ht(){var e,t,r,i,n,a,o=this._instance.config.session_recording.captureCanvas,l=this._instance.get_property(Ua),c=(e=(t=o?.recordCanvas)!==null&&t!==void 0?t:l?.enabled)!==null&&e!==void 0&&e,u=(r=(i=o?.canvasFps)!==null&&i!==void 0?i:l?.fps)!==null&&r!==void 0?r:4,d=(n=(a=o?.canvasQuality)!==null&&a!==void 0?a:l?.quality)!==null&&n!==void 0?n:.4;if(typeof d=="string"){var h=parseFloat(d);d=isNaN(h)?.4:h}return{enabled:c,fps:_e(u,0,12,K.createLogger("canvas recording fps"),4),quality:_e(d,0,1,K.createLogger("canvas recording quality"),.4)}}get Wt(){var e,t,r=this._instance.get_property(Fa),i={recordHeaders:(e=this._instance.config.session_recording)==null?void 0:e.recordHeaders,recordBody:(t=this._instance.config.session_recording)==null?void 0:t.recordBody},n=i?.recordHeaders||r?.recordHeaders,a=i?.recordBody||r?.recordBody,o=G(this._instance.config.capture_performance)?this._instance.config.capture_performance.network_timing:this._instance.config.capture_performance,l=!!(Pe(o)?o:r?.capturePerformance);return n||a||l?{recordHeaders:n,recordBody:a,recordPerformance:l}:void 0}get Gt(){var e,t,r,i,n,a,o=this._instance.get_property(ja),l={maskAllInputs:(e=this._instance.config.session_recording)==null?void 0:e.maskAllInputs,maskTextSelector:(t=this._instance.config.session_recording)==null?void 0:t.maskTextSelector,blockSelector:(r=this._instance.config.session_recording)==null?void 0:r.blockSelector},c=(i=l?.maskAllInputs)!==null&&i!==void 0?i:o?.maskAllInputs,u=(n=l?.maskTextSelector)!==null&&n!==void 0?n:o?.maskTextSelector,d=(a=l?.blockSelector)!==null&&a!==void 0?a:o?.blockSelector;return y(c)&&y(u)&&y(d)?void 0:{maskAllInputs:c==null||c,maskTextSelector:u,blockSelector:d}}get Vt(){var e=this._instance.get_property(Ba);return re(e)?e:null}get Jt(){var e=this._instance.get_property(qa);return re(e)?e:null}get status(){return this.Kt?this.Yt({receivedFlags:this.Kt,isRecordingEnabled:this.qt,isSampled:this.Ut,urlTriggerMatching:this.Xt,eventTriggerMatching:this.Qt,linkedFlagMatching:this.Zt,sessionId:this.sessionId}):Rt}constructor(e){if(this.Yt=Lu,this.Kt=!1,this.ti=[],this.ii="unknown",this.ei=Date.now(),this.Nt=new nn,this.ri=void 0,this.si=void 0,this.ni=void 0,this.oi=void 0,this.ai=void 0,this._forceAllowLocalhostNetworkCapture=!1,this.li=()=>{this.ui()},this.hi=()=>{this.tryAddCustomEvent("browser offline",{})},this.di=()=>{this.tryAddCustomEvent("browser online",{})},this.vi=()=>{if(k!=null&&k.visibilityState){var i="window "+k.visibilityState;this.tryAddCustomEvent(i,{})}},this._instance=e,this.Dt=!1,this.ci="/s/",this.fi=void 0,this.Kt=!1,!this._instance.sessionManager)throw K.error("started without valid sessionManager"),new Error(As+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(As+' cannot be used with cookieless_mode="always"');this.Zt=new on(this._instance),this.Xt=new an(this._instance),this.Qt=new ln(this._instance);var{sessionId:t,windowId:r}=this.jt.checkAndGetSessionAndWindowId();this.Ft=t,this.pi=r,this.H=this.gi(),this.At>=this.jt.sessionTimeoutMs&&K.warn("session_idle_threshold_ms ("+this.At+") is greater than the session timeout ("+this.jt.sessionTimeoutMs+"). Session will never be detected as idle")}startIfEnabledOrStop(e){this.qt?(this.mi(e),V(f,"beforeunload",this.li),V(f,"offline",this.hi),V(f,"online",this.di),V(f,"visibilitychange",this.vi),this.yi(),this.bi(),U(this.ri)&&(this.ri=this._instance.on("eventCaptured",t=>{try{if(t.event==="$pageview"){var r=t!=null&&t.properties.$current_url?this.wi(t?.properties.$current_url):"";if(!r)return;this.tryAddCustomEvent("$pageview",{href:r})}}catch(i){K.error("Could not add $pageview to rrweb session",i)}})),this.si||(this.si=this.jt.onSessionId((t,r,i)=>{var n,a;i&&(this.tryAddCustomEvent("$session_id_change",{sessionId:t,windowId:r,changeReason:i}),(n=this._instance)==null||(n=n.persistence)==null||n.unregister(Mi),(a=this._instance)==null||(a=a.persistence)==null||a.unregister(Di))}))):this.stopRecording()}stopRecording(){var e,t,r,i;this.Dt&&this.fi&&(this.fi(),this.fi=void 0,this.Dt=!1,f?.removeEventListener("beforeunload",this.li),f?.removeEventListener("offline",this.hi),f?.removeEventListener("online",this.di),f?.removeEventListener("visibilitychange",this.vi),this.gi(),clearInterval(this.Si),(e=this.ri)==null||e.call(this),this.ri=void 0,(t=this.ai)==null||t.call(this),this.ai=void 0,(r=this.si)==null||r.call(this),this.si=void 0,(i=this.oi)==null||i.call(this),this.oi=void 0,this.Qt.stop(),this.Xt.stop(),this.Zt.stop(),K.info("stopped"))}ki(){var e;(e=this._instance.persistence)==null||e.unregister(Kt)}$i(e){var t,r=this.Ft!==e,i=this.Vt;if(re(i)){var n=this.Ut,a=r||!Pe(n),o=a?Mu(e,i):n;a&&(o?this.xi(Wn):K.warn("Sample rate ("+i+") has determined that this sessionId ("+e+") will not be sent to the server."),this.tryAddCustomEvent("samplingDecisionMade",{sampleRate:i,isSampled:o})),(t=this._instance.persistence)==null||t.register({[Kt]:o})}else this.ki()}onRemoteConfig(e){var t,r,i,n;this.tryAddCustomEvent("$remote_config_received",e),this.Ei(e),(t=e.sessionRecording)!=null&&t.endpoint&&(this.ci=(n=e.sessionRecording)==null?void 0:n.endpoint),this.yi(),((r=e.sessionRecording)==null?void 0:r.triggerMatchType)==="any"?(this.Yt=$u,this.Nt=new xr([this.Qt,this.Xt])):(this.Yt=Nu,this.Nt=new kr([this.Qt,this.Xt])),this._instance.register_for_session({$sdk_debug_replay_remote_trigger_matching_config:(i=e.sessionRecording)==null?void 0:i.triggerMatchType}),this.Xt.onConfig(e),this.Qt.onConfig(e),this.Zt.onConfig(e,(a,o)=>{this.xi("linked_flag_matched",{flag:a,variant:o})}),this.Kt=!0,this.startIfEnabledOrStop()}yi(){re(this.Vt)&&U(this.oi)&&(this.oi=this.jt.onSessionId(e=>{this.$i(e)}))}Ei(e){if(this._instance.persistence){var t,r=this._instance.persistence,i=()=>{var n,a,o,l,c,u,d,h,p,g=(n=e.sessionRecording)==null?void 0:n.sampleRate,v=U(g)?null:parseFloat(g);U(v)&&this.ki();var _=(a=e.sessionRecording)==null?void 0:a.minimumDurationMilliseconds;r.register({[Oi]:!!e.sessionRecording,[Na]:(o=e.sessionRecording)==null?void 0:o.consoleLogRecordingEnabled,[Fa]:b({capturePerformance:e.capturePerformance},(l=e.sessionRecording)==null?void 0:l.networkPayloadCapture),[ja]:(c=e.sessionRecording)==null?void 0:c.masking,[Ua]:{enabled:(u=e.sessionRecording)==null?void 0:u.recordCanvas,fps:(d=e.sessionRecording)==null?void 0:d.canvasFps,quality:(h=e.sessionRecording)==null?void 0:h.canvasQuality},[Ba]:v,[qa]:y(_)?null:_,[Ha]:(p=e.sessionRecording)==null?void 0:p.scriptConfig})};i(),(t=this.ni)==null||t.call(this),this.ni=this.jt.onSessionId(i)}}log(e,t){var r;t===void 0&&(t="log"),(r=this._instance.sessionRecording)==null||r.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:t,trace:[],payload:[JSON.stringify(e)]}},timestamp:Date.now()})}mi(e){if(!y(Object.assign)&&!y(Array.from)&&!(this.Dt||this._instance.config.disable_session_recording||this._instance.consent.isOptedOut())){var t;this.Dt=!0,this.jt.checkAndGetSessionAndWindowId(),tr()?this.Pi():(t=R.__PosthogExtensions__)==null||t.loadExternalDependency==null||t.loadExternalDependency(this._instance,this.Ii,r=>{if(r)return K.error("could not load recorder",r);this.Pi()}),K.info("starting"),this.status===Er&&this.xi(e||"recording_initialized")}}get Ii(){var e;return((e=this._instance)==null||(e=e.persistence)==null||(e=e.get_property(Ha))==null?void 0:e.script)||"recorder"}Ri(e){var t;return e.type===3&&ju.indexOf((t=e.data)==null?void 0:t.source)!==-1}Ti(e){var t=this.Ri(e);t||this.ii||e.timestamp-this.ei>this.At&&(this.ii=!0,clearInterval(this.Si),this.tryAddCustomEvent("sessionIdle",{eventTimestamp:e.timestamp,lastActivityTimestamp:this.ei,threshold:this.At,bufferLength:this.H.data.length,bufferSize:this.H.size}),this.ui());var r=!1;if(t&&(this.ei=e.timestamp,this.ii)){var i=this.ii==="unknown";this.ii=!1,i||(this.tryAddCustomEvent("sessionNoLongerIdle",{reason:"user activity",type:e.type}),r=!0)}if(!this.ii){var{windowId:n,sessionId:a}=this.jt.checkAndGetSessionAndWindowId(!t,e.timestamp),o=this.Ft!==a,l=this.pi!==n;this.pi=n,this.Ft=a,o||l?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):r&&this.Ci()}}Mi(e){try{return e.rrwebMethod(),!0}catch(t){return this.ti.length<10?this.ti.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):K.warn("could not emit queued rrweb event.",t,e),!1}}tryAddCustomEvent(e,t){return this.Mi(io(()=>tr().addCustomEvent(e,t)))}Oi(){return this.Mi(io(()=>tr().takeFullSnapshot()))}Pi(){var e,t,r,i,n={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},a=this._instance.config.session_recording;for(var[o,l]of Object.entries(a||{}))o in n&&(o==="maskInputOptions"?n.maskInputOptions=b({password:!0},l):n[o]=l);this.Ht&&this.Ht.enabled&&(n.recordCanvas=!0,n.sampling={canvas:this.Ht.fps},n.dataURLOptions={type:"image/webp",quality:this.Ht.quality}),this.Gt&&(n.maskAllInputs=(t=this.Gt.maskAllInputs)===null||t===void 0||t,n.maskTextSelector=(r=this.Gt.maskTextSelector)!==null&&r!==void 0?r:void 0,n.blockSelector=(i=this.Gt.blockSelector)!==null&&i!==void 0?i:void 0);var c=tr();if(c){this.Fi=(e=this.Fi)!==null&&e!==void 0?e:new Qi(c,{refillRate:this._instance.config.session_recording.__mutationThrottlerRefillRate,bucketSize:this._instance.config.session_recording.__mutationThrottlerBucketSize,onBlockedNode:(d,h)=>{var p="Too many mutations on node '"+d+"'. Rate limiting. This could be due to SVG animations or something similar";K.info(p,{node:h}),this.log(As+" "+p,"warn")}});var u=this.Ai();this.fi=c(b({emit:d=>{this.onRRwebEmit(d)},plugins:u},n)),this.ei=Date.now(),this.ii=Pe(this.ii)?this.ii:"unknown",this.tryAddCustomEvent("$session_options",{sessionRecordingOptions:n,activePlugins:u.map(d=>d?.name)}),this.tryAddCustomEvent("$posthog_config",{config:this._instance.config})}else K.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}Ci(){if(this.Si&&clearInterval(this.Si),this.ii!==!0){var e=this.Lt;e&&(this.Si=setInterval(()=>{this.Oi()},e))}}Ai(){var e,t,r=[],i=(e=R.__PosthogExtensions__)==null||(e=e.rrwebPlugins)==null?void 0:e.getRecordConsolePlugin;i&&this.Bt&&r.push(i());var n=(t=R.__PosthogExtensions__)==null||(t=t.rrwebPlugins)==null?void 0:t.getRecordNetworkPlugin;return this.Wt&&we(n)&&(!cu.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?r.push(n(ku(this._instance.config,this.Wt))):K.info("NetworkCapture not started because we are on localhost.")),r}onRRwebEmit(e){var t;if(this.Di(),e&&G(e)){if(e.type===Ye.Meta){var r=this.wi(e.data.href);if(this.ji=r,!r)return;e.data.href=r}else this.Li();if(this.Xt.checkUrlTriggerConditions(()=>this.Ni(),()=>this.Ui(),h=>this.zi(h)),!this.Xt.urlBlocked||(i=e).type===Ye.Custom&&i.data.tag==="recording paused"){var i;e.type===Ye.FullSnapshot&&this.Ci(),e.type===Ye.FullSnapshot&&this.Kt&&this.Nt.triggerStatus(this.sessionId)===ie&&this.gi();var n=this.Fi?this.Fi.throttleMutations(e):e;if(n){var a=function(h){var p=h;if(p&&G(p)&&p.type===6&&G(p.data)&&p.data.plugin==="rrweb/console@1"){p.data.payload.payload.length>10&&(p.data.payload.payload=p.data.payload.payload.slice(0,10),p.data.payload.payload.push("...[truncated]"));for(var g=[],v=0;v<p.data.payload.payload.length;v++)p.data.payload.payload[v]&&p.data.payload.payload[v].length>2e3?g.push(p.data.payload.payload[v].slice(0,2e3)+"...[truncated]"):g.push(p.data.payload.payload[v]);return p.data.payload.payload=g,h}return h}(n);if(this.Ti(a),this.ii!==!0||no(a)){if(no(a)){var o=a.data.payload;if(o){var l=o.lastActivityTimestamp,c=o.threshold;a.timestamp=l+c}}var u=(t=this._instance.config.session_recording.compress_events)===null||t===void 0||t?function(h){if(yr(h)<1024)return h;try{if(h.type===Ye.FullSnapshot)return b({},h,{data:xt(h.data),cv:"2024-10"});if(h.type===Ye.IncrementalSnapshot&&h.data.source===Ie.Mutation)return b({},h,{cv:"2024-10",data:b({},h.data,{texts:xt(h.data.texts),attributes:xt(h.data.attributes),removes:xt(h.data.removes),adds:xt(h.data.adds)})});if(h.type===Ye.IncrementalSnapshot&&h.data.source===Ie.StyleSheetRule)return b({},h,{cv:"2024-10",data:b({},h.data,{adds:h.data.adds?xt(h.data.adds):void 0,removes:h.data.removes?xt(h.data.removes):void 0})})}catch(p){K.error("could not compress event - will use uncompressed event",p)}return h}(a):a,d={$snapshot_bytes:yr(u),$snapshot_data:u,$session_id:this.Ft,$window_id:this.pi};this.status!==gt?this.qi(d):this.gi()}}}}}Li(){if(!this._instance.config.capture_pageview&&f){var e=this.wi(f.location.href);this.ji!==e&&(this.tryAddCustomEvent("$url_changed",{href:e}),this.ji=e)}}Di(){if(this.ti.length){var e=[...this.ti];this.ti=[],e.forEach(t=>{Date.now()-t.enqueuedAt<=2e3&&this.Mi(t)})}}wi(e){var t=this._instance.config.session_recording;if(t.maskNetworkRequestFn){var r,i={url:e};return(r=i=t.maskNetworkRequestFn(i))==null?void 0:r.url}return e}gi(){return this.H={size:0,data:[],sessionId:this.Ft,windowId:this.pi},this.H}ui(){this.Bi&&(clearTimeout(this.Bi),this.Bi=void 0);var e=this.Jt,t=this.zt,r=re(t)&&t>=0,i=re(e)&&r&&t<e;return this.status===Rt||this.status===Vn||this.status===gt||i?(this.Bi=setTimeout(()=>{this.ui()},2e3),this.H):(this.H.data.length>0&&Yi(this.H).forEach(n=>{this.Hi({$snapshot_bytes:n.size,$snapshot_data:n.data,$session_id:n.sessionId,$window_id:n.windowId,$lib:"web",$lib_version:Je.LIB_VERSION})}),this.gi())}qi(e){var t,r=2+(((t=this.H)==null?void 0:t.data.length)||0);!this.ii&&(this.H.size+e.$snapshot_bytes+r>943718.4||this.H.sessionId!==this.Ft)&&(this.H=this.ui()),this.H.size+=e.$snapshot_bytes,this.H.data.push(e.$snapshot_data),this.Bi||this.ii||(this.Bi=setTimeout(()=>{this.ui()},2e3))}Hi(e){this._instance.capture("$snapshot",e,{_url:this._instance.requestRouter.endpointFor("api",this.ci),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}zi(e){var t;this.Nt.triggerStatus(this.sessionId)===ie&&((t=this._instance)==null||(t=t.persistence)==null||t.register({[e==="url"?Di:Mi]:this.Ft}),this.ui(),this.xi(e+"_trigger_matched"))}Ni(){this.Xt.urlBlocked||(this.Xt.urlBlocked=!0,clearInterval(this.Si),K.info("recording paused due to URL blocker"),this.tryAddCustomEvent("recording paused",{reason:"url blocker"}))}Ui(){this.Xt.urlBlocked&&(this.Xt.urlBlocked=!1,this.Oi(),this.Ci(),this.tryAddCustomEvent("recording resumed",{reason:"left blocked url"}),K.info("recording resumed"))}bi(){this.Qt.Mt.length!==0&&U(this.ai)&&(this.ai=this._instance.on("eventCaptured",e=>{try{this.Qt.Mt.includes(e.event)&&this.zi("event")}catch(t){K.error("Could not activate event trigger",t)}}))}overrideLinkedFlag(){this.Zt.linkedFlagSeen=!0,this.Oi(),this.xi("linked_flag_overridden")}overrideSampling(){var e;(e=this._instance.persistence)==null||e.register({[Kt]:!0}),this.Oi(),this.xi("sampling_overridden")}overrideTrigger(e){this.zi(e)}xi(e,t){this._instance.register_for_session({$session_recording_start_reason:e}),K.info(e.replace("_"," "),t),N(["recording_initialized","session_id_changed"],e)||this.tryAddCustomEvent(e,t)}get sdkDebugProperties(){var{sessionStartTimestamp:e}=this.jt.checkAndGetSessionAndWindowId(!0);return{$recording_status:this.status,$sdk_debug_replay_internal_buffer_length:this.H.data.length,$sdk_debug_replay_internal_buffer_size:this.H.size,$sdk_debug_current_session_duration:this.zt,$sdk_debug_session_start:e}}},ci=X("[SegmentIntegration]");function Uu(s,e){var t=s.config.segment;if(!t)return e();(function(r,i){var n=r.config.segment;if(!n)return i();var a=l=>{var c=()=>l.anonymousId()||ht();r.config.get_device_id=c,l.id()&&(r.register({distinct_id:l.id(),$device_id:c()}),r.persistence.set_property(Ge,"identified")),i()},o=n.user();"then"in o&&we(o.then)?o.then(l=>a(l)):a(o)})(s,()=>{t.register((r=>{Promise&&Promise.resolve||ci.warn("This browser does not have Promise support, and can not use the segment integration");var i=(n,a)=>{if(!a)return n;n.event.userId||n.event.anonymousId===r.get_distinct_id()||(ci.info("No userId set, resetting PostHog"),r.reset()),n.event.userId&&n.event.userId!==r.get_distinct_id()&&(ci.info("UserId set, identifying with PostHog"),r.identify(n.event.userId));var o=r.calculateEventProperties(a,n.event.properties);return n.event.properties=Object.assign({},o,n.event.properties),n};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:n=>i(n,n.event.event),page:n=>i(n,"$pageview"),identify:n=>i(n,"$identify"),screen:n=>i(n,"$screen")}})(s)).then(()=>{e()})})}var al="posthog-js";function ol(s,e){var{organization:t,projectId:r,prefix:i,severityAllowList:n=["error"],sendExceptionsToPostHog:a=!0}=e===void 0?{}:e;return o=>{var l,c,u,d,h;if(!(n==="*"||n.includes(o.level))||!s.__loaded)return o;o.tags||(o.tags={});var p=s.requestRouter.endpointFor("ui","/project/"+s.config.token+"/person/"+s.get_distinct_id());o.tags["PostHog Person URL"]=p,s.sessionRecordingStarted()&&(o.tags["PostHog Recording URL"]=s.get_session_replay_url({withTimestamp:!0}));var g=((l=o.exception)==null?void 0:l.values)||[],v=g.map(S=>b({},S,{stacktrace:S.stacktrace?b({},S.stacktrace,{type:"raw",frames:(S.stacktrace.frames||[]).map(O=>b({},O,{platform:"web:javascript"}))}):void 0})),_={$exception_message:((c=g[0])==null?void 0:c.value)||o.message,$exception_type:(u=g[0])==null?void 0:u.type,$exception_personURL:p,$exception_level:o.level,$exception_list:v,$sentry_event_id:o.event_id,$sentry_exception:o.exception,$sentry_exception_message:((d=g[0])==null?void 0:d.value)||o.message,$sentry_exception_type:(h=g[0])==null?void 0:h.type,$sentry_tags:o.tags};return t&&r&&(_.$sentry_url=(i||"https://sentry.io/organizations/")+t+"/issues/?project="+r+"&query="+o.event_id),a&&s.exceptions.sendExceptionEvent(_),o}}var cn=class{constructor(e,t,r,i,n,a){this.name=al,this.setupOnce=function(o){o(ol(e,{organization:t,projectId:r,prefix:i,severityAllowList:n,sendExceptionsToPostHog:a==null||a}))}}},Bu=f!=null&&f.location?mr(f.location.hash,"__posthog")||mr(location.hash,"state"):null,ao="_postHogToolbarParams",oo=X("[Toolbar]"),dt=function(s){return s[s.UNINITIALIZED=0]="UNINITIALIZED",s[s.LOADING=1]="LOADING",s[s.LOADED=2]="LOADED",s}(dt||{}),un=class{constructor(e){this.instance=e}Wi(e){R.ph_toolbar_state=e}Gi(){var e;return(e=R.ph_toolbar_state)!==null&&e!==void 0?e:dt.UNINITIALIZED}maybeLoadToolbar(e,t,r){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),r===void 0&&(r=void 0),!f||!k)return!1;e=e??f.location,r=r??f.history;try{if(!t){try{f.localStorage.setItem("test","test"),f.localStorage.removeItem("test")}catch{return!1}t=f?.localStorage}var i,n=Bu||mr(e.hash,"__posthog")||mr(e.hash,"state"),a=n?Pa(()=>JSON.parse(atob(decodeURIComponent(n))))||Pa(()=>JSON.parse(decodeURIComponent(n))):null;return a&&a.action==="ph_authorize"?((i=a).source="url",i&&Object.keys(i).length>0&&(a.desiredHash?e.hash=a.desiredHash:r?r.replaceState(r.state,"",e.pathname+e.search):e.hash="")):((i=JSON.parse(t.getItem(ao)||"{}")).source="localstorage",delete i.userIntent),!(!i.token||this.instance.config.token!==i.token)&&(this.loadToolbar(i),!0)}catch{return!1}}Vi(e){var t=R.ph_load_toolbar||R.ph_load_editor;!U(t)&&we(t)?t(e,this.instance):oo.warn("No toolbar load function found")}loadToolbar(e){var t=!(k==null||!k.getElementById(Uo));if(!f||t)return!1;var r=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,i=b({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},r?{instrument:!1}:{});if(f.localStorage.setItem(ao,JSON.stringify(b({},i,{source:void 0}))),this.Gi()===dt.LOADED)this.Vi(i);else if(this.Gi()===dt.UNINITIALIZED){var n;this.Wi(dt.LOADING),(n=R.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this.instance,"toolbar",a=>{if(a)return oo.error("[Toolbar] Failed to load",a),void this.Wi(dt.UNINITIALIZED);this.Wi(dt.LOADED),this.Vi(i)}),V(f,"turbolinks:load",()=>{this.Wi(dt.UNINITIALIZED),this.loadToolbar(i)})}return!0}Ji(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,r){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),r===void 0&&(r=void 0),this.maybeLoadToolbar(e,t,r)}},qu=X("[TracingHeaders]"),dn=class{constructor(e){this.Ki=void 0,this.Yi=void 0,this.lt=()=>{var t,r;y(this.Ki)&&((t=R.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),y(this.Yi)&&((r=R.__PosthogExtensions__)==null||(r=r.tracingHeadersPatchFns)==null||r._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}nt(e){var t,r;(t=R.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(r=R.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,"tracing-headers",i=>{if(i)return qu.error("failed to load script",i);e()})}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.nt(this.lt):((e=this.Ki)==null||e.call(this),(t=this.Yi)==null||t.call(this),this.Ki=void 0,this.Yi=void 0)}},ct=X("[Web Vitals]"),lo=9e5,hn=class{constructor(e){var t;this.Xi=!1,this.C=!1,this.H={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Qi=()=>{clearTimeout(this.Zi),this.H.metrics.length!==0&&(this._instance.capture("$web_vitals",this.H.metrics.reduce((r,i)=>b({},r,{["$web_vitals_"+i.name+"_event"]:b({},i),["$web_vitals_"+i.name+"_value"]:i.value}),{})),this.H={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.te=r=>{var i,n=(i=this._instance.sessionManager)==null?void 0:i.checkAndGetSessionAndWindowId(!0);if(y(n))ct.error("Could not read session ID. Dropping metrics!");else{this.H=this.H||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var a=this.ie();y(a)||(U(r?.name)||U(r?.value)?ct.error("Invalid metric received",r):this.ee&&r.value>=this.ee?ct.error("Ignoring metric with value >= "+this.ee,r):(this.H.url!==a&&(this.Qi(),this.Zi=setTimeout(this.Qi,this.flushToCaptureTimeoutMs)),y(this.H.url)&&(this.H.url=a),this.H.firstMetricTimestamp=y(this.H.firstMetricTimestamp)?Date.now():this.H.firstMetricTimestamp,r.attribution&&r.attribution.interactionTargetElement&&(r.attribution.interactionTargetElement=void 0),this.H.metrics.push(b({},r,{$current_url:a,$session_id:n.sessionId,$window_id:n.windowId,timestamp:Date.now()})),this.H.metrics.length===this.allowedMetrics.length&&this.Qi()))}},this.lt=()=>{var r,i,n,a,o=R.__PosthogExtensions__;y(o)||y(o.postHogWebVitalsCallbacks)||({onLCP:r,onCLS:i,onFCP:n,onINP:a}=o.postHogWebVitalsCallbacks),r&&i&&n&&a?(this.allowedMetrics.indexOf("LCP")>-1&&r(this.te.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&i(this.te.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&n(this.te.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&a(this.te.bind(this)),this.C=!0):ct.error("web vitals callbacks not loaded - not starting")},this._instance=e,this.Xi=!((t=this._instance.persistence)==null||!t.props[La]),this.startIfEnabled()}get allowedMetrics(){var e,t,r=G(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return y(r)?((t=this._instance.persistence)==null?void 0:t.props[$a])||["CLS","FCP","INP","LCP"]:r}get flushToCaptureTimeoutMs(){return(G(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get ee(){var e=G(this._instance.config.capture_performance)&&re(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:lo;return 0<e&&e<=6e4?lo:e}get isEnabled(){var e=ue?.protocol;if(e!=="http:"&&e!=="https:")return ct.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=G(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Pe(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Pe(t)?t:this.Xi}startIfEnabled(){this.isEnabled&&!this.C&&(ct.info("enabled, starting..."),this.nt(this.lt))}onRemoteConfig(e){var t=G(e.capturePerformance)&&!!e.capturePerformance.web_vitals,r=G(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[La]:t}),this._instance.persistence.register({[$a]:r})),this.Xi=t,this.startIfEnabled()}nt(e){var t,r;(t=R.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks&&e(),(r=R.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,"web-vitals",i=>{i?ct.error("failed to load script",i):e()})}ie(){var e=f?f.location.href:void 0;return e||ct.error("Could not determine current URL"),e}},Hu=X("[Heatmaps]");function co(s){return G(s)&&"clientX"in s&&"clientY"in s&&re(s.clientX)&&re(s.clientY)}var pn=class{constructor(e){var t;this.rageclicks=new gr,this.Xi=!1,this.C=!1,this.re=null,this.instance=e,this.Xi=!((t=this.instance.persistence)==null||!t.props[Ii])}get flushIntervalMilliseconds(){var e=5e3;return G(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return y(this.instance.config.capture_heatmaps)?y(this.instance.config.enable_heatmaps)?this.Xi:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.C)return;Hu.info("starting..."),this.se(),this.re=setInterval(this.ne.bind(this),this.flushIntervalMilliseconds)}else{var e,t;clearInterval((e=this.re)!==null&&e!==void 0?e:void 0),(t=this.oe)==null||t.stop(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[Ii]:t}),this.Xi=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.H;return this.H=void 0,e}ae(e){this.le(e.originalEvent,"deadclick")}se(){f&&k&&(V(f,"beforeunload",this.ne.bind(this)),V(k,"click",e=>this.le(e||f?.event),{capture:!0}),V(k,"mousemove",e=>this.ue(e||f?.event),{capture:!0}),this.oe=new _r(this.instance,yu,this.ae.bind(this)),this.oe.startIfEnabled(),this.C=!0)}he(e,t){var r=this.instance.scrollManager.scrollY(),i=this.instance.scrollManager.scrollX(),n=this.instance.scrollManager.scrollElement(),a=function(o,l,c){for(var u=o;u&&$r(u)&&!ft(u,"body");){if(u===c)return!1;if(N(l,f?.getComputedStyle(u).position))return!0;u=Vo(u)}return!1}(zo(e),["fixed","sticky"],n);return{x:e.clientX+(a?0:i),y:e.clientY+(a?0:r),target_fixed:a,type:t}}le(e,t){var r;if(t===void 0&&(t="click"),!za(e.target)&&co(e)){var i=this.he(e,t);(r=this.rageclicks)!=null&&r.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.de(b({},i,{type:"rageclick"})),this.de(i)}}ue(e){!za(e.target)&&co(e)&&(clearTimeout(this.ve),this.ve=setTimeout(()=>{this.de(this.he(e,"mousemove"))},500))}de(e){if(f){var t=f.location.href;this.H=this.H||{},this.H[t]||(this.H[t]=[]),this.H[t].push(e)}}ne(){this.H&&!Qt(this.H)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}},fn=class{constructor(e){this._instance=e}doPageView(e,t){var r,i=this.ce(e,t);return this.fe={pathname:(r=f?.location.pathname)!==null&&r!==void 0?r:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),i}doPageLeave(e){var t;return this.ce(e,(t=this.fe)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.fe)==null?void 0:e.pageViewId}}ce(e,t){var r=this.fe;if(!r)return{$pageview_id:t};var i={$pageview_id:t,$prev_pageview_id:r.pageViewId},n=this._instance.scrollManager.getContext();if(n&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:a,lastScrollY:o,maxScrollY:l,maxContentHeight:c,lastContentY:u,maxContentY:d}=n;if(!(y(a)||y(o)||y(l)||y(c)||y(u)||y(d))){a=Math.ceil(a),o=Math.ceil(o),l=Math.ceil(l),c=Math.ceil(c),u=Math.ceil(u),d=Math.ceil(d);var h=a<=1?1:_e(o/a,0,1,E),p=a<=1?1:_e(l/a,0,1,E),g=c<=1?1:_e(u/c,0,1,E),v=c<=1?1:_e(d/c,0,1,E);i=Y(i,{$prev_pageview_last_scroll:o,$prev_pageview_last_scroll_percentage:h,$prev_pageview_max_scroll:l,$prev_pageview_max_scroll_percentage:p,$prev_pageview_last_content:u,$prev_pageview_last_content_percentage:g,$prev_pageview_max_content:d,$prev_pageview_max_content_percentage:v})}}return r.pathname&&(i.$prev_pageview_pathname=r.pathname),r.timestamp&&(i.$prev_pageview_duration=(e.getTime()-r.timestamp.getTime())/1e3),i}},zu=function(s){var e,t,r,i,n="";for(e=t=0,r=(s=(s+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,i=0;i<r;i++){var a=s.charCodeAt(i),o=null;a<128?t++:o=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),Qe(o)||(t>e&&(n+=s.substring(e,t)),n+=o,e=t=i+1)}return t>e&&(n+=s.substring(e,s.length)),n},Wu=!!vi||!!gi,uo="text/plain",Rr=(s,e)=>{var[t,r]=s.split("?"),i=b({},e);r?.split("&").forEach(a=>{var[o]=a.split("=");delete i[o]});var n=uu(i);return t+"?"+(n=n?(r?r+"&":"")+n:r)},Is=(s,e)=>JSON.stringify(s,(t,r)=>typeof r=="bigint"?r.toString():r,e),ui=s=>{var{data:e,compression:t}=s;if(e){if(t===Xe.GZipJS){var r=il(nl(Is(e)),{mtime:0}),i=new Blob([r],{type:uo});return{contentType:uo,body:i,estimatedSize:i.size}}if(t===Xe.Base64){var n=function(l){var c,u,d,h,p,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=0,_=0,S="",O=[];if(!l)return l;l=zu(l);do c=(p=l.charCodeAt(v++)<<16|l.charCodeAt(v++)<<8|l.charCodeAt(v++))>>18&63,u=p>>12&63,d=p>>6&63,h=63&p,O[_++]=g.charAt(c)+g.charAt(u)+g.charAt(d)+g.charAt(h);while(v<l.length);switch(S=O.join(""),l.length%3){case 1:S=S.slice(0,-2)+"==";break;case 2:S=S.slice(0,-1)+"="}return S}(Is(e)),a=(l=>"data="+encodeURIComponent(typeof l=="string"?l:Is(l)))(n);return{contentType:"application/x-www-form-urlencoded",body:a,estimatedSize:new Blob([a]).size}}var o=Is(e);return{contentType:"application/json",body:o,estimatedSize:new Blob([o]).size}}},nr=[];gi&&nr.push({transport:"fetch",method:s=>{var e,t,{contentType:r,body:i,estimatedSize:n}=(e=ui(s))!==null&&e!==void 0?e:{},a=new Headers;q(s.headers,function(u,d){a.append(d,u)}),r&&a.append("Content-Type",r);var o=s.url,l=null;if(ka){var c=new ka;l={signal:c.signal,timeout:setTimeout(()=>c.abort(),s.timeout)}}gi(o,b({method:s?.method||"GET",headers:a,keepalive:s.method==="POST"&&(n||0)<52428.8,body:i,signal:(t=l)==null?void 0:t.signal},s.fetchOptions)).then(u=>u.text().then(d=>{var h={statusCode:u.status,text:d};if(u.status===200)try{h.json=JSON.parse(d)}catch(p){E.error(p)}s.callback==null||s.callback(h)})).catch(u=>{E.error(u),s.callback==null||s.callback({statusCode:0,text:u})}).finally(()=>l?clearTimeout(l.timeout):null)}}),vi&&nr.push({transport:"XHR",method:s=>{var e,t=new vi;t.open(s.method||"GET",s.url,!0);var{contentType:r,body:i}=(e=ui(s))!==null&&e!==void 0?e:{};q(s.headers,function(n,a){t.setRequestHeader(a,n)}),r&&t.setRequestHeader("Content-Type",r),s.timeout&&(t.timeout=s.timeout),s.disableXHRCredentials||(t.withCredentials=!0),t.onreadystatechange=()=>{if(t.readyState===4){var n={statusCode:t.status,text:t.responseText};if(t.status===200)try{n.json=JSON.parse(t.responseText)}catch{}s.callback==null||s.callback(n)}},t.send(i)}}),me!=null&&me.sendBeacon&&nr.push({transport:"sendBeacon",method:s=>{var e=Rr(s.url,{beacon:"1"});try{var t,{contentType:r,body:i}=(t=ui(s))!==null&&t!==void 0?t:{},n=typeof i=="string"?new Blob([i],{type:r}):i;me.sendBeacon(e,n)}catch{}}});var os=function(s,e){if(!function(t){try{new RegExp(t)}catch{return!1}return!0}(e))return!1;try{return new RegExp(e).test(s)}catch{return!1}};function ho(s,e,t){return Is({distinct_id:s,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var ll={exact:(s,e)=>e.some(t=>s.some(r=>t===r)),is_not:(s,e)=>e.every(t=>s.every(r=>t!==r)),regex:(s,e)=>e.some(t=>s.some(r=>os(t,r))),not_regex:(s,e)=>e.every(t=>s.every(r=>!os(t,r))),icontains:(s,e)=>e.map(sr).some(t=>s.map(sr).some(r=>t.includes(r))),not_icontains:(s,e)=>e.map(sr).every(t=>s.map(sr).every(r=>!t.includes(r)))},sr=s=>s.toLowerCase(),po=X("[Error tracking]"),gn=class{constructor(e){var t,r;this.pe=[],this.ge=new wi([new Ei,new Ai,new ki,new xi,new Ri,new Ti,new Si,new Ci],[Hc,Vc]),this._instance=e,this.pe=(t=(r=this._instance.persistence)==null?void 0:r.get_property(Pi))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,r,i,n=(t=(r=e.errorTracking)==null?void 0:r.suppressionRules)!==null&&t!==void 0?t:[],a=(i=e.errorTracking)==null?void 0:i.captureExtensionExceptions;this.pe=n,this._instance.persistence&&this._instance.persistence.register({[Pi]:this.pe,[Ma]:a})}get _e(){var e,t=!!this._instance.get_property(Ma),r=this._instance.config.error_tracking.captureExtensionExceptions;return(e=r??t)!==null&&e!==void 0&&e}buildProperties(e,t){return this.ge.buildFromUnknown(e,{syntheticException:t?.syntheticException,mechanism:{handled:t?.handled}})}sendExceptionEvent(e){if(this.me(e))po.info("Skipping exception capture because a suppression rule matched");else{if(this._e||!this.ye(e))return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"});po.info("Skipping exception capture because it was thrown by an extension")}}me(e){var t=e.$exception_list;if(!t||!z(t)||t.length===0)return!1;var r=t.reduce((i,n)=>{var{type:a,value:o}=n;return Z(a)&&a.length>0&&i.$exception_types.push(a),Z(o)&&o.length>0&&i.$exception_values.push(o),i},{$exception_types:[],$exception_values:[]});return this.pe.some(i=>{var n=i.values.map(a=>{var o,l=ll[a.operator],c=z(a.value)?a.value:[a.value],u=(o=r[a.key])!==null&&o!==void 0?o:[];return c.length>0&&l(c,u)});return i.type==="OR"?n.some(Boolean):n.every(Boolean)})}ye(e){var t=e.$exception_list;return!(!t||!z(t))&&t.flatMap(r=>{var i,n;return(i=(n=r.stacktrace)==null?void 0:n.frames)!==null&&i!==void 0?i:[]}).some(r=>r.filename&&r.filename.startsWith("chrome-extension://"))}},xe="Mobile",Cr="iOS",Fe="Android",$s="Tablet",cl=Fe+" "+$s,ul="iPad",dl="Apple",hl=dl+" Watch",Ns="Safari",ls="BlackBerry",pl="Samsung",fl=pl+"Browser",gl=pl+" Internet",Ct="Chrome",Vu=Ct+" OS",vl=Ct+" "+Cr,Zn="Internet Explorer",ml=Zn+" "+xe,Yn="Opera",Gu=Yn+" Mini",Jn="Edge",_l="Microsoft "+Jn,ts="Firefox",yl=ts+" "+Cr,Fs="Nintendo",js="PlayStation",ss="Xbox",bl=Fe+" "+xe,wl=xe+" "+Ns,Ps="Windows",vn=Ps+" Phone",fo="Nokia",mn="Ouya",El="Generic",Zu=El+" "+xe.toLowerCase(),xl=El+" "+$s.toLowerCase(),_n="Konqueror",oe="(\\d+(\\.\\d+)?)",di=new RegExp("Version/"+oe),Yu=new RegExp(ss,"i"),Ju=new RegExp(js+" \\w+","i"),Xu=new RegExp(Fs+" \\w+","i"),Xn=new RegExp(ls+"|PlayBook|BB10","i"),Qu={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Ku=(s,e)=>e&&N(e,dl)||function(t){return N(t,Ns)&&!N(t,Ct)&&!N(t,Fe)}(s),kl=function(s,e){return e=e||"",N(s," OPR/")&&N(s,"Mini")?Gu:N(s," OPR/")?Yn:Xn.test(s)?ls:N(s,"IE"+xe)||N(s,"WPDesktop")?ml:N(s,fl)?gl:N(s,Jn)||N(s,"Edg/")?_l:N(s,"FBIOS")?"Facebook "+xe:N(s,"UCWEB")||N(s,"UCBrowser")?"UC Browser":N(s,"CriOS")?vl:N(s,"CrMo")||N(s,Ct)?Ct:N(s,Fe)&&N(s,Ns)?bl:N(s,"FxiOS")?yl:N(s.toLowerCase(),_n.toLowerCase())?_n:Ku(s,e)?N(s,xe)?wl:Ns:N(s,ts)?ts:N(s,"MSIE")||N(s,"Trident/")?Zn:N(s,"Gecko")?ts:""},ed={[ml]:[new RegExp("rv:"+oe)],[_l]:[new RegExp(Jn+"?\\/"+oe)],[Ct]:[new RegExp("("+Ct+"|CrMo)\\/"+oe)],[vl]:[new RegExp("CriOS\\/"+oe)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+oe)],[Ns]:[di],[wl]:[di],[Yn]:[new RegExp("(Opera|OPR)\\/"+oe)],[ts]:[new RegExp(ts+"\\/"+oe)],[yl]:[new RegExp("FxiOS\\/"+oe)],[_n]:[new RegExp("Konqueror[:/]?"+oe,"i")],[ls]:[new RegExp(ls+" "+oe),di],[bl]:[new RegExp("android\\s"+oe,"i")],[gl]:[new RegExp(fl+"\\/"+oe)],[Zn]:[new RegExp("(rv:|MSIE )"+oe)],Mozilla:[new RegExp("rv:"+oe)]},td=function(s,e){var t=kl(s,e),r=ed[t];if(y(r))return null;for(var i=0;i<r.length;i++){var n=r[i],a=s.match(n);if(a)return parseFloat(a[a.length-2])}return null},go=[[new RegExp(ss+"; "+ss+" (.*?)[);]","i"),s=>[ss,s&&s[1]||""]],[new RegExp(Fs,"i"),[Fs,""]],[new RegExp(js,"i"),[js,""]],[Xn,[ls,""]],[new RegExp(Ps,"i"),(s,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[vn,""];if(new RegExp(xe).test(e)&&!/IEMobile\b/.test(e))return[Ps+" "+xe,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var r=t[1],i=Qu[r]||"";return/arm/i.test(e)&&(i="RT"),[Ps,i]}return[Ps,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,s=>{if(s&&s[3]){var e=[s[3],s[4],s[5]||"0"];return[Cr,e.join(".")]}return[Cr,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,s=>{var e="";return s&&s.length>=3&&(e=y(s[2])?s[3]:s[2]),["watchOS",e]}],[new RegExp("("+Fe+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Fe+")","i"),s=>{if(s&&s[2]){var e=[s[2],s[3],s[4]||"0"];return[Fe,e.join(".")]}return[Fe,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,s=>{var e=["Mac OS X",""];if(s&&s[1]){var t=[s[1],s[2],s[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[Vu,""]],[/Linux|debian/i,["Linux",""]]],vo=function(s){return Xu.test(s)?Fs:Ju.test(s)?js:Yu.test(s)?ss:new RegExp(mn,"i").test(s)?mn:new RegExp("("+vn+"|WPDesktop)","i").test(s)?vn:/iPad/.test(s)?ul:/iPod/.test(s)?"iPod Touch":/iPhone/.test(s)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(s)?hl:Xn.test(s)?ls:/(kobo)\s(ereader|touch)/i.test(s)?"Kobo":new RegExp(fo,"i").test(s)?fo:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(s)||/(kf[a-z]+)( bui|\)).+silk\//i.test(s)?"Kindle Fire":/(Android|ZTE)/i.test(s)?!new RegExp(xe).test(s)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(s)?/pixel[\daxl ]{1,6}/i.test(s)&&!/pixel c/i.test(s)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(s)||/lmy47v/i.test(s)&&!/QTAQZ3/i.test(s)?Fe:cl:Fe:new RegExp("(pda|"+xe+")","i").test(s)?Zu:new RegExp($s,"i").test(s)&&!new RegExp($s+" pc","i").test(s)?xl:""},rr="https?://(.*)",Fr=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],sd=Lr(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],Fr),Qn="<masked>",rd=["li_fat_id"];function Sl(s,e,t){if(!k)return{};var r,i=e?Lr([],Fr,t||[]):[],n=Tl(qn(k.URL,i,Qn),s),a=(r={},q(rd,function(o){var l=je.J(o);r[o]=l||null}),r);return Y(a,n)}function Tl(s,e){var t=sd.concat(e||[]),r={};return q(t,function(i){var n=vr(s,i);r[i]=n||null}),r}function Rl(s){var e=function(n){return n?n.search(rr+"google.([^/?]*)")===0?"google":n.search(rr+"bing.com")===0?"bing":n.search(rr+"yahoo.com")===0?"yahoo":n.search(rr+"duckduckgo.com")===0?"duckduckgo":null:null}(s),t=e!="yahoo"?"q":"p",r={};if(!Qe(e)){r.$search_engine=e;var i=k?vr(k.referrer,t):"";i.length&&(r.ph_keyword=i)}return r}function mo(){return navigator.language||navigator.userLanguage}function Cl(){return k?.referrer||"$direct"}function Al(s,e){var t=s?Lr([],Fr,e||[]):[],r=ue?.href.substring(0,1e3);return{r:Cl().substring(0,1e3),u:r?qn(r,t,Qn):void 0}}function Il(s){var e,{r:t,u:r}=s,i={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=ns(t))==null?void 0:e.host};if(r){i.$current_url=r;var n=ns(r);i.$host=n?.host,i.$pathname=n?.pathname;var a=Tl(r);Y(i,a)}if(t){var o=Rl(t);Y(i,o)}return i}function Pl(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function id(){try{return new Date().getTimezoneOffset()}catch{return}}function nd(s,e){if(!ce)return{};var t,r,i,n=s?Lr([],Fr,e||[]):[],[a,o]=function(l){for(var c=0;c<go.length;c++){var[u,d]=go[c],h=u.exec(l),p=h&&(we(d)?d(h,l):d);if(p)return p}return["",""]}(ce);return Y(Fn({$os:a,$os_version:o,$browser:kl(ce,navigator.vendor),$device:vo(ce),$device_type:(r=ce,i=vo(r),i===ul||i===cl||i==="Kobo"||i==="Kindle Fire"||i===xl?$s:i===Fs||i===ss||i===js||i===mn?"Console":i===hl?"Wearable":i?xe:"Desktop"),$timezone:Pl(),$timezone_offset:id()}),{$current_url:qn(ue?.href,n,Qn),$host:ue?.host,$pathname:ue?.pathname,$raw_user_agent:ce.length>1e3?ce.substring(0,997)+"...":ce,$browser_version:td(ce,navigator.vendor),$browser_language:mo(),$browser_language_prefix:(t=mo(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:f?.screen.height,$screen_width:f?.screen.width,$viewport_height:f?.innerHeight,$viewport_width:f?.innerWidth,$lib:"web",$lib_version:Je.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var Ne=X("[FeatureFlags]"),hi="$active_feature_flags",Jt="$override_feature_flags",_o="$feature_flag_payloads",xs="$override_feature_flag_payloads",yo="$feature_flag_request_id",bo=s=>{var e={};for(var[t,r]of ir(s||{}))r&&(e[t]=r);return e},ad=s=>{var e=s.flags;return e?(s.featureFlags=Object.fromEntries(Object.keys(e).map(t=>{var r;return[t,(r=e[t].variant)!==null&&r!==void 0?r:e[t].enabled]})),s.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter(t=>e[t].enabled).filter(t=>{var r;return(r=e[t].metadata)==null?void 0:r.payload}).map(t=>{var r;return[t,(r=e[t].metadata)==null?void 0:r.payload]}))):Ne.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),s},od=function(s){return s.FeatureFlags="feature_flags",s.Recordings="recordings",s}({}),yn=class{constructor(e){this.be=!1,this.we=!1,this.Se=!1,this.ke=!1,this.$e=!1,this.xe=!1,this.Ee=!1,this._instance=e,this.featureFlagEventHandlers=[]}flags(){if(this._instance.config.__preview_remote_config)this.xe=!0;else{var e=!this.Pe&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.Ie({disableFlags:e})}}get hasLoadedFlags(){return this.we}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(Li),t=this._instance.get_property(Jt),r=this._instance.get_property(xs);if(!r&&!t)return e||{};var i=Y({},e||{}),n=[...new Set([...Object.keys(r||{}),...Object.keys(t||{})])];for(var a of n){var o,l,c=i[a],u=t?.[a],d=y(u)?(o=c?.enabled)!==null&&o!==void 0&&o:!!u,h=y(u)?c.variant:typeof u=="string"?u:void 0,p=r?.[a],g=b({},c,{enabled:d,variant:d?h??c?.variant:void 0});d!==c?.enabled&&(g.original_enabled=c?.enabled),h!==c?.variant&&(g.original_variant=c?.variant),p&&(g.metadata=b({},c?.metadata,{payload:p,original_payload:c==null||(l=c.metadata)==null?void 0:l.payload})),i[a]=g}return this.be||(Ne.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:r,finalDetails:i}),this.be=!0),i}getFlagVariants(){var e=this._instance.get_property(es),t=this._instance.get_property(Jt);if(!t)return e||{};for(var r=Y({},e),i=Object.keys(t),n=0;n<i.length;n++)r[i[n]]=t[i[n]];return this.be||(Ne.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:r}),this.be=!0),r}getFlagPayloads(){var e=this._instance.get_property(_o),t=this._instance.get_property(xs);if(!t)return e||{};for(var r=Y({},e||{}),i=Object.keys(t),n=0;n<i.length;n++)r[i[n]]=t[i[n]];return this.be||(Ne.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:r}),this.be=!0),r}reloadFeatureFlags(){this.ke||this._instance.config.advanced_disable_feature_flags||this.Pe||(this.Pe=setTimeout(()=>{this.Ie()},5))}Re(){clearTimeout(this.Pe),this.Pe=void 0}ensureFlagsLoaded(){this.we||this.Se||this.Pe||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.ke=e}Ie(e){var t;if(this.Re(),!this._instance.L())if(this.Se)this.$e=!0;else{var r={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:b({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(Cs)||{}),group_properties:this._instance.get_property(St)};(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(r.disable_flags=!0);var i=this._instance.config.__preview_remote_config,n=i?"/flags/?v=2":"/flags/?v=2&config=true",a=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",o=this._instance.requestRouter.endpointFor("api",n+a);i&&(r.timezone=Pl()),this.Se=!0,this._instance.Te({method:"POST",url:o,data:r,compression:this._instance.config.disable_compression?void 0:Xe.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:l=>{var c,u,d=!0;if(l.statusCode===200&&(this.$e||(this.$anon_distinct_id=void 0),d=!1),this.Se=!1,this.xe||(this.xe=!0,this._instance.Ce((u=l.json)!==null&&u!==void 0?u:{})),!r.disable_flags||this.$e)if(this.Ee=!d,l.json&&(c=l.json.quotaLimited)!=null&&c.includes(od.FeatureFlags))Ne.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var h;r.disable_flags||this.receivedFeatureFlags((h=l.json)!==null&&h!==void 0?h:{},d),this.$e&&(this.$e=!1,this.Ie())}}})}}getFeatureFlag(e,t){if(t===void 0&&(t={}),this.we||this.getFlags()&&this.getFlags().length>0){var r=this.getFlagVariants()[e],i=""+r,n=this._instance.get_property(yo)||void 0,a=this._instance.get_property(dr)||{};if((t.send_event||!("send_event"in t))&&(!(e in a)||!a[e].includes(i))){var o,l,c,u,d,h,p,g,v;z(a[e])?a[e].push(i):a[e]=[i],(o=this._instance.persistence)==null||o.register({[dr]:a});var _=this.getFeatureFlagDetails(e),S={$feature_flag:e,$feature_flag_response:r,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_request_id:n,$feature_flag_bootstrapped_response:((l=this._instance.config.bootstrap)==null||(l=l.featureFlags)==null?void 0:l[e])||null,$feature_flag_bootstrapped_payload:((c=this._instance.config.bootstrap)==null||(c=c.featureFlagPayloads)==null?void 0:c[e])||null,$used_bootstrap_value:!this.Ee};y(_==null||(u=_.metadata)==null?void 0:u.version)||(S.$feature_flag_version=_.metadata.version);var O,A=(d=_==null||(h=_.reason)==null?void 0:h.description)!==null&&d!==void 0?d:_==null||(p=_.reason)==null?void 0:p.code;A&&(S.$feature_flag_reason=A),_!=null&&(g=_.metadata)!=null&&g.id&&(S.$feature_flag_id=_.metadata.id),y(_?.original_variant)&&y(_?.original_enabled)||(S.$feature_flag_original_response=y(_.original_variant)?_.original_enabled:_.original_variant),_!=null&&(v=_.metadata)!=null&&v.original_payload&&(S.$feature_flag_original_payload=_==null||(O=_.metadata)==null?void 0:O.original_payload),this._instance.capture("$feature_flag_called",S)}return r}Ne.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}getRemoteConfigPayload(e,t){var r=this._instance.config.token;this._instance.Te({method:"POST",url:this._instance.requestRouter.endpointFor("api","/flags/?v=2&config=true"),data:{distinct_id:this._instance.get_distinct_id(),token:r},compression:this._instance.config.disable_compression?void 0:Xe.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:i=>{var n,a=(n=i.json)==null?void 0:n.featureFlagPayloads;t(a?.[e]||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.we||this.getFlags()&&this.getFlags().length>0){var r=this.getFeatureFlag(e,t);return y(r)?void 0:!!r}Ne.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(t=>t!==e)}receivedFeatureFlags(e,t){if(this._instance.persistence){this.we=!0;var r=this.getFlagVariants(),i=this.getFlagPayloads(),n=this.getFlagsWithDetails();(function(a,o,l,c,u){l===void 0&&(l={}),c===void 0&&(c={}),u===void 0&&(u={});var d=ad(a),h=d.flags,p=d.featureFlags,g=d.featureFlagPayloads;if(p){var v=a.requestId;if(z(p)){Ne.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var _={};if(p)for(var S=0;S<p.length;S++)_[p[S]]=!0;o&&o.register({[hi]:p,[es]:_})}else{var O=p,A=g,I=h;a.errorsWhileComputingFlags&&(O=b({},l,O),A=b({},c,A),I=b({},u,I)),o&&o.register(b({[hi]:Object.keys(bo(O)),[es]:O||{},[_o]:A||{},[Li]:I||{}},v?{[yo]:v}:{}))}}})(e,this._instance.persistence,r,i,n),this.Me(t)}}override(e,t){t===void 0&&(t=!1),Ne.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return Ne.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(Jt),this._instance.persistence.unregister(xs),void this.Me();if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,r=e;if(this.be=!!((t=r.suppressWarning)!==null&&t!==void 0&&t),"flags"in r){if(r.flags===!1)this._instance.persistence.unregister(Jt);else if(r.flags)if(z(r.flags)){for(var i={},n=0;n<r.flags.length;n++)i[r.flags[n]]=!0;this._instance.persistence.register({[Jt]:i})}else this._instance.persistence.register({[Jt]:r.flags})}return"payloads"in r&&(r.payloads===!1?this._instance.persistence.unregister(xs):r.payloads&&this._instance.persistence.register({[xs]:r.payloads})),void this.Me()}this.Me()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.we){var{flags:t,flagVariants:r}=this.Oe();e(t,r)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,r){var i,n=(this._instance.get_property(Rs)||[]).find(c=>c.flagKey===e),a={["$feature_enrollment/"+e]:t},o={$feature_flag:e,$feature_enrollment:t,$set:a};n&&(o.$early_access_feature_name=n.name),r&&(o.$feature_enrollment_stage=r),this._instance.capture("$feature_enrollment_update",o),this.setPersonPropertiesForFlags(a,!1);var l=b({},this.getFlagVariants(),{[e]:t});(i=this._instance.persistence)==null||i.register({[hi]:Object.keys(bo(l)),[es]:l}),this.Me()}getEarlyAccessFeatures(e,t,r){t===void 0&&(t=!1);var i=this._instance.get_property(Rs),n=r?"&"+r.map(a=>"stage="+a).join("&"):"";if(i&&!t)return e(i);this._instance.Te({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+n),method:"GET",callback:a=>{var o,l;if(a.json){var c=a.json.earlyAccessFeatures;return(o=this._instance.persistence)==null||o.unregister(Rs),(l=this._instance.persistence)==null||l.register({[Rs]:c}),e(c)}}})}Oe(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter(r=>t[r]),flagVariants:Object.keys(t).filter(r=>t[r]).reduce((r,i)=>(r[i]=t[i],r),{})}}Me(e){var{flags:t,flagVariants:r}=this.Oe();this.featureFlagEventHandlers.forEach(i=>i(t,r,{errorsLoading:e}))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var r=this._instance.get_property(Cs)||{};this._instance.register({[Cs]:b({},r,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(Cs)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var r=this._instance.get_property(St)||{};Object.keys(r).length!==0&&Object.keys(r).forEach(i=>{r[i]=b({},r[i],e[i]),delete e[i]}),this._instance.register({[St]:b({},r,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(St)||{};this._instance.register({[St]:b({},t,{[e]:{}})})}else this._instance.unregister(St)}reset(){this.we=!1,this.Se=!1,this.ke=!1,this.$e=!1,this.xe=!1,this.Ee=!1,this.$anon_distinct_id=void 0,this.Re(),this.be=!1}},ld=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"],Ms=class{constructor(e,t){this.A=e,this.props={},this.Fe=!1,this.Ae=(r=>{var i="";return r.token&&(i=r.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),r.persistence_name?"ph_"+r.persistence_name:"ph_"+i+"_posthog"})(e),this.it=this.De(e),this.load(),e.debug&&E.info("Persistence loaded",e.persistence,b({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.je}De(e){ld.indexOf(e.persistence.toLowerCase())===-1&&(E.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=e.persistence.toLowerCase();return t==="localstorage"&&J.G()?J:t==="localstorage+cookie"&&Xs.G()?Xs:t==="sessionstorage"&&ee.G()?ee:t==="memory"?_u:t==="cookie"?je:Xs.G()?Xs:je}properties(){var e={};return q(this.props,function(t,r){if(r===es&&G(t))for(var i=Object.keys(t),n=0;n<i.length;n++)e["$feature/"+i[n]]=t[i[n]];else o=r,l=!1,(Qe(a=tu)?l:xa&&a.indexOf===xa?a.indexOf(o)!=-1:(q(a,function(c){if(l||(l=c===o))return cr}),l))||(e[r]=t);var a,o,l}),e}load(){if(!this.je){var e=this.it.K(this.Ae);e&&(this.props=Y({},e))}}save(){this.je||this.it.Y(this.Ae,this.props,this.Le,this.Ne,this.Ue,this.A.debug)}remove(){this.it.X(this.Ae,!1),this.it.X(this.Ae,!0)}clear(){this.remove(),this.props={}}register_once(e,t,r){if(G(e)){y(t)&&(t="None"),this.Le=y(r)?this.ze:r;var i=!1;if(q(e,(n,a)=>{this.props.hasOwnProperty(a)&&this.props[a]!==t||(this.props[a]=n,i=!0)}),i)return this.save(),!0}return!1}register(e,t){if(G(e)){this.Le=y(t)?this.ze:t;var r=!1;if(q(e,(i,n)=>{e.hasOwnProperty(n)&&this.props[n]!==i&&(this.props[n]=i,r=!0)}),r)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.Fe){var e=Sl(this.A.custom_campaign_params,this.A.mask_personal_data_properties,this.A.custom_personal_data_properties);Qt(Fn(e))||this.register(e),this.Fe=!0}}update_search_keyword(){var e;this.register((e=k?.referrer)?Rl(e):{})}update_referrer_info(){var e;this.register_once({$referrer:Cl(),$referring_domain:k!=null&&k.referrer&&((e=ns(k.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[ji]||this.props[Ui]||this.register_once({[hr]:Al(this.A.mask_personal_data_properties,this.A.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};q([Ui,ji],a=>{var o=this.props[a];o&&q(o,function(l,c){e["$initial_"+mi(c)]=l})});var t,r,i=this.props[hr];if(i){var n=(t=Il(i),r={},q(t,function(a,o){r["$initial_"+mi(o)]=a}),r);Y(e,n)}return e}safe_merge(e){return q(this.props,function(t,r){r in e||(e[r]=t)}),e}update_config(e,t,r){if(this.ze=this.Le=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!r),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence){var i=this.De(e),n=this.props;this.clear(),this.it=i,this.props=n,this.save()}}set_disabled(e){this.je=e,this.je?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ne&&(this.Ne=e,this.remove(),this.save())}set_secure(e){e!==this.Ue&&(this.Ue=e,this.remove(),this.save())}set_event_timer(e,t){var r=this.props[Ts]||{};r[e]=t,this.props[Ts]=r,this.save()}remove_event_timer(e){var t=(this.props[Ts]||{})[e];return y(t)||(delete this.props[Ts][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}},pp=function(s){return s.Button="button",s.Tab="tab",s.Selector="selector",s}({}),fp=function(s){return s.TopLeft="top_left",s.TopRight="top_right",s.TopCenter="top_center",s.MiddleLeft="middle_left",s.MiddleRight="middle_right",s.MiddleCenter="middle_center",s.Left="left",s.Center="center",s.Right="right",s.NextToTrigger="next_to_trigger",s}({}),pi=function(s){return s.Popover="popover",s.API="api",s.Widget="widget",s.ExternalSurvey="external_survey",s}({}),gp=function(s){return s.Open="open",s.MultipleChoice="multiple_choice",s.SingleChoice="single_choice",s.Rating="rating",s.Link="link",s}({}),vp=function(s){return s.NextQuestion="next_question",s.End="end",s.ResponseBased="response_based",s.SpecificQuestion="specific_question",s}({}),mp=function(s){return s.Once="once",s.Recurring="recurring",s.Always="always",s}({}),ar=function(s){return s.SHOWN="survey shown",s.DISMISSED="survey dismissed",s.SENT="survey sent",s}({}),wo=function(s){return s.SURVEY_ID="$survey_id",s.SURVEY_NAME="$survey_name",s.SURVEY_RESPONSE="$survey_response",s.SURVEY_ITERATION="$survey_iteration",s.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",s.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",s.SURVEY_SUBMISSION_ID="$survey_submission_id",s.SURVEY_QUESTIONS="$survey_questions",s.SURVEY_COMPLETED="$survey_completed",s}({}),Ol=function(s){return s.Popover="popover",s.Inline="inline",s}({}),Ar=class{constructor(){this.qe={},this.qe={}}on(e,t){return this.qe[e]||(this.qe[e]=[]),this.qe[e].push(t),()=>{this.qe[e]=this.qe[e].filter(r=>r!==t)}}emit(e,t){for(var r of this.qe[e]||[])r(t);for(var i of this.qe["*"]||[])i(e,t)}},bn=class s{constructor(e){this.Be=new Ar,this.He=(t,r)=>this.We(t,r)&&this.Ge(t,r)&&this.Ve(t,r),this.We=(t,r)=>r==null||!r.event||t?.event===r?.event,this._instance=e,this.Je=new Set,this.Ke=new Set}init(){var e;if(!y((e=this._instance)==null?void 0:e.Ye)){var t;(t=this._instance)==null||t.Ye((r,i)=>{this.on(r,i)})}}register(e){var t,r;if(!y((t=this._instance)==null?void 0:t.Ye)&&(e.forEach(a=>{var o,l;(o=this.Ke)==null||o.add(a),(l=a.steps)==null||l.forEach(c=>{var u;(u=this.Je)==null||u.add(c?.event||"")})}),(r=this._instance)!=null&&r.autocapture)){var i,n=new Set;e.forEach(a=>{var o;(o=a.steps)==null||o.forEach(l=>{l!=null&&l.selector&&n.add(l?.selector)})}),(i=this._instance)==null||i.autocapture.setElementSelectors(n)}}on(e,t){var r;t!=null&&e.length!=0&&(this.Je.has(e)||this.Je.has(t?.event))&&this.Ke&&((r=this.Ke)==null?void 0:r.size)>0&&this.Ke.forEach(i=>{this.Xe(t,i)&&this.Be.emit("actionCaptured",i.name)})}Qe(e){this.onAction("actionCaptured",t=>e(t))}Xe(e,t){if(t?.steps==null)return!1;for(var r of t.steps)if(this.He(e,r))return!0;return!1}onAction(e,t){return this.Be.on(e,t)}Ge(e,t){if(t!=null&&t.url){var r,i=e==null||(r=e.properties)==null?void 0:r.$current_url;if(!i||typeof i!="string"||!s.Ze(i,t?.url,t?.url_matching||"contains"))return!1}return!0}static Ze(e,t,r){switch(r){case"regex":return!!f&&os(e,t);case"exact":return t===e;case"contains":var i=s.tr(t).replace(/_/g,".").replace(/%/g,".*");return os(e,i);default:return!1}}static tr(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}Ve(e,t){if((t!=null&&t.href||t!=null&&t.tag_name||t!=null&&t.text)&&!this.ir(e).some(n=>!(t!=null&&t.href&&!s.Ze(n.href||"",t?.href,t?.href_matching||"exact"))&&(t==null||!t.tag_name||n.tag_name===t?.tag_name)&&!(t!=null&&t.text&&!s.Ze(n.text||"",t?.text,t?.text_matching||"exact")&&!s.Ze(n.$el_text||"",t?.text,t?.text_matching||"exact"))))return!1;if(t!=null&&t.selector){var r,i=e==null||(r=e.properties)==null?void 0:r.$element_selectors;if(!i||!i.includes(t?.selector))return!1}return!0}ir(e){return e?.properties.$elements==null?[]:e?.properties.$elements}},B=X("[Surveys]"),wn="seenSurvey_",cd=(s,e)=>{var t="$survey_"+e+"/"+s.id;return s.current_iteration&&s.current_iteration>0&&(t="$survey_"+e+"/"+s.id+"/"+s.current_iteration),t},Eo=s=>{var e=""+wn+s.id;return s.current_iteration&&s.current_iteration>0&&(e=""+wn+s.id+"_"+s.current_iteration),e},ud=[pi.Popover,pi.Widget,pi.API],dd={ignoreConditions:!1,ignoreDelay:!1,displayType:Ol.Popover},En=class{constructor(e){this._instance=e,this.er=new Map,this.rr=new Map}register(e){var t;y((t=this._instance)==null?void 0:t.Ye)||(this.sr(e),this.nr(e))}nr(e){var t=e.filter(r=>{var i,n;return((i=r.conditions)==null?void 0:i.actions)&&((n=r.conditions)==null||(n=n.actions)==null||(n=n.values)==null?void 0:n.length)>0});t.length!==0&&(this.ar==null&&(this.ar=new bn(this._instance),this.ar.init(),this.ar.Qe(r=>{this.onAction(r)})),t.forEach(r=>{var i,n,a,o,l;r.conditions&&(i=r.conditions)!=null&&i.actions&&(n=r.conditions)!=null&&(n=n.actions)!=null&&n.values&&((a=r.conditions)==null||(a=a.actions)==null||(a=a.values)==null?void 0:a.length)>0&&((o=this.ar)==null||o.register(r.conditions.actions.values),(l=r.conditions)==null||(l=l.actions)==null||(l=l.values)==null||l.forEach(c=>{if(c&&c.name){var u=this.rr.get(c.name);u&&u.push(r.id),this.rr.set(c.name,u||[r.id])}}))}))}sr(e){var t;e.filter(r=>{var i,n;return((i=r.conditions)==null?void 0:i.events)&&((n=r.conditions)==null||(n=n.events)==null||(n=n.values)==null?void 0:n.length)>0}).length!==0&&((t=this._instance)==null||t.Ye((r,i)=>{this.onEvent(r,i)}),e.forEach(r=>{var i;(i=r.conditions)==null||(i=i.events)==null||(i=i.values)==null||i.forEach(n=>{if(n&&n.name){var a=this.er.get(n.name);a&&a.push(r.id),this.er.set(n.name,a||[r.id])}})}))}onEvent(e,t){var r,i,n=((r=this._instance)==null||(r=r.persistence)==null?void 0:r.props[Js])||[];if(ar.SHOWN===e&&t&&n.length>0){var a;B.info("survey event matched, removing survey from activated surveys",{event:e,eventPayload:t,existingActivatedSurveys:n});var o=t==null||(a=t.properties)==null?void 0:a.$survey_id;if(o){var l=n.indexOf(o);l>=0&&(n.splice(l,1),this.lr(n))}}else if(this.er.has(e)){B.info("survey event name matched",{event:e,eventPayload:t,surveys:this.er.get(e)});var c=[];(i=this._instance)==null||i.getSurveys(d=>{c=d.filter(h=>{var p;return(p=this.er.get(e))==null?void 0:p.includes(h.id)})});var u=c.filter(d=>{var h,p=(h=d.conditions)==null||(h=h.events)==null||(h=h.values)==null?void 0:h.find(g=>g.name===e);return!!p&&(!p.propertyFilters||Object.entries(p.propertyFilters).every(g=>{var v,[_,S]=g,O=t==null||(v=t.properties)==null?void 0:v[_];if(y(O)||Qe(O))return!1;var A=[String(O)],I=ll[S.operator];return I?I(S.values,A):(B.warn("Unknown property comparison operator: "+S.operator),!1)}))});this.lr(n.concat(u.map(d=>d.id)||[]))}}onAction(e){var t,r=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[Js])||[];this.rr.has(e)&&this.lr(r.concat(this.rr.get(e)||[]))}lr(e){var t;B.info("updating activated surveys",{activatedSurveys:e}),(t=this._instance)==null||(t=t.persistence)==null||t.register({[Js]:[...new Set(e)]})}getSurveys(){var e,t=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[Js];return t||[]}getEventToSurveys(){return this.er}ur(){return this.ar}},xn=class{constructor(e){this.hr=void 0,this._surveyManager=null,this.dr=!1,this.vr=!1,this.cr=[],this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){if(!this._instance.config.disable_surveys){var t=e.surveys;if(U(t))return B.warn("Flags not loaded yet. Not loading surveys.");var r=z(t);this.hr=r?t.length>0:t,B.info("flags response received, isSurveysEnabled: "+this.hr),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var r=localStorage.key(t);(r!=null&&r.startsWith(wn)||r!=null&&r.startsWith("inProgressSurvey_"))&&e.push(r)}e.forEach(i=>localStorage.removeItem(i))}loadIfEnabled(){if(!this._surveyManager)if(this.vr)B.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)B.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())B.info("Not loading surveys in cookieless mode without consent.");else{var e=R?.__PosthogExtensions__;if(e){if(!y(this.hr)||this._instance.config.advanced_enable_surveys){var t=this.hr||this._instance.config.advanced_enable_surveys;this.vr=!0;try{var r=e.generateSurveys;if(r)return void this.pr(r,t);var i=e.loadExternalDependency;if(!i)return void this.gr("PostHog loadExternalDependency extension not found.");i(this._instance,"surveys",n=>{n||!e.generateSurveys?this.gr("Could not load surveys script",n):this.pr(e.generateSurveys,t)})}catch(n){throw this.gr("Error initializing surveys",n),n}finally{this.vr=!1}}}else B.error("PostHog Extensions not found.")}}pr(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new En(this._instance),B.info("Surveys loaded successfully"),this._r({isLoaded:!0})}gr(e,t){B.error(e,t),this._r({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.cr.push(e),this._surveyManager&&this._r({isLoaded:!0}),()=>{this.cr=this.cr.filter(t=>t!==e)}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return B.info("Disabled. Not loading surveys."),e([]);var r=this._instance.get_property($i);if(r&&!t)return e(r,{isLoaded:!0});if(this.dr)return e([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this.dr=!0,this._instance.Te({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:i=>{var n;this.dr=!1;var a=i.statusCode;if(a!==200||!i.json){var o="Surveys API could not be loaded, status: "+a;return B.error(o),e([],{isLoaded:!1,error:o})}var l,c=i.json.surveys||[],u=c.filter(d=>function(h){return!(!h.start_date||h.end_date)}(d)&&(function(h){var p;return!((p=h.conditions)==null||(p=p.events)==null||(p=p.values)==null||!p.length)}(d)||function(h){var p;return!((p=h.conditions)==null||(p=p.actions)==null||(p=p.values)==null||!p.length)}(d)));return u.length>0&&((l=this._surveyEventReceiver)==null||l.register(u)),(n=this._instance.persistence)==null||n.register({[$i]:c}),e(c,{isLoaded:!0})}})}catch(i){throw this.dr=!1,i}}_r(e){for(var t of this.cr)try{if(!e.isLoaded)return t([],e);this.getSurveys(t)}catch(r){B.error("Error in survey callback",r)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!U(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);B.warn("init was not called")}mr(e){var t=null;return this.getSurveys(r=>{var i;t=(i=r.find(n=>n.id===e))!==null&&i!==void 0?i:null}),t}yr(e){if(U(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.mr(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(U(this._surveyManager))return B.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.yr(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return U(this._surveyManager)?(B.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise(r=>{this.getSurveys(i=>{var n,a=(n=i.find(l=>l.id===e))!==null&&n!==void 0?n:null;if(a){var o=this.yr(a);r({visible:o.eligible,disabledReason:o.reason})}else r({visible:!1,disabledReason:"Survey not found"})},t)})}renderSurvey(e,t){var r;if(U(this._surveyManager))B.warn("init was not called");else{var i=typeof e=="string"?this.mr(e):e;if(i!=null&&i.id)if(ud.includes(i.type)){var n=k?.querySelector(t);if(n)return(r=i.appearance)!=null&&r.surveyPopupDelaySeconds?(B.info("Rendering survey "+i.id+" with delay of "+i.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout(()=>{var a,o;B.info("Rendering survey "+i.id+" with delay of "+((a=i.appearance)==null?void 0:a.surveyPopupDelaySeconds)+" seconds"),(o=this._surveyManager)==null||o.renderSurvey(i,n),B.info("Survey "+i.id+" rendered")},1e3*i.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(i,n);B.warn("Survey element not found")}else B.warn("Surveys of type "+i.type+" cannot be rendered in the app");else B.warn("Survey not found")}}displaySurvey(e,t){var r;if(U(this._surveyManager))B.warn("init was not called");else{var i=this.mr(e);if(i){var n=i;if((r=i.appearance)!=null&&r.surveyPopupDelaySeconds&&t.ignoreDelay&&(n=b({},i,{appearance:b({},i.appearance,{surveyPopupDelaySeconds:0})})),t.ignoreConditions===!1){var a=this.canRenderSurvey(i);if(!a.visible)return void B.warn("Survey is not eligible to be displayed: ",a.disabledReason)}t.displayType!==Ol.Inline?this._surveyManager.handlePopoverSurvey(n):this.renderSurvey(n,t.selector)}else B.warn("Survey not found")}}},xo=X("[RateLimiter]"),kn=class{constructor(e){var t,r;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=i=>{var n=i.text;if(n&&n.length)try{(JSON.parse(n).quota_limited||[]).forEach(a=>{xo.info((a||"events")+" is quota limited."),this.serverLimits[a]=new Date().getTime()+6e4})}catch(a){return void xo.warn('could not rate limit - continuing. Error: "'+a?.message+'"',{text:n})}},this.instance=e,this.captureEventsPerSecond=((t=e.config.rate_limiting)==null?void 0:t.events_per_second)||10,this.captureEventsBurstLimit=Math.max(((r=e.config.rate_limiting)==null?void 0:r.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(e){var t,r,i;e===void 0&&(e=!1);var n=new Date().getTime(),a=(t=(r=this.instance.persistence)==null?void 0:r.get_property(Fi))!==null&&t!==void 0?t:{tokens:this.captureEventsBurstLimit,last:n};a.tokens+=(n-a.last)/1e3*this.captureEventsPerSecond,a.last=n,a.tokens>this.captureEventsBurstLimit&&(a.tokens=this.captureEventsBurstLimit);var o=a.tokens<1;return o||e||(a.tokens=Math.max(0,a.tokens-1)),!o||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=o,(i=this.instance.persistence)==null||i.set_property(Fi,a),{isRateLimited:o,remainingTokens:a.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}},kt=X("[RemoteConfig]"),Sn=class{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=R._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}br(e){var t,r;(t=R.__PosthogExtensions__)!=null&&t.loadExternalDependency?(r=R.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,"remote-config",()=>e(this.remoteConfig)):(kt.error("PostHog Extensions not found. Cannot load remote config."),e())}wr(e){this._instance.Te({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return kt.info("Using preloaded remote config",this.remoteConfig),void this.Ce(this.remoteConfig);if(this._instance.L())return void kt.warn("Remote config is disabled. Falling back to local config.");this.br(e=>{if(!e)return kt.info("No config found after loading remote JS config. Falling back to JSON."),void this.wr(t=>{this.Ce(t)});this.Ce(e)})}catch(e){kt.error("Error loading remote config",e)}}Ce(e){e?this._instance.config.__preview_remote_config?(this._instance.Ce(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):kt.info("__preview_remote_config is disabled. Logging config instead",e):kt.error("Failed to fetch remote config from PostHog.")}},Tn=3e3,Rn=class{constructor(e,t){this.Sr=!0,this.kr=[],this.$r=_e(t?.flush_interval_ms||Tn,250,5e3,E.createLogger("flush interval"),Tn),this.Er=e}enqueue(e){this.kr.push(e),this.Pr||this.Ir()}unload(){this.Rr();var e=this.kr.length>0?this.Tr():{},t=Object.values(e);[...t.filter(r=>r.url.indexOf("/e")===0),...t.filter(r=>r.url.indexOf("/e")!==0)].map(r=>{this.Er(b({},r,{transport:"sendBeacon"}))})}enable(){this.Sr=!1,this.Ir()}Ir(){var e=this;this.Sr||(this.Pr=setTimeout(()=>{if(this.Rr(),this.kr.length>0){var t=this.Tr(),r=function(){var n=t[i],a=new Date().getTime();n.data&&z(n.data)&&q(n.data,o=>{o.offset=Math.abs(o.timestamp-a),delete o.timestamp}),e.Er(n)};for(var i in t)r()}},this.$r))}Rr(){clearTimeout(this.Pr),this.Pr=void 0}Tr(){var e={};return q(this.kr,t=>{var r,i=t,n=(i?i.batchKey:null)||i.url;y(e[n])&&(e[n]=b({},i,{data:[]})),(r=e[n].data)==null||r.push(i.data)}),this.kr=[],e}},hd=["retriesPerformedSoFar"],Cn=class{constructor(e){this.Cr=!1,this.Mr=3e3,this.kr=[],this._instance=e,this.kr=[],this.Or=!0,!y(f)&&"onLine"in f.navigator&&(this.Or=f.navigator.onLine,V(f,"online",()=>{this.Or=!0,this.ne()}),V(f,"offline",()=>{this.Or=!1}))}get length(){return this.kr.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,r=Io(e,hd);re(t)&&t>0&&(r.url=Rr(r.url,{retry_count:t})),this._instance.Te(b({},r,{callback:i=>{i.statusCode!==200&&(i.statusCode<400||i.statusCode>=500)&&(t??0)<10?this.Fr(b({retriesPerformedSoFar:t},r)):r.callback==null||r.callback(i)}}))}Fr(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var r=function(a){var o=3e3*Math.pow(2,a),l=o/2,c=Math.min(18e5,o),u=(Math.random()-.5)*(c-l);return Math.ceil(c+u)}(t),i=Date.now()+r;this.kr.push({retryAt:i,requestOptions:e});var n="Enqueued failed request for retry in "+r;navigator.onLine||(n+=" (Browser is offline)"),E.warn(n),this.Cr||(this.Cr=!0,this.Ar())}Ar(){this.Dr&&clearTimeout(this.Dr),this.Dr=setTimeout(()=>{this.Or&&this.kr.length>0&&this.ne(),this.Ar()},this.Mr)}ne(){var e=Date.now(),t=[],r=this.kr.filter(n=>n.retryAt<e||(t.push(n),!1));if(this.kr=t,r.length>0)for(var{requestOptions:i}of r)this.retriableRequest(i)}unload(){for(var{requestOptions:e}of(this.Dr&&(clearTimeout(this.Dr),this.Dr=void 0),this.kr))try{this._instance.Te(b({},e,{transport:"sendBeacon"}))}catch(t){E.error(t)}this.kr=[]}},An=class{constructor(e){this.jr=()=>{var t,r,i,n;this.Lr||(this.Lr={});var a=this.scrollElement(),o=this.scrollY(),l=a?Math.max(0,a.scrollHeight-a.clientHeight):0,c=o+(a?.clientHeight||0),u=a?.scrollHeight||0;this.Lr.lastScrollY=Math.ceil(o),this.Lr.maxScrollY=Math.max(o,(t=this.Lr.maxScrollY)!==null&&t!==void 0?t:0),this.Lr.maxScrollHeight=Math.max(l,(r=this.Lr.maxScrollHeight)!==null&&r!==void 0?r:0),this.Lr.lastContentY=c,this.Lr.maxContentY=Math.max(c,(i=this.Lr.maxContentY)!==null&&i!==void 0?i:0),this.Lr.maxContentHeight=Math.max(u,(n=this.Lr.maxContentHeight)!==null&&n!==void 0?n:0)},this._instance=e}getContext(){return this.Lr}resetContext(){var e=this.Lr;return setTimeout(this.jr,0),e}startMeasuringScrollPosition(){V(f,"scroll",this.jr,{capture:!0}),V(f,"scrollend",this.jr,{capture:!0}),V(f,"resize",this.jr)}scrollElement(){if(!this._instance.config.scroll_root_selector)return f?.document.documentElement;var e=z(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var r=f?.document.querySelector(t);if(r)return r}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return f&&(f.scrollY||f.pageYOffset||f.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return f&&(f.scrollX||f.pageXOffset||f.document.documentElement.scrollLeft)||0}},pd=s=>Al(s?.config.mask_personal_data_properties,s?.config.custom_personal_data_properties),Ir=class{constructor(e,t,r,i){this.Nr=n=>{var a=this.Ur();if(!a||a.sessionId!==n){var o={sessionId:n,props:this.zr(this._instance)};this.qr.register({[Ni]:o})}},this._instance=e,this.Br=t,this.qr=r,this.zr=i||pd,this.Br.onSessionId(this.Nr)}Ur(){return this.qr.props[Ni]}getSetOnceProps(){var e,t=(e=this.Ur())==null?void 0:e.props;return t?"r"in t?Il(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return q(Fn(this.getSetOnceProps()),(t,r)=>{r==="$current_url"&&(r="url"),e["$session_entry_"+mi(r)]=t}),e}},fi=X("[SessionId]"),Pr=class{constructor(e,t,r){var i;if(this.Hr=[],this.Wr=(u,d)=>Math.abs(u-d)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.cookieless_mode==="always")throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.A=e.config,this.qr=e.persistence,this.pi=void 0,this.Ft=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.Gr=t||ht,this.Vr=r||ht;var n=this.A.persistence_name||this.A.token,a=this.A.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*_e(a,60,36e3,fi.createLogger("session_idle_timeout_seconds"),1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.Jr(),this.Kr="ph_"+n+"_window_id",this.Yr="ph_"+n+"_primary_window_exists",this.Xr()){var o=ee.K(this.Kr),l=ee.K(this.Yr);o&&!l?this.pi=o:ee.X(this.Kr),ee.Y(this.Yr,!0)}if((i=this.A.bootstrap)!=null&&i.sessionID)try{var c=(u=>{var d=u.replace(/-/g,"");if(d.length!==32)throw new Error("Not a valid UUID");if(d[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(d.substring(0,12),16)})(this.A.bootstrap.sessionID);this.Qr(this.A.bootstrap.sessionID,new Date().getTime(),c)}catch(u){fi.error("Invalid sessionID in bootstrap",u)}this.Zr()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return y(this.Hr)&&(this.Hr=[]),this.Hr.push(e),this.Ft&&e(this.Ft,this.pi),()=>{this.Hr=this.Hr.filter(t=>t!==e)}}Xr(){return this.A.persistence!=="memory"&&!this.qr.je&&ee.G()}ts(e){e!==this.pi&&(this.pi=e,this.Xr()&&ee.Y(this.Kr,e))}es(){return this.pi?this.pi:this.Xr()?ee.K(this.Kr):null}Qr(e,t,r){e===this.Ft&&t===this._sessionActivityTimestamp&&r===this._sessionStartTimestamp||(this._sessionStartTimestamp=r,this._sessionActivityTimestamp=t,this.Ft=e,this.qr.register({[ur]:[t,e,r]}))}rs(){if(this.Ft&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this.Ft,this._sessionStartTimestamp];var e=this.qr.props[ur];return z(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.Qr(null,null,null)}Zr(){V(f,"beforeunload",()=>{this.Xr()&&ee.X(this.Yr)},{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.A.cookieless_mode==="always")throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var r=t||new Date().getTime(),[i,n,a]=this.rs(),o=this.es(),l=re(a)&&a>0&&Math.abs(r-a)>864e5,c=!1,u=!n,d=!e&&this.Wr(r,i);u||d||l?(n=this.Gr(),o=this.Vr(),fi.info("new session ID generated",{sessionId:n,windowId:o,changeReason:{noSessionId:u,activityTimeout:d,sessionPastMaximumLength:l}}),a=r,c=!0):o||(o=this.Vr(),c=!0);var h=i===0||!e||l?r:i,p=a===0?new Date().getTime():a;return this.ts(o),this.Qr(n,h,p),e||this.Jr(),c&&this.Hr.forEach(g=>g(n,o,c?{noSessionId:u,activityTimeout:d,sessionPastMaximumLength:l}:void 0)),{sessionId:n,windowId:o,sessionStartTimestamp:p,changeReason:c?{noSessionId:u,activityTimeout:d,sessionPastMaximumLength:l}:void 0,lastActivityTimestamp:i}}Jr(){clearTimeout(this.ss),this.ss=setTimeout(()=>{var[e]=this.rs();this.Wr(new Date().getTime(),e)&&this.resetSessionId()},1.1*this.sessionTimeoutMs)}},fd=["$set_once","$set"],ut=X("[SiteApps]"),In=class{constructor(e){this._instance=e,this.ns=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}os(e,t){if(t){var r=this.globalsForEvent(t);this.ns.push(r),this.ns.length>1e3&&(this.ns=this.ns.slice(10))}}get siteAppLoaders(){var e;return(e=R._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance.Ye(this.os.bind(this));this.ls=()=>{e(),this.ns=[],this.ls=void 0}}}globalsForEvent(e){var t,r,i,n,a,o,l;if(!e)throw new Error("Event payload is required");var c={},u=this._instance.get_property("$groups")||[],d=this._instance.get_property("$stored_group_properties")||{};for(var[h,p]of Object.entries(d))c[h]={id:u[h],type:h,properties:p};var{$set_once:g,$set:v}=e;return{event:b({},Io(e,fd),{properties:b({},e.properties,v?{$set:b({},(t=(r=e.properties)==null?void 0:r.$set)!==null&&t!==void 0?t:{},v)}:{},g?{$set_once:b({},(i=(n=e.properties)==null?void 0:n.$set_once)!==null&&i!==void 0?i:{},g)}:{}),elements_chain:(a=(o=e.properties)==null?void 0:o.$elements_chain)!==null&&a!==void 0?a:"",distinct_id:(l=e.properties)==null?void 0:l.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:c}}setupSiteApp(e){var t=this.apps[e.id],r=()=>{var o;!t.errored&&this.ns.length&&(ut.info("Processing "+this.ns.length+" events for site app with id "+e.id),this.ns.forEach(l=>t.processEvent==null?void 0:t.processEvent(l)),t.processedBuffer=!0),Object.values(this.apps).every(l=>l.processedBuffer||l.errored)&&((o=this.ls)==null||o.call(this))},i=!1,n=o=>{t.errored=!o,t.loaded=!0,ut.info("Site app with id "+e.id+" "+(o?"loaded":"errored")),i&&r()};try{var{processEvent:a}=e.init({posthog:this._instance,callback:o=>{n(o)}});a&&(t.processEvent=a),i=!0}catch(o){ut.error("Error while initializing PostHog app with config id "+e.id,o),n(!1)}if(i&&t.loaded)try{r()}catch(o){ut.error("Error while processing buffered events PostHog app with config id "+e.id,o),t.errored=!0}}us(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var r of e)this.setupSiteApp(r)}hs(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var r of Object.values(this.apps))try{r.processEvent==null||r.processEvent(t)}catch(i){ut.error("Error while processing event "+e.event+" for site app "+r.id,i)}}}onRemoteConfig(e){var t,r,i,n=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.us(),void this._instance.on("eventCaptured",c=>this.hs(c))):void ut.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((r=this.ls)==null||r.call(this),(i=e.siteApps)!=null&&i.length)if(this.isEnabled){var a=function(c){var u;R["__$$ph_site_app_"+c]=n._instance,(u=R.__PosthogExtensions__)==null||u.loadSiteApp==null||u.loadSiteApp(n._instance,l,d=>{if(d)return ut.error("Error while initializing PostHog app with config id "+c,d)})};for(var{id:o,url:l}of e.siteApps)a(o)}else ut.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}},gd=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],ko=function(s,e){if(!s)return!1;var t=s.toLowerCase();return gd.concat(e||[]).some(r=>{var i=r.toLowerCase();return t.indexOf(i)!==-1})},Dl=function(s,e){if(!s)return!1;var t=s.userAgent;if(t&&ko(t,e))return!0;try{var r=s?.userAgentData;if(r!=null&&r.brands&&r.brands.some(i=>ko(i?.brand,e)))return!0}catch{}return!!s.webdriver},Os=function(s){return s.US="us",s.EU="eu",s.CUSTOM="custom",s}({}),So="i.posthog.com",Pn=class{constructor(e){this.ds={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+So,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.ds[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.ds[this.apiHost]=Os.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.ds[this.apiHost]=Os.EU:this.ds[this.apiHost]=Os.CUSTOM),this.ds[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(this.region===Os.CUSTOM)return this.apiHost+t;var r=So+t;switch(e){case"assets":return"https://"+this.region+"-assets."+r;case"api":return"https://"+this.region+"."+r}}},vd={icontains:(s,e)=>!!f&&e.href.toLowerCase().indexOf(s.toLowerCase())>-1,not_icontains:(s,e)=>!!f&&e.href.toLowerCase().indexOf(s.toLowerCase())===-1,regex:(s,e)=>!!f&&os(e.href,s),not_regex:(s,e)=>!!f&&!os(e.href,s),exact:(s,e)=>e.href===s,is_not:(s,e)=>e.href!==s},On=class s{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(r){r===void 0&&(r=!1),t.getWebExperiments(i=>{s.vs("retrieved web experiments from the server"),t.cs=new Map,i.forEach(n=>{if(n.feature_flag_key){var a;t.cs&&(s.vs("setting flag key ",n.feature_flag_key," to web experiment ",n),(a=t.cs)==null||a.set(n.feature_flag_key,n));var o=t._instance.getFeatureFlag(n.feature_flag_key);Z(o)&&n.variants[o]&&t.fs(n.name,o,n.variants[o].transforms)}else if(n.variants)for(var l in n.variants){var c=n.variants[l];s.ps(c)&&t.fs(n.name,l,c.transforms)}})},r)},this._instance=e,this._instance.onFeatureFlags(r=>{this.onFeatureFlags(r)})}onFeatureFlags(e){if(this._is_bot())s.vs("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(U(this.cs))return this.cs=new Map,this.loadIfEnabled(),void this.previewWebExperiment();s.vs("applying feature flags",e),e.forEach(t=>{var r;if(this.cs&&(r=this.cs)!=null&&r.has(t)){var i,n=this._instance.getFeatureFlag(t),a=(i=this.cs)==null?void 0:i.get(t);n&&a!=null&&a.variants[n]&&this.fs(a.name,n,a.variants[n].transforms)}})}}previewWebExperiment(){var e=s.getWindowLocation();if(e!=null&&e.search){var t=vr(e?.search,"__experiment_id"),r=vr(e?.search,"__experiment_variant");t&&r&&(s.vs("previewing web experiments "+t+" && "+r),this.getWebExperiments(i=>{this.gs(parseInt(t),r,i)},!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,r){if(this._instance.config.disable_web_experiments&&!r)return e([]);var i=this._instance.get_property("$web_experiments");if(i&&!t)return e(i);this._instance.Te({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:n=>{if(n.statusCode!==200||!n.json)return e([]);var a=n.json.experiments||[];return e(a)}})}gs(e,t,r){var i=r.filter(n=>n.id===e);i&&i.length>0&&(s.vs("Previewing web experiment ["+i[0].name+"] with variant ["+t+"]"),this.fs(i[0].name,t,i[0].variants[t].transforms))}static ps(e){return!U(e.conditions)&&s._s(e)&&s.ys(e)}static _s(e){var t;if(U(e.conditions)||U((t=e.conditions)==null?void 0:t.url))return!0;var r,i,n,a=s.getWindowLocation();return!!a&&((r=e.conditions)==null||!r.url||vd[(i=(n=e.conditions)==null?void 0:n.urlMatchType)!==null&&i!==void 0?i:"icontains"](e.conditions.url,a))}static getWindowLocation(){return f?.location}static ys(e){var t;if(U(e.conditions)||U((t=e.conditions)==null?void 0:t.utm))return!0;var r=Sl();if(r.utm_source){var i,n,a,o,l,c,u,d,h=(i=e.conditions)==null||(i=i.utm)==null||!i.utm_campaign||((n=e.conditions)==null||(n=n.utm)==null?void 0:n.utm_campaign)==r.utm_campaign,p=(a=e.conditions)==null||(a=a.utm)==null||!a.utm_source||((o=e.conditions)==null||(o=o.utm)==null?void 0:o.utm_source)==r.utm_source,g=(l=e.conditions)==null||(l=l.utm)==null||!l.utm_medium||((c=e.conditions)==null||(c=c.utm)==null?void 0:c.utm_medium)==r.utm_medium,v=(u=e.conditions)==null||(u=u.utm)==null||!u.utm_term||((d=e.conditions)==null||(d=d.utm)==null?void 0:d.utm_term)==r.utm_term;return h&&g&&v&&p}return!1}static vs(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];E.info("[WebExperiments] "+e,r)}fs(e,t,r){this._is_bot()?s.vs("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?r.forEach(i=>{if(i.selector){var n;s.vs("applying transform of variant "+t+" for experiment "+e+" ",i);var a=(n=document)==null?void 0:n.querySelectorAll(i.selector);a?.forEach(o=>{var l=o;i.html&&(l.innerHTML=i.html),i.css&&l.setAttribute("style",i.css)})}}):s.vs("Control variants leave the page unmodified.")}_is_bot(){return me&&this._instance?Dl(me,this._instance.config.custom_blocked_useragents):void 0}},md=X("[PostHog ExternalIntegrations]"),_d={intercom:"intercom-integration",crispChat:"crisp-chat-integration"},Dn=class{constructor(e){this._instance=e}nt(e,t){var r;(r=R.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,e,i=>{if(i)return md.error("failed to load script",i);t()})}startIfEnabledOrStop(){var e=this,t=function(a){var o,l,c;!i||(o=R.__PosthogExtensions__)!=null&&(o=o.integrations)!=null&&o[a]||e.nt(_d[a],()=>{var u;(u=R.__PosthogExtensions__)==null||(u=u.integrations)==null||(u=u[a])==null||u.start(e._instance)}),!i&&(l=R.__PosthogExtensions__)!=null&&(l=l.integrations)!=null&&l[a]&&((c=R.__PosthogExtensions__)==null||(c=c.integrations)==null||(c=c[a])==null||c.stop())};for(var[r,i]of Object.entries((n=this._instance.config.integrations)!==null&&n!==void 0?n:{})){var n;t(r)}}},Mn="[SessionRecording]",ks=X(Mn),Ln=class{get started(){var e;return!((e=this.bs)==null||!e.isStarted)}get status(){var e;return((e=this.bs)==null?void 0:e.status)||"lazy_loading"}constructor(e){if(this._forceAllowLocalhostNetworkCapture=!1,this.ni=void 0,this._instance=e,!this._instance.sessionManager)throw ks.error("started without valid sessionManager"),new Error(Mn+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(Mn+' cannot be used with cookieless_mode="always"')}get qt(){var e,t=!((e=this._instance.get_property(ii))==null||!e.enabled),r=!this._instance.config.disable_session_recording,i=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return f&&t&&r&&!i}startIfEnabledOrStop(e){var t;if(!this.qt||(t=this.bs)==null||!t.isStarted){var r=!y(Object.assign)&&!y(Array.from);this.qt&&r?(this.ws(e),ks.info("starting")):this.stopRecording()}}ws(e){var t,r,i;this.qt&&(R!=null&&(t=R.__PosthogExtensions__)!=null&&(t=t.rrweb)!=null&&t.record&&(r=R.__PosthogExtensions__)!=null&&r.initSessionRecording?this.Pi(e):(i=R.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,this.Ii,n=>{if(n)return ks.error("could not load recorder",n);this.Pi(e)}))}stopRecording(){var e;(e=this.bs)==null||e.stop()}ki(){var e;(e=this._instance.persistence)==null||e.unregister(Kt)}Ei(e){if(this._instance.persistence){var t,r,i=this._instance.persistence,n=()=>{var a=e.sessionRecording,o=a?.sampleRate,l=U(o)?null:parseFloat(o);U(l)&&this.ki();var c=a?.minimumDurationMilliseconds;i.register({[ii]:b({enabled:!!a},a,{networkPayloadCapture:b({capturePerformance:e.capturePerformance},a?.networkPayloadCapture),canvasRecording:{enabled:a?.recordCanvas,fps:a?.canvasFps,quality:a?.canvasQuality},sampleRate:l,minimumDurationMilliseconds:y(c)?null:c,endpoint:a?.endpoint,triggerMatchType:a?.triggerMatchType,masking:a?.masking,urlTriggers:a?.urlTriggers})})};n(),(t=this.ni)==null||t.call(this),this.ni=(r=this._instance.sessionManager)==null?void 0:r.onSessionId(n)}}onRemoteConfig(e){"sessionRecording"in e?(this.Ei(e),this.startIfEnabledOrStop()):ks.info("skipping remote config with no sessionRecording",e)}log(e,t){var r;t===void 0&&(t="log"),(r=this.bs)!=null&&r.log?this.bs.log(e,t):ks.warn("log called before recorder was ready")}get Ii(){var e,t,r=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.get_property(ii);return(r==null||(t=r.scriptConfig)==null?void 0:t.script)||"lazy-recorder"}Pi(e){var t,r;if((t=R.__PosthogExtensions__)==null||!t.initSessionRecording)throw Error("Called on script loaded before session recording is available");this.bs||(this.bs=(r=R.__PosthogExtensions__)==null?void 0:r.initSessionRecording(this._instance),this.bs._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this.bs.start(e)}onRRwebEmit(e){var t;(t=this.bs)==null||t.onRRwebEmit==null||t.onRRwebEmit(e)}overrideLinkedFlag(){var e;(e=this.bs)==null||e.overrideLinkedFlag()}overrideSampling(){var e;(e=this.bs)==null||e.overrideSampling()}overrideTrigger(e){var t;(t=this.bs)==null||t.overrideTrigger(e)}get sdkDebugProperties(){var e;return((e=this.bs)==null?void 0:e.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(e,t){var r;return!((r=this.bs)==null||!r.tryAddCustomEvent(e,t))}},Ls={},$n=()=>{},Xt="posthog",Ml=!Wu&&ce?.indexOf("MSIE")===-1&&ce?.indexOf("Mozilla")===-1,To=s=>{var e;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:eu(k?.location),persistence:"localStorage+cookie",persistence_name:"",loaded:$n,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:s!=="2025-05-24"||"history_change",capture_pageleave:"if_capture_pageview",defaults:s??"unset",debug:ue&&Z(ue?.search)&&ue.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(f==null||(e=f.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var r="Bad HTTP status: "+t.statusCode+" "+t.text;E.error(r)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:Tn},error_tracking:{},_onCapture:$n,__preview_eager_load_replay:!0}},Ro=s=>{var e={};y(s.process_person)||(e.person_profiles=s.process_person),y(s.xhr_headers)||(e.request_headers=s.xhr_headers),y(s.cookie_name)||(e.persistence_name=s.cookie_name),y(s.disable_cookie)||(e.disable_persistence=s.disable_cookie),y(s.store_google)||(e.save_campaign_params=s.store_google),y(s.verbose)||(e.debug=s.verbose);var t=Y({},e,s);return z(s.property_blacklist)&&(y(s.property_denylist)?t.property_denylist=s.property_blacklist:z(s.property_denylist)?t.property_denylist=[...s.property_blacklist,...s.property_denylist]:E.error("Invalid value for property_denylist config: "+s.property_denylist)),t},Nn=class{constructor(){this.__forceAllowLocalhost=!1}get Ss(){return this.__forceAllowLocalhost}set Ss(e){E.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}},Or=class s{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new Nn,this.ks=!1,this.version=Je.LIB_VERSION,this.$s=new Ar,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=To(),this.SentryIntegration=cn,this.sentryIntegration=e=>function(t,r){var i=ol(t,r);return{name:al,processEvent:n=>i(n)}}(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.xs=!1,this.Es=null,this.Ps=null,this.Is=null,this.featureFlags=new yn(this),this.toolbar=new un(this),this.scrollManager=new An(this),this.pageViewManager=new fn(this),this.surveys=new xn(this),this.experiments=new On(this),this.exceptions=new gn(this),this.rateLimiter=new kn(this),this.requestRouter=new Pn(this),this.consent=new Vi(this),this.externalIntegrations=new Dn(this),this.people={set:(e,t,r)=>{var i=Z(e)?{[e]:t}:e;this.setPersonProperties(i),r?.({})},set_once:(e,t,r)=>{var i=Z(e)?{[e]:t}:e;this.setPersonProperties(void 0,i),r?.({})}},this.on("eventCaptured",e=>E.info('send "'+e?.event+'"',e))}init(e,t,r){if(r&&r!==Xt){var i,n=(i=Ls[r])!==null&&i!==void 0?i:new s;return n._init(e,t,r),Ls[r]=n,Ls[Xt][r]=n,n}return this._init(e,t,r)}_init(e,t,r){var i,n;if(t===void 0&&(t={}),y(e)||_i(e))return E.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return E.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this.Rs=t,this.Ts=[],t.person_profiles&&(this.Ps=t.person_profiles),this.set_config(Y({},To(t.defaults),Ro(t),{name:r,token:e})),this.config.on_xhr_error&&E.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:Xe.GZipJS;var a=this.Cs();this.persistence=new Ms(this.config,a),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Ms(b({},this.config,{persistence:"sessionStorage"}),a);var o=b({},this.persistence.props),l=b({},this.sessionPersistence.props);this.register({$initialization_time:new Date().toISOString()}),this.Ms=new Rn(A=>this.Os(A),this.config.request_queue_config),this.Fs=new Cn(this),this.__request_queue=[];var c=this.config.cookieless_mode==="always"||this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut();if(c||(this.sessionManager=new Pr(this),this.sessionPropsManager=new Ir(this,this.sessionManager,this.persistence)),new dn(this).startIfEnabledOrStop(),this.siteApps=new In(this),(i=this.siteApps)==null||i.init(),c||(this.config.__preview_eager_load_replay?this.sessionRecording=new Tr(this):this.sessionRecording=new Ln(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new qi(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new pn(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new hn(this),this.exceptionObserver=new Gi(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new _r(this,bu),this.deadClicksAutocapture.startIfEnabled(),this.historyAutocapture=new Zi(this),this.historyAutocapture.startIfEnabled(),Je.DEBUG=Je.DEBUG||this.config.debug,Je.DEBUG&&E.info("Starting in debug mode",{this:this,config:t,thisC:b({},this.config),p:o,s:l}),((n=t.bootstrap)==null?void 0:n.distinctID)!==void 0){var u,d,h=this.config.get_device_id(ht()),p=(u=t.bootstrap)!=null&&u.isIdentifiedID?h:t.bootstrap.distinctID;this.persistence.set_property(Ge,(d=t.bootstrap)!=null&&d.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:p})}if(this.As()){var g,v,_=Object.keys(((g=t.bootstrap)==null?void 0:g.featureFlags)||{}).filter(A=>{var I;return!((I=t.bootstrap)==null||(I=I.featureFlags)==null||!I[A])}).reduce((A,I)=>{var M;return A[I]=((M=t.bootstrap)==null||(M=M.featureFlags)==null?void 0:M[I])||!1,A},{}),S=Object.keys(((v=t.bootstrap)==null?void 0:v.featureFlagPayloads)||{}).filter(A=>_[A]).reduce((A,I)=>{var M,W;return(M=t.bootstrap)!=null&&(M=M.featureFlagPayloads)!=null&&M[I]&&(A[I]=(W=t.bootstrap)==null||(W=W.featureFlagPayloads)==null?void 0:W[I]),A},{});this.featureFlags.receivedFeatureFlags({featureFlags:_,featureFlagPayloads:S})}if(c)this.register_once({distinct_id:_s,$device_id:null},"");else if(!this.get_distinct_id()){var O=this.config.get_device_id(ht());this.register_once({distinct_id:O,$device_id:O},""),this.persistence.set_property(Ge,"anonymous")}return V(f,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?Uu(this,()=>this.Ds()):this.Ds(),we(this.config._onCapture)&&this.config._onCapture!==$n&&(E.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",A=>this.config._onCapture(A.event,A))),this.config.ip&&E.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}Ce(e){var t,r,i,n,a,o,l,c;if(!k||!k.body)return E.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(()=>{this.Ce(e)},500);this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=N(e.supportedCompression,Xe.GZipJS)?Xe.GZipJS:N(e.supportedCompression,Xe.Base64)?Xe.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.Ps?this.Ps:"identified_only"}),(r=this.siteApps)==null||r.onRemoteConfig(e),(i=this.sessionRecording)==null||i.onRemoteConfig(e),(n=this.autocapture)==null||n.onRemoteConfig(e),(a=this.heatmaps)==null||a.onRemoteConfig(e),this.surveys.onRemoteConfig(e),(o=this.webVitalsAutocapture)==null||o.onRemoteConfig(e),(l=this.exceptionObserver)==null||l.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(c=this.deadClicksAutocapture)==null||c.onRemoteConfig(e)}Ds(){try{this.config.loaded(this)}catch(e){E.critical("`loaded` function failed",e)}this.js(),this.config.capture_pageview&&setTimeout(()=>{(this.consent.isOptedIn()||this.config.cookieless_mode==="always")&&this.Ls()},1),new Sn(this).load(),this.featureFlags.flags()}js(){var e;this.is_capturing()&&this.config.request_batching&&((e=this.Ms)==null||e.enable())}_dom_loaded(){this.is_capturing()&&pt(this.__request_queue,e=>this.Os(e)),this.__request_queue=[],this.js()}_handle_unload(){var e,t;this.config.request_batching?(this.Ns()&&this.capture("$pageleave"),(e=this.Ms)==null||e.unload(),(t=this.Fs)==null||t.unload()):this.Ns()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}Te(e){this.__loaded&&(Ml?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=Rr(e.url,{ip:this.config.ip?1:0}),e.headers=b({},this.config.request_headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(e.disableTransport=["sendBeacon"]),e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var r,i,n,a=b({},t);a.timeout=a.timeout||6e4,a.url=Rr(a.url,{_:new Date().getTime().toString(),ver:Je.LIB_VERSION,compression:a.compression});var o=(r=a.transport)!==null&&r!==void 0?r:"fetch",l=nr.filter(u=>!a.disableTransport||!u.transport||!a.disableTransport.includes(u.transport)),c=(i=(n=No(l,u=>u.transport===o))==null?void 0:n.method)!==null&&i!==void 0?i:l[0].method;if(!c)throw new Error("No available transport method");c(a)})(b({},e,{callback:t=>{var r,i;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((r=(i=this.config).on_request_error)==null||r.call(i,t)),e.callback==null||e.callback(t)}}))))}Os(e){this.Fs?this.Fs.retriableRequest(e):this.Te(e)}_execute_array(e){var t,r=[],i=[],n=[];pt(e,o=>{o&&(t=o[0],z(t)?n.push(o):we(o)?o.call(this):z(o)&&t==="alias"?r.push(o):z(o)&&t.indexOf("capture")!==-1&&we(this[t])?n.push(o):i.push(o))});var a=function(o,l){pt(o,function(c){if(z(c[0])){var u=l;q(c,function(d){u=u[d[0]].apply(u,d.slice(1))})}else this[c[0]].apply(this,c.slice(1))},l)};a(r,this),a(i,this),a(n,this)}As(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,r){var i;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Ms){if(this.is_capturing())if(!y(e)&&Z(e)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var n=r!=null&&r.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(n==null||!n.isRateLimited){t!=null&&t.$current_url&&!Z(t?.$current_url)&&(E.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var a=new Date,o=r?.timestamp||a,l=ht(),c={uuid:l,event:e,properties:this.calculateEventProperties(e,t||{},o,l)};n&&(c.properties.$lib_rate_limit_remaining_tokens=n.remainingTokens),r?.$set&&(c.$set=r?.$set);var u,d=this.Us(r?.$set_once);if(d&&(c.$set_once=d),(c=Qc(c,r!=null&&r._noTruncate?null:this.config.properties_string_max_length)).timestamp=o,y(r?.timestamp)||(c.properties.$event_time_override_provided=!0,c.properties.$event_time_override_system_time=a),e===ar.DISMISSED||e===ar.SENT){var h=t?.[wo.SURVEY_ID],p=t?.[wo.SURVEY_ITERATION];u={id:h,current_iteration:p},localStorage.getItem(Eo(u))||localStorage.setItem(Eo(u),"true"),c.$set=b({},c.$set,{[cd({id:h,current_iteration:p},e===ar.SENT?"responded":"dismissed")]:!0})}var g=b({},c.properties.$set,c.$set);if(Qt(g)||this.setPersonPropertiesForFlags(g),!U(this.config.before_send)){var v=this.zs(c);if(!v)return;c=v}this.$s.emit("eventCaptured",c);var _={method:"POST",url:(i=r?._url)!==null&&i!==void 0?i:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:c,compression:"best-available",batchKey:r?._batchKey};return!this.config.request_batching||r&&(r==null||!r._batchKey)||r!=null&&r.send_instantly?this.Os(_):this.Ms.enqueue(_),c}E.critical("This capture call is ignored due to client rate limiting.")}}else E.error("No event name provided to posthog.capture")}else E.uninitializedWarning("posthog.capture")}Ye(e){return this.on("eventCaptured",t=>e(t.event,t))}calculateEventProperties(e,t,r,i,n){if(r=r||new Date,!this.persistence||!this.sessionPersistence)return t;var a=n?void 0:this.persistence.remove_event_timer(e),o=b({},t);if(o.token=this.config.token,o.$config_defaults=this.config.defaults,(this.config.cookieless_mode=="always"||this.config.cookieless_mode=="on_reject"&&this.consent.isExplicitlyOptedOut())&&(o.$cookieless_mode=!0),e==="$snapshot"){var l=b({},this.persistence.properties(),this.sessionPersistence.properties());return o.distinct_id=l.distinct_id,(!Z(o.distinct_id)&&!re(o.distinct_id)||_i(o.distinct_id))&&E.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),o}var c,u=nd(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:d,windowId:h}=this.sessionManager.checkAndGetSessionAndWindowId(n,r.getTime());o.$session_id=d,o.$window_id=h}this.sessionPropsManager&&Y(o,this.sessionPropsManager.getSessionProps());try{var p;this.sessionRecording&&Y(o,this.sessionRecording.sdkDebugProperties),o.$sdk_debug_retry_queue_size=(p=this.Fs)==null?void 0:p.length}catch(S){o.$sdk_debug_error_capturing_properties=String(S)}if(this.requestRouter.region===Os.CUSTOM&&(o.$lib_custom_api_host=this.config.api_host),c=e!=="$pageview"||n?e!=="$pageleave"||n?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(r):this.pageViewManager.doPageView(r,i),o=Y(o,c),e==="$pageview"&&k&&(o.title=k.title),!y(a)){var g=r.getTime()-a;o.$duration=parseFloat((g/1e3).toFixed(3))}ce&&this.config.opt_out_useragent_filter&&(o.$browser_type=this._is_bot()?"bot":"browser"),(o=Y({},u,this.persistence.properties(),this.sessionPersistence.properties(),o)).$is_identified=this._isIdentified(),z(this.config.property_denylist)?q(this.config.property_denylist,function(S){delete o[S]}):E.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var v=this.config.sanitize_properties;v&&(E.error("sanitize_properties is deprecated. Use before_send instead"),o=v(o,e));var _=this.qs();return o.$process_person_profile=_,_&&!n&&this.Bs("_calculate_event_properties"),o}Us(e){var t;if(!this.persistence||!this.qs()||this.ks)return e;var r=this.persistence.get_initial_props(),i=(t=this.sessionPropsManager)==null?void 0:t.getSetOnceProps(),n=Y({},r,i||{},e||{}),a=this.config.sanitize_properties;return a&&(E.error("sanitize_properties is deprecated. Use before_send instead"),n=a(n,"$set_once")),this.ks=!0,Qt(n)?void 0:n}register(e,t){var r;(r=this.persistence)==null||r.register(e,t)}register_once(e,t,r){var i;(i=this.persistence)==null||i.register_once(e,t,r)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}Hs(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch{return t}}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,t,r){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,r)}getEarlyAccessFeatures(e,t,r){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,r)}on(e,t){return this.$s.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,r;return(t=(r=this.sessionManager)==null?void 0:r.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}displaySurvey(e,t){t===void 0&&(t=dd),this.surveys.displaySurvey(e,t)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,r){if(!this.__loaded||!this.persistence)return E.uninitializedWarning("posthog.identify");if(re(e)&&(e=e.toString(),E.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))E.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==_s){if(this.Bs("posthog.identify")){var i=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var n=i;this.register_once({$had_persisted_distinct_id:!0,$device_id:n},"")}e!==i&&e!==this.get_property(Ss)&&(this.unregister(Ss),this.register({distinct_id:e}));var a=(this.persistence.get_property(Ge)||"anonymous")==="anonymous";e!==i&&a?(this.persistence.set_property(Ge,"identified"),this.setPersonPropertiesForFlags(b({},r||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:i},{$set:t||{},$set_once:r||{}}),this.Is=ho(e,t,r),this.featureFlags.setAnonymousDistinctId(i)):(t||r)&&this.setPersonProperties(t,r),e!==i&&(this.reloadFeatureFlags(),this.unregister(dr))}}else E.critical('The string "'+_s+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else E.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.Bs("posthog.setPersonProperties")){var r=ho(this.get_distinct_id(),e,t);this.Is!==r?(this.setPersonPropertiesForFlags(b({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.Is=r):E.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,r){if(e&&t){if(this.Bs("posthog.group")){var i=this.getGroups();i[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:b({},i,{[e]:t})}),r&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:r}),this.setGroupPropertiesForFlags({[e]:r})),i[e]===t||r||this.reloadFeatureFlags()}}else E.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.Bs("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,r,i,n;if(E.info("reset"),!this.__loaded)return E.uninitializedWarning("posthog.reset");var a=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(r=this.sessionPersistence)==null||r.clear(),this.surveys.reset(),this.featureFlags.reset(),(i=this.persistence)==null||i.set_property(Ge,"anonymous"),(n=this.sessionManager)==null||n.resetSessionId(),this.Is=null,this.config.cookieless_mode==="always")this.register_once({distinct_id:_s,$device_id:null},"");else{var o=this.config.get_device_id(ht());this.register_once({distinct_id:o,$device_id:e?o:a},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:r}=this.sessionManager.checkAndGetSessionAndWindowId(!0),i=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&r){var n,a=(n=e.timestampLookBack)!==null&&n!==void 0?n:10;if(!r)return i;i+="?t="+Math.max(Math.floor((new Date().getTime()-r)/1e3)-a,0)}return i}alias(e,t){return e===this.get_property(Fo)?(E.critical("Attempting to create alias for existing People user - aborting."),-2):this.Bs("posthog.alias")?(y(t)&&(t=this.get_distinct_id()),e!==t?(this.Hs(Ss,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(E.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=b({},this.config);if(G(e)){var r,i,n,a,o;Y(this.config,Ro(e));var l=this.Cs();(r=this.persistence)==null||r.update_config(this.config,t,l),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Ms(b({},this.config,{persistence:"sessionStorage"}),l),J.G()&&J.J("ph_debug")==="true"&&(this.config.debug=!0),this.config.debug&&(Je.DEBUG=!0,E.info("set_config",{config:e,oldConfig:t,newConfig:b({},this.config)})),(i=this.sessionRecording)==null||i.startIfEnabledOrStop(),(n=this.autocapture)==null||n.startIfEnabled(),(a=this.heatmaps)==null||a.startIfEnabled(),this.surveys.loadIfEnabled(),this.Ws(),(o=this.externalIntegrations)==null||o.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,r={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(r).some(Boolean)){var i,n,a,o,l;(i=this.sessionManager)==null||i.checkAndGetSessionAndWindowId(),r.sampling&&((n=this.sessionRecording)==null||n.overrideSampling()),r.linked_flag&&((a=this.sessionRecording)==null||a.overrideLinkedFlag()),r.url_trigger&&((o=this.sessionRecording)==null||o.overrideTrigger("url")),r.event_trigger&&((l=this.sessionRecording)==null||l.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var r=new Error("PostHog syntheticException"),i=this.exceptions.buildProperties(e,{handled:!0,syntheticException:r});return this.exceptions.sendExceptionEvent(b({},i,t))}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:Xt;return t!==Xt&&(t=Xt+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property(Ge))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property(Ge))==="identified"}qs(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Qt(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[Ss])&&((t=this.persistence)==null||(t=t.props)==null||!t[pr]))}Ns(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.qs()||this.Bs("posthog.createPersonProfile")&&this.setPersonProperties({},{})}Bs(e){return this.config.person_profiles==="never"?(E.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.Hs(pr,!0),!0)}Cs(){if(this.config.cookieless_mode==="always")return!0;var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default||this.config.cookieless_mode==="on_reject";return this.config.disable_persistence||e&&!!t}Ws(){var e,t,r,i,n=this.Cs();return((e=this.persistence)==null?void 0:e.je)!==n&&((r=this.persistence)==null||r.set_disabled(n)),((t=this.sessionPersistence)==null?void 0:t.je)!==n&&((i=this.sessionPersistence)==null||i.set_disabled(n)),n}opt_in_capturing(e){if(this.config.cookieless_mode!=="always"){var t;this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),this.sessionManager=new Pr(this),this.persistence&&(this.sessionPropsManager=new Ir(this,this.sessionManager,this.persistence)),this.sessionRecording=new Tr(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this.Ws(),this.config.cookieless_mode=="on_reject"&&this.surveys.loadIfEnabled(),(y(e?.captureEventName)||e!=null&&e.captureEventName)&&this.capture((t=e?.captureEventName)!==null&&t!==void 0?t:"$opt_in",e?.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.Ls()}else E.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var e;this.config.cookieless_mode!=="always"?(this.config.cookieless_mode==="on_reject"&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this.Ws(),this.config.cookieless_mode==="on_reject"&&(this.register({distinct_id:_s,$device_id:null}),this.sessionManager=void 0,this.sessionPropsManager=void 0,(e=this.sessionRecording)==null||e.stopRecording(),this.sessionRecording=void 0,this.Ls())):E.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var e=this.consent.consent;return e===Ze.GRANTED?"granted":e===Ze.DENIED?"denied":"pending"}is_capturing(){return this.config.cookieless_mode==="always"||(this.config.cookieless_mode==="on_reject"?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this.Ws()}_is_bot(){return me?Dl(me,this.config.custom_blocked_useragents):void 0}Ls(){k&&(k.visibilityState==="visible"?this.xs||(this.xs=!0,this.capture("$pageview",{title:k.title},{send_instantly:!0}),this.Es&&(k.removeEventListener("visibilitychange",this.Es),this.Es=null)):this.Es||(this.Es=this.Ls.bind(this),V(k,"visibilitychange",this.Es)))}debug(e){e===!1?(f?.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(f?.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}L(){var e,t,r,i,n,a,o,l=this.Rs||{};return"advanced_disable_flags"in l?!!l.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(E.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(r="advanced_disable_decide",i=!1,n=E,a=(t="advanced_disable_flags")in(e=l)&&!y(e[t]),o=r in e&&!y(e[r]),a?e[t]:o?(n&&n.warn("Config field '"+r+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[r]):i)}zs(e){if(U(this.config.before_send))return e;var t=z(this.config.before_send)?this.config.before_send:[this.config.before_send],r=e;for(var i of t){if(r=i(r),U(r)){var n="Event '"+e.event+"' was rejected in beforeSend function";return Lc(e.event)?E.warn(n+". This can cause unexpected behavior."):E.info(n),null}r.properties&&!Qt(r.properties)||E.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return r}getPageViewId(){var e;return(e=this.pageViewManager.fe)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,r){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(r)})}};(function(s,e){for(var t=0;t<e.length;t++)s.prototype[e[t]]=Xc(s.prototype[e[t]])})(Or,["identify"]);var Co,Kn=(Co=Ls[Xt]=new Or,function(){function s(){s.done||(s.done=!0,Ml=!1,q(Ls,function(e){e._dom_loaded()}))}k!=null&&k.addEventListener?k.readyState==="complete"?s():V(k,"DOMContentLoaded",s,{capture:!1}):f&&E.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),Co);var Ll="$project_id";var $l=new WeakSet;function ea(s){if(!(!s||typeof s!="object")&&!$l.has(s)){$l.add(s);for(let e of Reflect.ownKeys(s))ea(s[e]);Object.freeze(s)}}var sa=0;function ta(){let s=window.location.search;return new URLSearchParams(s).get("__websim_show_activity_overlay")==="true"}function Nl(s){let e=__WEBSIM_DATA__.project_id,t=__WEBSIM_DATA__.project_version;if(!e)return console.error("No project id found"),()=>{};if(!t)return console.error("No project version found"),()=>{};let r=new Yt(s),i=1e4,n=performance.now()-1,a=()=>performance.now()-n,o={6e4:2e3,2e5:5e3,Infinity:1e4},l=M=>{for(let[W,Q]of Object.entries(o))if(M<Number(W))return Q;return-1},c=0,u=()=>a()-c,d=null,h=null;ta()&&(h=bd());let p=()=>{let M=u();sa+=M;let W={startRelative:Math.round(c),duration:Math.round(M),totalDuration:Math.round(sa),projectVersion:t};r.logProjectEvent(e,"site_activity",Object.fromEntries(Object.entries(W).filter(([Q,j])=>j!==void 0))),ta()&&(Fl(),wd(M))},g=()=>{d?(clearTimeout(d),d=setTimeout(()=>{p(),d=null},Math.min(l(a()),i-u()))):(c=a(),ta()&&yd(),d=setTimeout(()=>{p(),d=null},l(a())))},v=()=>{g()},_=()=>{g()},S=()=>{g()},O=()=>{g()},A=()=>{g()},I=()=>{document.visibilityState==="hidden"&&d&&(clearTimeout(d),p(),d=null,r.flush())};return window.addEventListener("touchstart",v,{passive:!0}),window.addEventListener("touchmove",_,{passive:!0}),window.addEventListener("mousemove",S,{passive:!0}),window.addEventListener("keydown",O,{passive:!0}),window.addEventListener("scroll",A,{passive:!0}),window.addEventListener("visibilitychange",I),p(),r.flush(),()=>{d&&(clearTimeout(d),d=null),window.removeEventListener("touchstart",v),window.removeEventListener("touchmove",_),window.removeEventListener("mousemove",S),window.removeEventListener("keydown",O),window.removeEventListener("scroll",A),window.removeEventListener("visibilitychange",I),h&&h.parentNode&&h.parentNode.removeChild(h),r.flush()}}function yd(){document.body.style.opacity="1"}function Fl(){document.body.style.opacity="0.5"}function bd(){let s=document.getElementById("activity-log-container");return s||(s=document.createElement("div"),s.id="activity-log-container",s.style.cssText=`
          position: fixed;
          top: 20px;
          right: 20px;
          background: rgba(0, 0, 0, 0.8);
          color: white;
          padding: 12px;
          border-radius: 4px;
          z-index: 9999;
          max-height: 300px;
          min-width: 200px;
          min-height: 100px;
          overflow-y: auto;
          font-family: monospace;
          font-size: 12px;
        `,document.body.appendChild(s)),Fl(),s}function wd(s){let e=document.getElementById("activity-log-container");if(!e){alert("No log container found");return}let t=document.createElement("div"),r=new Date().toLocaleTimeString(),i=(s/1e3).toFixed(2),n=(sa/1e3).toFixed(2);t.textContent=`[${r}] Duration: ${i}s | Total: ${n}s`;let a=e.children.length%2===0;for(t.style.backgroundColor=a?"rgba(50, 50, 50, 0.5)":"transparent",t.style.borderBottom="1px solid rgba(255,255,255,0.1)",t.style.padding="4px 0",e.insertBefore(t,e.firstChild);e.children.length>50;)e.removeChild(e.lastChild)}function jl(){let s=!1,e=t=>{[/^https:\/\/websim\.com$/,/^http:\/\/websim\.localhost:8080$/,/^https:\/\/[a-z0-9-]+\.websim\.pages\.dev$/,/^https:\/\/[a-z0-9-]+\.websim\.workers\.dev$/].some(i=>i.test(t.origin))&&(t.data.type==="EDITOR_SETUP_SW"&&"serviceWorker"in navigator&&navigator.serviceWorker.register("/___editor_service_worker.js?v=current").then(i=>{i.active&&(s=!0),i.addEventListener("activate",()=>{s=!0})}),t.data.type==="EDITOR_SET_FILES"&&(s||console.warn("swReady not set, why?"),navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage(t.data)))};window.addEventListener("message",e)}var Ed=new Map;function xd(s,e){return new ReadableStream({start(t){let r=i=>{i.isTrusted&&i.source===e&&i.data.id===s&&(i.data.result.done?(window.removeEventListener("message",r),t.close(),Ed.delete(s)):t.enqueue(i.data.result.value))};window.addEventListener("message",r)}})}function ia(s,e,t){return new Proxy({},{get(r,i){return async(...n)=>{let a=await t;return new Promise((o,l)=>{let c=`rpc:${Math.random().toString(36).slice(2)}`,u=d=>{if(d.isTrusted&&d.source===a&&d.data.id===c){if(window.removeEventListener("message",u),d.data.error){l(d.data.error);return}o(ra(d.data.result,c,a))}};window.addEventListener("message",u),a.postMessage({id:c,name:s,fn:i,args:n},e)})}}})}function ra(s,e,t){if(s){if(typeof s=="object"&&s.__stream__===!0&&typeof s.id=="string")return xd(s.id,t);if(Array.isArray(s))return s.map(r=>ra(r,e,t));if(typeof s=="object")return Object.fromEntries(Object.entries(s).map(([r,i])=>[r,ra(i,e,t)]))}return s}var ke=s=>{let e;return()=>(e||(e=s()),e)};var D=__WEBSIM_DATA__.isTopLevelFrame&&__WEBSIM_DATA__.project_id?(()=>{let e=new Promise(r=>{let i=document.createElement("iframe");i.sandbox.add("allow-scripts","allow-popups","allow-same-origin","allow-modals"),i.style.display="none";let n=__WEBSIM_DATA__.project_id,a=new URL(`/_embedded_host/${n}`,__WEBSIM_DATA__.hostOrigin);a.searchParams.set("__websim_content_frame_origin",window.origin),a.searchParams.set("__websim_route",JSON.stringify(__WEBSIM_DATA__.route)),i.src=a.toString(),document.body?(document.body.appendChild(i),r(i.contentWindow)):document.addEventListener("DOMContentLoaded",()=>{document.body.appendChild(i),r(i.contentWindow)})}).then(r=>new Promise(i=>{let n=a=>{a.data.type==="host_ready"&&(i(r),window.removeEventListener("message",n))};window.addEventListener("message",n)}));return ia("parent",__WEBSIM_DATA__.hostOrigin,e)})():ia("parent",__WEBSIM_DATA__.hostOrigin,new Promise(s=>{let e=t=>{t.data.type==="host_ready"&&(s(window.parent),window.removeEventListener("message",e))};window.addEventListener("message",e)}));window.__get_params__=ke(D.getParams);function na(s){if(s)return s.replace(/https?:\/\/[^/]+\//g,"/").replace(/\?[^:\s]+/g,"")}function Ul(){window.addEventListener("unhandledrejection",s=>{let e={type:"unhandledRejection",message:s.reason?.message||"Unknown promise rejection",stack:na(s.reason?.stack)};D.reportError(e)}),window.addEventListener("error",s=>{let e={type:"error",message:s.message,stack:na(s.error?.stack)};D.reportError(e)}),window.addEventListener("websim:react-error",s=>{let t=s.detail;t.stack=na(t.stack),t&&D.reportError(t)})}var Bl="FYP",ql="https://websim.com/fyp";var Hl="LOGGED_IN",zl="https://websim.com/";var kd=["https://twitter.com/websim_ai","https://discord.gg/websim","https://www.reddit.com/r/WebSim","https://websim.ai/sponsorship","https://websim.com/sponsorship"];function Sd(s){return kd.includes(s)}function Wl(s){if(s.startsWith("discord.com")||s.startsWith("http://discord.com")||s.startsWith("https://discord.com"))return{type:"url",url:s};if(s==="https://websim.com/auth/login")return{type:"url",url:"/auth/login"};if(Sd(s))return{type:"url",url:s};let e=Td(s);if(e){if(s===zl)return{type:"site",site_id:Hl};if(s===ql)return{type:"site",site_id:Bl};let t;if(t=e.match(/^https:\/\/websim\.(?:ai|com)\/c\/([a-zA-Z0-9]{17})(\?.*)?$/),t){let r=t[1],i=t[2];return{type:"site",site_id:r,search:i}}if(t=e.match(/^https:\/\/websim\.(?:ai|com)\/p\/([a-z0-9_-]{20})(\/\d+)?(\?.*)?$/),t){let r=t[1],i=t[2]&&parseInt(t[2].slice(1))||void 0,n=t[3];return{type:"project",project_id:r,version:i,search:n}}if(t=e.match(/^https:\/\/websim\.(?:ai|com)\/@([^?/#]+)\/([^?/#]+)(\/\d+)?(\?.*)?$/),t){let r=t[1],i=t[2],n=t[3]&&parseInt(t[3].slice(1))||void 0,a=t[4];return{type:"slug",username:r,slug:i,version:n,search:a}}if(t=e.match(/^https:\/\/websim\.(?:ai|com)\/@([^?/#]+)(\?.*)?$/),t){let r=t[1],i=t[2];return{type:"profile",username:r,search:i}}}}function Td(s){if(s.startsWith("/"))return`https://websim.com${s}`;if(s.startsWith("@"))return`https://websim.com/${s}`;let e=s.split("websim.com");if(e.length<2)return;let t=e[0],r=e.slice(1).join("websim.com");if(t===""||t==="http://"||t==="https://")return`https://websim.com${r}`}function Vl(){document.addEventListener("pointerdown",()=>{__WEBSIM_DATA__.isTopLevelFrame||D.iframeInteraction()}),window.__iframeInteraction=()=>{__WEBSIM_DATA__.isTopLevelFrame||D.iframeInteraction()};let s=r=>{let i=r.target;if(!i)return;let n=i?.closest("a");if(n&&(i=n),i instanceof HTMLAnchorElement){let a=i.getAttribute("href")||"";if(/^javascript:/i.test(a)||/^blob:/i.test(a)||/^data:/i.test(a))return;let o=r.button===1||r.metaKey||r.ctrlKey||i.target==="_blank";Wl(a)&&!__WEBSIM_DATA__.isTopLevelFrame&&(r.preventDefault(),D.navigate({method:"GET",url:a,target:o?"_blank":void 0,source:"link"}))}};window.addEventListener("auxclick",r=>{r.which===2&&s(r)}),window.addEventListener("click",r=>{let i=r.target;if(!r.defaultPrevented){if(i instanceof HTMLButtonElement&&i.id==="google-login-button"){r.preventDefault(),D.login();return}s(r)}}),window.addEventListener("keydown",r=>{r.defaultPrevented||r.key==="k"&&(r.metaKey||r.ctrlKey)&&(r.preventDefault(),D.focusUrl())});let e="",t=r=>{r!==e&&(e=r,D.setTitle(r))};window.setInterval(()=>t(document.title),1e3)}function aa(s){return s.type==="slug"?`/@${s.username}/${s.slug}`:s.type==="profile"?`/@${s.username}`:s.type==="site"?`/c/${s.id}`:s.type==="home"?"/":s.type==="project"?`/p/${s.id}`:s.type==="fyp"?"/fyp":s.type==="not-found"?"/not-found":"/"}function Zl({author:s}){let e=new URL(window.location.href).searchParams.get("hide_menu")==="true",t=new URL(window.location.href).searchParams.get("top")==="true",r=new URL(window.location.href).searchParams.get("left")==="true",i=s?.avatar_url,n=!t,a=!r,o=!e;new URL(window.location.href).searchParams.get("__websim_screenshot_mode")!=="true"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>Gl({showMenu:o,bottom:n,right:a,avatarUrl:i??null})):Gl({showMenu:o,bottom:n,right:a,avatarUrl:i??null}))}function Gl({showMenu:s,bottom:e,right:t,avatarUrl:r}){let i=document.createElement("div");document.body.appendChild(i);let a=!0?i.attachShadow({mode:"open"}):i,o=`
<a id="websim-logo-container">
    <div id="websim-close-button">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-4">
            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z" />
        </svg>
    </div>
    <div id="websim-logo">
        <span>w</span><span>e</span><span>b</span><span>s</span><span>i</span><span>m</span>
    </div>
    ${s?r?`<img src="${r}" class="size-5" style="border-radius: 100%; border: 1px solid rgb(64, 64, 64);"/>`:`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
        <path fill-rule="evenodd" d="M9.47 6.47a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 1 1-1.06 1.06L10 8.06l-3.72 3.72a.75.75 0 0 1-1.06-1.06l4.25-4.25Z" clip-rule="evenodd" />
    </svg>
    `:""}
</a>
  `,l=document.createElement("style");l.textContent=`
  #websim-logo-container {
    position: fixed;
    z-index: 2147483647;
    ${e?"bottom: 0;":"top: 0;"}
    ${t?"right: 0;":"left: 0;"}
    margin: 0.25rem;
    color: rgba(255, 255, 255, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: row;
    transform: scale(0) rotate(0deg);
    transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    backdrop-filter: blur(10px);
    background-color: rgba(20, 20, 20, 0.9);
    border-radius: 2rem;
    backdrop-filter: blur(10px);
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    font-family: Helvetica, sans-serif;
    letter-spacing: 0.0em;
    font-size: 0.8rem;
    text-decoration: none;
    padding: 0.4rem 0.8rem;
    gap: 0.8rem;
  }

  .size-5 {
    width: 1.375rem; /* 22px */
    height: 1.375rem; /* 22px */
  }

  #websim-logo-container svg {
    border-radius: 100%;
    padding: 0.2rem;
    background-color: rgba(255, 255, 255, 0.1);
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
  }

  #websim-logo-container.show {
    transform: scale(1) rotate(0deg);
  }

  #websim-logo {
    padding: 0rem 0rem 0.2rem 0.2rem;
    font-family: "Comic Sans MS", cursive;
    font-size: 1rem;
    font-weight: bold;
    text-shadow: 0.04em 0.04em 0.08em rgba(0, 0, 0, 0.25);
    letter-spacing: 0.2em;
    text-decoration: none;
  }

  #websim-logo span {
    display: inline-block;
  }

  #websim-logo span:nth-child(2) {
    transform: rotate(5deg) translateY(-0.2rem);
  }

  #websim-logo span:nth-child(3) {
    transform: rotate(-5deg) translateY(0.1rem);
  }

  #websim-logo span:nth-child(4) {
    transform: rotate(10deg) translateY(-0.1rem);
  }

  #websim-logo span:nth-child(5) {
    transform: rotate(-10deg) translateY(0.2rem);
  }

  #websim-logo span:nth-child(6) {
    transform: rotate(5deg) translateY(-0.1rem);
  }

  #websim-logo span:nth-child(1) { color: #4285f4; }
  #websim-logo span:nth-child(2) { color: #ea4335; }
  #websim-logo span:nth-child(3) { color: #fbbc05; }
  #websim-logo span:nth-child(4) { color: #4285f4; }
  #websim-logo span:nth-child(5) { color: #34a853; }
  #websim-logo span:nth-child(6) { color: #ea4335; }

  @media (prefers-color-scheme: dark) {
    #websim-logo span:nth-child(1) { color: #FEF08A; }
    #websim-logo span:nth-child(2) { color: #99F6E4; }
    #websim-logo span:nth-child(3) { color: #38BDF8; }
    #websim-logo span:nth-child(4) { color: #FEF08A; }
    #websim-logo span:nth-child(5) { color: #F9A8D4; }
    #websim-logo span:nth-child(6) { color: #99F6E4; }
  }

  .size-4 {
    width: 0.75rem;
    height: 0.75rem;
  }

  #websim-close-button {
    position: absolute;
    top: -0.25rem;
    right: -0.25rem;
    cursor: pointer;
    background-color: rgba(20, 20, 20, 0.9);
    border-radius: 50%;
    padding: 0.15rem;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  /* Always show close button on mobile/touch devices */
  @media (hover: none) {
    #websim-close-button {
      opacity: 1;
    }
  }

  #websim-logo-container:hover #websim-close-button {
    opacity: 1;
  }

  `,a.appendChild(l);let c=document.createElement("div");c.innerHTML=o,a.appendChild(c);let u=()=>{a.querySelector("#websim-logo-container")?.classList.add("show")},d=a.querySelector("img");d?d.onload=()=>requestAnimationFrame(()=>setTimeout(u,1e3)):requestAnimationFrame(u);let h=c.querySelector("#websim-logo-container");h&&h.setAttribute("href",Rd());let p=a.querySelector("#websim-close-button");p&&p.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),i.remove()})}function Rd(){let s=__WEBSIM_DATA__.route,e=__WEBSIM_DATA__.project_id,t=new URL(__WEBSIM_DATA__.hostOrigin);return t.search=window.location.search,t.searchParams.set("__websim_pin_sidebar","true"),s?t.pathname=aa(s):e?t.pathname=aa({type:"project",id:e}):t.pathname="/",t.hash=window.location.hash,t.toString()}var Jl=Pc(Yl(),1),vt=window.AudioContext||window.webkitAudioContext,Xl=[],Ql=["auxclick","click","contextmenu","dblclick","keydown","keyup","mousedown","mouseup","touchend"],Bs="blocked",qs="blocked",Se=null,Ke=null,At=null;function Pd(s){s.state==="suspended"&&s.resume().catch(()=>{})}function Od(s){let e=new ArrayBuffer(10),t=new DataView(e);return t.setUint32(0,s,!0),t.setUint32(4,s,!0),t.setUint16(8,1,!0),`data:audio/wav;base64,UklGRisAAABXQVZFZm10IBAAAAABAAEA${btoa(String.fromCharCode(...new Uint8Array(e))).slice(0,13)}AgAZGF0YQcAAACAgICAgICAAAA=`}function Kl(){Bs==="blocked"&&(Bs="pending",Dd()),qs==="blocked"&&(qs="pending",Md())}function Dd(){if(!vt)return;let s=new vt().sampleRate,e=Od(s);Se=document.createElement("audio"),Se.setAttribute("x-webkit-airplay","deny"),Se.preload="auto",Se.loop=!0,Se.src=e,Se.load(),Se.play().then(()=>{Bs="allowed",ec()},()=>{Bs="blocked",Se&&(Se.pause(),Se.removeAttribute("src"),Se.load(),Se=null)})}function Md(){vt&&(Ke=new vt,At=Ke.createBufferSource(),At.buffer=Ke.createBuffer(1,1,22050),At.connect(Ke.destination),At.start(),Ke.state==="running"?(qs="allowed",ec()):(qs="blocked",At&&(At.disconnect(Ke.destination),At=null),Ke&&(Ke.close(),Ke=null)))}function ec(){Bs!=="allowed"||qs!=="allowed"||Ql.forEach(s=>{window.removeEventListener(s,Kl,{capture:!0,passive:!0})})}function Ld(){return`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-volume-off">
    <path d="M16 9a5 5 0 0 1 .95 2.293"/>
    <path d="M19.364 5.636a9 9 0 0 1 1.889 9.96"/>
    <path d="m2 2 20 20"/>
    <path d="m7 7-.587.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298V11"/>
    <path d="M9.828 4.172A.686.686 0 0 1 11 4.657v.686"/>
  </svg>`}function $d(){let s=document.createElement("div");return s.id="websim-unmute-icon",s.style.cssText=`
    position: fixed;
    top: 20px;
    right: 20px;
    width: 44px;
    height: 44px;
    background: rgba(0, 0, 0, 0.8);
    border-radius: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 10000;
    transition: all 0.3s ease;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    user-select: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
  `,s.innerHTML=Ld(),s.addEventListener("mouseenter",()=>{s.style.transform="scale(1.1)",s.style.background="rgba(0, 0, 0, 0.9)"}),s.addEventListener("mouseleave",()=>{s.style.transform="scale(1)",s.style.background="rgba(0, 0, 0, 0.8)"}),s.addEventListener("touchstart",()=>{s.style.transform="scale(0.95)"}),s.addEventListener("touchend",()=>{s.style.transform="scale(1)"}),s}function Us(){for(let e of Xl)Pd(e),e.onstatechange=()=>{e.state==="interrupted"?e.resume():e.state==="suspended"&&la()};let s=document.getElementById("websim-unmute-icon");s&&(s.style.opacity="0",setTimeout(()=>{s.parentNode&&s.parentNode.removeChild(s)},300)),document.removeEventListener("click",Us),document.removeEventListener("touchend",Us)}function la(){if(!document.body){document.addEventListener("DOMContentLoaded",()=>la());return}if(document.getElementById("websim-unmute-icon"))return;let s=$d();document.body.appendChild(s),setTimeout(()=>{s.style.opacity="1"},10),s.addEventListener("click",e=>{e.stopPropagation(),Us()}),setTimeout(()=>{document.addEventListener("click",Us,{once:!0}),document.addEventListener("touchend",Us,{once:!0})},100)}function Nd(){if(!vt)return;let s=function(e){let t=new vt(e);return Xl.push(t),la(),t};s.prototype=vt.prototype,Object.setPrototypeOf(s,vt),window.AudioContext=s,window.webkitAudioContext&&(window.webkitAudioContext=s)}var tc=()=>{let s=/iPad|iPhone|iPod/.test(navigator.userAgent);!(0,Jl.default)()&&!s||(Nd(),Ql.forEach(t=>{window.addEventListener(t,Kl,{capture:!0,passive:!0})}))};function sc(){D.setReady();let s=document.documentElement.outerHTML,e=window.setInterval(()=>{let t=document.documentElement.outerHTML.replace(/(<\/[^>]+>)+$/,"");if(t.length-s.length===0)return;let i=t.slice(s.length);s=t,D.setProgress(i)},32);document.addEventListener("DOMContentLoaded",()=>{D.setLoaded(),clearInterval(e)})}var he=globalThis.ProgressEvent||class extends Event{loaded=0;total=0;lengthComputable=!1;constructor(e,t){super(e,t),t?.loaded!==void 0&&(this.loaded=t.loaded),t?.total!==void 0&&(this.total=t.total),t?.lengthComputable!==void 0&&(this.lengthComputable=t.lengthComputable)}},Fd=["abort","error","load","loadend","loadstart","progress","timeout","readystatechange"];function jd(s){return Fd.includes(s)}var Ur=class extends EventTarget{onabort=null;onerror=null;onload=null;onloadend=null;onloadstart=null;onprogress=null;ontimeout=null;onreadystatechange=null;dispatchEvent(e){return jd(e.type)&&this[`on${e.type}`]&&this[`on${e.type}`](e),super.dispatchEvent(e)}},ca=class extends Ur{},Br=class s extends Ur{static UNSENT=0;static OPENED=1;static HEADERS_RECEIVED=2;static LOADING=3;static DONE=4;UNSENT=s.UNSENT;OPENED=s.OPENED;HEADERS_RECEIVED=s.HEADERS_RECEIVED;LOADING=s.LOADING;DONE=s.DONE;_readyState=s.UNSENT;_status=0;_statusText="";_url="";_method;_headers={};_overrideMimeType;_responseType="";_responseText="";_responseBuffer=null;_responseBlob=null;_responseDocument=null;_responseJSON=null;_controller=new AbortController;_responseHeaders={};_responseURL="";_responseChunks=[];upload=new ca;body;withCredentials=!1;timeout=0;set responseType(e){if(this._readyState>=s.HEADERS_RECEIVED)throw new DOMException("Failed to set the 'responseType' property on 'XMLHttpRequest': The response type cannot be set if the object's state is LOADING or DONE.","InvalidStateError");(e===""||e==="text"||e==="blob"||e==="arraybuffer"||e==="document"||e==="json")&&(this._responseType=e)}get responseType(){return this._responseType}get readyState(){return this._readyState}get status(){return this._status}get statusText(){return this._statusText}get responseURL(){return this._responseURL}get responseXML(){if(this._responseType!==""&&this._responseType!=="document")throw new DOMException(`Failed to read the 'responseXML' property from 'XMLHttpRequest': The value is only accessible if the object's 'responseType' is '' or 'document' (was '${this._responseType}').`,"InvalidStateError");return this._responseDocument}get responseText(){if(this._responseType!==""&&this._responseType!=="text")throw new DOMException(`Failed to read the 'responseText' property from 'XMLHttpRequest': The value is only accessible if the object's 'responseType' is '' or 'text' (was '${this._responseType}').`,"InvalidStateError");return this._responseText}get response(){if(this.readyState<s.DONE)return null;switch(this._responseType){case"":case"text":return this._responseText;case"blob":return this._responseBlob;case"arraybuffer":return this._responseBuffer;case"json":return this._responseJSON;case"document":return this._responseDocument}}overrideMimeType(e){this._overrideMimeType=e}open(e,t,r=!0,i,n){if(r===!1)throw new Error("Sync XMLHttpRequest is not supported");(i||n)&&(typeof t=="string"&&(t=new URL(t)),i&&(t.username=i),n&&(t.password=n)),this._method=e,this._url=String(t),this._readyState=s.OPENED,this.dispatchEvent(new Event("readystatechange",{bubbles:!1,cancelable:!1}))}setRequestHeader(e,t){this._headers[e]=t}send(e){this.body=e,this._readyState=s.HEADERS_RECEIVED,this.dispatchEvent(new Event("readystatechange",{bubbles:!1,cancelable:!1}));let t=new Headers(this._headers);if(!t.has("Accept"))switch(this._responseType){case"":case"blob":case"arraybuffer":case"text":t.set("Accept","*/*");break;case"json":t.set("Accept","application/json, text/javascript");break;case"document":t.set("Content-Type","text/html");break}let r;this.timeout>0&&(r=setTimeout(()=>{this._controller.abort()},this.timeout));let i=e instanceof Blob?e.size:e?.toString().length,n={lengthComputable:i!==void 0,loaded:0,total:i,bubbles:!1,cancelable:!1};this.upload.dispatchEvent(new he("loadstart",n));let a={lengthComputable:!1,loaded:0,total:void 0,bubbles:!1,cancelable:!1},o;e instanceof Document?o=new XMLSerializer().serializeToString(e):o=e,fetch(this._url,{method:this._method,headers:t,body:o,credentials:this.withCredentials?"include":"omit",signal:this._controller.signal}).then(l=>{n.loaded=i||0,this.upload.dispatchEvent(new he("load",n)),this.upload.dispatchEvent(new he("loadend",n));let c,u,d=new Promise((_,S)=>{c=_,u=S});this._status=l.status,this._statusText=l.statusText,this._readyState=s.LOADING,this.dispatchEvent(new Event("readystatechange",{bubbles:!1,cancelable:!1}));for(let[_,S]of l.headers.entries())this._responseHeaders[_]=S;if(this._responseURL=l.url,!l.body)return;let h=l.headers.get("Content-Length");h&&(a.total=Number.parseInt(h,10),a.lengthComputable=!0);let p=l.body.getReader(),g=new TextDecoder,v=async _=>{if(_.done){switch(clearTimeout(r),this.responseType){case"json":try{this._responseJSON=JSON.parse(this._responseText)}catch{}break;case"document":this._responseDocument=new DOMParser().parseFromString(this._responseText,this._overrideMimeType??l.headers.get("Content-Type")??"text/html");break;case"blob":this._responseBlob=new Blob(this._responseChunks,{type:this._overrideMimeType??l.headers.get("Content-Type")??void 0});break;case"arraybuffer":{let S=0;this._responseChunks.forEach(M=>{S+=M.length});let O=new ArrayBuffer(S),A=new Uint8Array(O),I=0;this._responseChunks.forEach(M=>{A.set(M,I),I+=M.byteLength}),this._responseBuffer=O}break}this._readyState=s.DONE,this.dispatchEvent(new Event("readystatechange",{bubbles:!1,cancelable:!1})),this.dispatchEvent(new he("load",a)),this.dispatchEvent(new he("loadend",a));return}if(_.value===void 0){clearTimeout(r),this._readyState=s.DONE,this.dispatchEvent(new Event("readystatechange",{bubbles:!1,cancelable:!1})),this.dispatchEvent(new he("abort",a)),this.dispatchEvent(new he("error",a)),c();return}a.loaded+=_.value.length,this._responseText+=g.decode(_.value,{stream:!0}),this._responseChunks.push(_.value),this.dispatchEvent(new he("progress",a)),p.read().then(v,u)};return p.read().then(v,u),d}).catch(l=>{this._readyState=s.DONE,this.dispatchEvent(new Event("readystatechange",{bubbles:!1,cancelable:!1})),l.name==="AbortError"?(this.dispatchEvent(new he("timeout",a)),this.upload.dispatchEvent(new he("timeout",a))):(this.dispatchEvent(new he("error",a)),this.upload.dispatchEvent(new he("error",a)),this.dispatchEvent(new he("loadend",a)),this.upload.dispatchEvent(new he("loadend",a)))})}abort(){this._controller.abort()}getResponseHeader(e){return this._responseHeaders[e]||null}getAllResponseHeaders(){return Object.entries(this._responseHeaders).map(([e,t])=>`${e}: ${t}`).join(`\r
`)}};function rc(){let s=__WEBSIM_DATA__;if(window.fetchPatched)return;let e=window.fetch;window.XMLHttpRequest=Br;let t=ke(D.getFetchParams);window.fetch=async function(r,i={}){let n=new URL(r?.url?String(r.url):String(r),window.location.origin);if(!(n.origin===window.location.origin||n.origin==="https://websim.com"||n.origin===s.hostOrigin))return e(n,i);let o=n.pathname.startsWith("/api/v1/"),l=n.pathname.startsWith("/internal/api/v1/"),c=n.pathname.startsWith("/api/")&&!o;if(!(o||l||c))return e(n,i);if(i.headers instanceof Headers||(i.headers=new Headers(i.headers)),i.headers=Object.fromEntries(i.headers),c){let{websimUpdateVersion:Q}=await t();i.headers["Websim-Update"]=`${Q}`}let{body:d,method:h,headers:p,mode:g,credentials:v,cache:_,redirect:S,referrer:O,referrerPolicy:A,integrity:I,keepalive:M}=i,W=await D.fetchApi({url:n.toString(),options:{body:d,method:h,headers:p,mode:g,credentials:v,cache:_,redirect:S,referrer:O,referrerPolicy:A,integrity:I,keepalive:M}});return new Response(W.body,W)},window.fetchPatched=!0}function ic(){D.getPlugins().then(s=>{for(let t of s){let r=document.createElement("div");r.classList.add("websim-plugin"),document.body.appendChild(r),e(r,t)}async function e(t,r){t.innerHTML=r;let i=Array.from(t.querySelectorAll("script"));for(let n of i){let a=document.createElement("script");Array.from(n.attributes).forEach(c=>{a.setAttribute(c.name,c.value)});let o=document.createTextNode(n.innerHTML),l=Promise.resolve();a.src&&(a.async=!1,l=new Promise(c=>{a.addEventListener("load",()=>{c()})})),a.appendChild(o),n.parentNode?.replaceChild(a,n),await l}}},s=>{console.error("error",s)})}var Ud=history.pushState,Bd=history.replaceState;function nc(){let s=({replace:e})=>{let t=new URL(window.location.href);D.relayUrlToHost({pathname:t.pathname,hash:t.hash,search:t.search,replace:e})};history.pushState=function(...e){Ud.apply(this,e),s({replace:!1})},history.replaceState=function(...e){Bd.apply(this,e),s({replace:!0})},window.addEventListener("popstate",function(){s({replace:!0})}),window.addEventListener("hashchange",function(){s({replace:!1})})}var te=[];for(let s=0;s<256;++s)te.push((s+256).toString(16).slice(1));function ac(s,e=0){return(te[s[e+0]]+te[s[e+1]]+te[s[e+2]]+te[s[e+3]]+"-"+te[s[e+4]]+te[s[e+5]]+"-"+te[s[e+6]]+te[s[e+7]]+"-"+te[s[e+8]]+te[s[e+9]]+"-"+te[s[e+10]]+te[s[e+11]]+te[s[e+12]]+te[s[e+13]]+te[s[e+14]]+te[s[e+15]]).toLowerCase()}var ua,qd=new Uint8Array(16);function da(){if(!ua){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ua=crypto.getRandomValues.bind(crypto)}return ua(qd)}var Hd=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ha={randomUUID:Hd};function zd(s,e,t){s=s||{};let r=s.random??s.rng?.()??da();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){if(t=t||0,t<0||t+16>e.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let i=0;i<16;++i)e[t+i]=r[i];return e}return ac(r)}function Wd(s,e,t){return ha.randomUUID&&!e&&!s?ha.randomUUID():zd(s,e,t)}var pa=Wd;var qr=class{completions={create:async({messages:e,json:t})=>D.chatCompletion({messages:e,json:t})}};function oc(){window.websim=Object.freeze({getUser:ke(D.getUser),getCurrentUser:ke(D.getUser),getDistinctId:ke(D.getDistinctId),getBootstrap:ke(D.getBootstrap),getCreatedBy:ke(D.getCreatedBy),getCreator:ke(D.getCreator),getCurrentProject:ke(D.getCurrentProject),getColorScheme:D.getColorScheme,postComment:D.postComment,renderVideo:s=>{let e=pa(),t=i=>{i.data?.type==="render:progress"&&i.data.id===e&&s.onProgress?.(i.data.data)};window.addEventListener("message",t);let r=D._renderVideo(JSON.parse(JSON.stringify({inputProps:s.inputProps,composition:s.composition,options:s.options,id:e})));return r.finally(()=>{window.removeEventListener("message",t)}),r},addEventListener:(s,e)=>{D.addEventListener(s);let t=r=>{r.data?.type===s&&e(r.data.data)};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}},upload:D.uploadFile,chat:new qr,imageGen:D.generateImage2,textToSpeech:s=>{let e={text:s.text,voice:s.voice,voice_sample:s.voice_sample};return s.voice_sample&&(e.voice_sample=new URL(s.voice_sample,window.location.origin).toString()),D.generateTextToSpeech(e)},experimental:Object.freeze({v0:Object.freeze({login:D.login,save(){throw new Error("Feature not supported")},getHTML(){throw new Error("Feature not supported")}})}),internal_only_experimental:{}})}var Hr=class{name;onmessage=null;onmessageerror=null;close=()=>{};postMessage=()=>{};start=()=>{};stop=()=>{};addEventListener=()=>{};removeEventListener=()=>{};dispatchEvent=()=>!1;constructor(e){this.name=e,D.sendBroadcastChannelMessage({eventType:"WEBSIM_BROADCAST_CHANNEL_INIT",message:null,channelName:this.name}),window.addEventListener("message",t=>{if(t.data?.type==="WEBSIM_BROADCAST_CHANNEL_MESSAGE"&&t.data?.channelName===this.name){let r=new MessageEvent("message",{data:t.data.message,origin:t.origin,lastEventId:"",source:null,ports:[]});this.onmessage&&this.onmessage.call(this,r),this.dispatchEvent(r)}}),this.postMessage=t=>{D.sendBroadcastChannelMessage({eventType:"WEBSIM_BROADCAST_CHANNEL_POST",channelName:this.name,message:t})},this.close=()=>{D.sendBroadcastChannelMessage({eventType:"WEBSIM_BROADCAST_CHANNEL_CLOSE",channelName:this.name,message:null})},this.addEventListener=(t,r,i)=>{t==="message"&&(this.onmessage=r)},this.removeEventListener=(t,r,i)=>{t==="message"&&r===this.onmessage&&(this.onmessage=null)}}};var Vs={};Ac(Vs,{BRAND:()=>mh,DIRTY:()=>It,EMPTY_PATH:()=>Yd,INVALID:()=>C,NEVER:()=>tp,OK:()=>ne,ParseStatus:()=>se,Schema:()=>$,ZodAny:()=>yt,ZodArray:()=>rt,ZodBigInt:()=>Ot,ZodBoolean:()=>Dt,ZodBranded:()=>zs,ZodCatch:()=>zt,ZodDate:()=>Mt,ZodDefault:()=>Ht,ZodDiscriminatedUnion:()=>Vr,ZodEffects:()=>Ce,ZodEnum:()=>Bt,ZodError:()=>pe,ZodFirstPartyTypeKind:()=>P,ZodFunction:()=>Zr,ZodIntersection:()=>Ft,ZodIssueCode:()=>m,ZodLazy:()=>jt,ZodLiteral:()=>Ut,ZodMap:()=>fs,ZodNaN:()=>vs,ZodNativeEnum:()=>qt,ZodNever:()=>Oe,ZodNull:()=>$t,ZodNullable:()=>ze,ZodNumber:()=>Pt,ZodObject:()=>fe,ZodOptional:()=>Te,ZodParsedType:()=>x,ZodPipeline:()=>Ws,ZodPromise:()=>bt,ZodReadonly:()=>Wt,ZodRecord:()=>Gr,ZodSchema:()=>$,ZodSet:()=>gs,ZodString:()=>_t,ZodSymbol:()=>hs,ZodTransformer:()=>Ce,ZodTuple:()=>He,ZodType:()=>$,ZodUndefined:()=>Lt,ZodUnion:()=>Nt,ZodUnknown:()=>st,ZodVoid:()=>ps,addIssueToContext:()=>w,any:()=>Th,array:()=>Ih,bigint:()=>wh,boolean:()=>_c,coerce:()=>ep,custom:()=>gc,date:()=>Eh,datetimeRegex:()=>pc,defaultErrorMap:()=>et,discriminatedUnion:()=>Mh,effect:()=>Vh,enum:()=>Hh,function:()=>Uh,getErrorMap:()=>cs,getParsedType:()=>qe,instanceof:()=>yh,intersection:()=>Lh,isAborted:()=>zr,isAsync:()=>us,isDirty:()=>Wr,isValid:()=>mt,late:()=>_h,lazy:()=>Bh,literal:()=>qh,makeIssue:()=>Hs,map:()=>Fh,nan:()=>bh,nativeEnum:()=>zh,never:()=>Ch,null:()=>Sh,nullable:()=>Zh,number:()=>mc,object:()=>Ph,objectUtil:()=>fa,oboolean:()=>Kh,onumber:()=>Qh,optional:()=>Gh,ostring:()=>Xh,pipeline:()=>Jh,preprocess:()=>Yh,promise:()=>Wh,quotelessJson:()=>Vd,record:()=>Nh,set:()=>jh,setErrorMap:()=>Zd,strictObject:()=>Oh,string:()=>vc,symbol:()=>xh,transformer:()=>Vh,tuple:()=>$h,undefined:()=>kh,union:()=>Dh,unknown:()=>Rh,util:()=>F,void:()=>Ah});var F;(function(s){s.assertEqual=i=>{};function e(i){}s.assertIs=e;function t(i){throw new Error}s.assertNever=t,s.arrayToEnum=i=>{let n={};for(let a of i)n[a]=a;return n},s.getValidEnumValues=i=>{let n=s.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(let o of n)a[o]=i[o];return s.objectValues(a)},s.objectValues=i=>s.objectKeys(i).map(function(n){return i[n]}),s.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{let n=[];for(let a in i)Object.prototype.hasOwnProperty.call(i,a)&&n.push(a);return n},s.find=(i,n)=>{for(let a of i)if(n(a))return a},s.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,n=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(n)}s.joinValues=r,s.jsonStringifyReplacer=(i,n)=>typeof n=="bigint"?n.toString():n})(F||(F={}));var fa;(function(s){s.mergeShapes=(e,t)=>({...e,...t})})(fa||(fa={}));var x=F.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),qe=s=>{switch(typeof s){case"undefined":return x.undefined;case"string":return x.string;case"number":return Number.isNaN(s)?x.nan:x.number;case"boolean":return x.boolean;case"function":return x.function;case"bigint":return x.bigint;case"symbol":return x.symbol;case"object":return Array.isArray(s)?x.array:s===null?x.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?x.promise:typeof Map<"u"&&s instanceof Map?x.map:typeof Set<"u"&&s instanceof Set?x.set:typeof Date<"u"&&s instanceof Date?x.date:x.object;default:return x.unknown}};var m=F.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Vd=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:"),pe=class s extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(n){return n.message},r={_errors:[]},i=n=>{for(let a of n.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)r._errors.push(t(a));else{let o=r,l=0;for(;l<a.path.length;){let c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return i(this),r}static assert(e){if(!(e instanceof s))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,F.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},r=[];for(let i of this.issues)if(i.path.length>0){let n=i.path[0];t[n]=t[n]||[],t[n].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}};pe.create=s=>new pe(s);var Gd=(s,e)=>{let t;switch(s.code){case m.invalid_type:s.received===x.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case m.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,F.jsonStringifyReplacer)}`;break;case m.unrecognized_keys:t=`Unrecognized key(s) in object: ${F.joinValues(s.keys,", ")}`;break;case m.invalid_union:t="Invalid input";break;case m.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${F.joinValues(s.options)}`;break;case m.invalid_enum_value:t=`Invalid enum value. Expected ${F.joinValues(s.options)}, received '${s.received}'`;break;case m.invalid_arguments:t="Invalid function arguments";break;case m.invalid_return_type:t="Invalid function return type";break;case m.invalid_date:t="Invalid date";break;case m.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:F.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case m.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case m.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case m.custom:t="Invalid input";break;case m.invalid_intersection_types:t="Intersection results could not be merged";break;case m.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case m.not_finite:t="Number must be finite";break;default:t=e.defaultError,F.assertNever(s)}return{message:t}},et=Gd;var lc=et;function Zd(s){lc=s}function cs(){return lc}var Hs=s=>{let{data:e,path:t,errorMaps:r,issueData:i}=s,n=[...t,...i.path||[]],a={...i,path:n};if(i.message!==void 0)return{...i,path:n,message:i.message};let o="",l=r.filter(c=>!!c).slice().reverse();for(let c of l)o=c(a,{data:e,defaultError:o}).message;return{...i,path:n,message:o}},Yd=[];function w(s,e){let t=cs(),r=Hs({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,t,t===et?void 0:et].filter(i=>!!i)});s.common.issues.push(r)}var se=class s{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let i of t){if(i.status==="aborted")return C;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let i of t){let n=await i.key,a=await i.value;r.push({key:n,value:a})}return s.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let i of t){let{key:n,value:a}=i;if(n.status==="aborted"||a.status==="aborted")return C;n.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(r[n.value]=a.value)}return{status:e.value,value:r}}},C=Object.freeze({status:"aborted"}),It=s=>({status:"dirty",value:s}),ne=s=>({status:"valid",value:s}),zr=s=>s.status==="aborted",Wr=s=>s.status==="dirty",mt=s=>s.status==="valid",us=s=>typeof Promise<"u"&&s instanceof Promise;var T;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(T||(T={}));var Re=class{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},cc=(s,e)=>{if(mt(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new pe(s.common.issues);return this._error=t,this._error}}};function L(s){if(!s)return{};let{errorMap:e,invalid_type_error:t,required_error:r,description:i}=s;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,o)=>{let{message:l}=s;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??t??o.defaultError}},description:i}}var $=class{get description(){return this._def.description}_getType(e){return qe(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:qe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new se,ctx:{common:e.parent.common,data:e.data,parsedType:qe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(us(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:qe(e)},i=this._parseSync({data:e,path:r.path,parent:r});return cc(r,i)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:qe(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return mt(r)?{value:r.value}:{issues:t.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>mt(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:qe(e)},i=this._parse({data:e,path:r.path,parent:r}),n=await(us(i)?i:Promise.resolve(i));return cc(r,n)}refine(e,t){let r=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,n)=>{let a=e(i),o=()=>n.addIssue({code:m.custom,...r(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof t=="function"?t(r,i):t),!1))}_refinement(e){return new Ce({schema:this,typeName:P.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Te.create(this,this._def)}nullable(){return ze.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return rt.create(this)}promise(){return bt.create(this,this._def)}or(e){return Nt.create([this,e],this._def)}and(e){return Ft.create(this,e,this._def)}transform(e){return new Ce({...L(this._def),schema:this,typeName:P.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new Ht({...L(this._def),innerType:this,defaultValue:t,typeName:P.ZodDefault})}brand(){return new zs({typeName:P.ZodBranded,type:this,...L(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new zt({...L(this._def),innerType:this,catchValue:t,typeName:P.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Ws.create(this,e)}readonly(){return Wt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},Jd=/^c[^\s-]{8,}$/i,Xd=/^[0-9a-z]+$/,Qd=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Kd=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,eh=/^[a-z0-9_-]{21}$/i,th=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,sh=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,rh=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ih="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",ga,nh=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ah=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,oh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,lh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ch=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,uh=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dc="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dh=new RegExp(`^${dc}$`);function hc(s){let e="[0-5]\\d";s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`);let t=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function hh(s){return new RegExp(`^${hc(s)}$`)}function pc(s){let e=`${dc}T${hc(s)}`,t=[];return t.push(s.local?"Z?":"Z"),s.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function ph(s,e){return!!((e==="v4"||!e)&&nh.test(s)||(e==="v6"||!e)&&oh.test(s))}function fh(s,e){if(!th.test(s))return!1;try{let[t]=s.split(".");if(!t)return!1;let r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&i?.typ!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function gh(s,e){return!!((e==="v4"||!e)&&ah.test(s)||(e==="v6"||!e)&&lh.test(s))}var _t=class s extends ${_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==x.string){let n=this._getOrReturnCtx(e);return w(n,{code:m.invalid_type,expected:x.string,received:n.parsedType}),C}let r=new se,i;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(i=this._getOrReturnCtx(e,i),w(i,{code:m.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),r.dirty());else if(n.kind==="max")e.data.length>n.value&&(i=this._getOrReturnCtx(e,i),w(i,{code:m.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),r.dirty());else if(n.kind==="length"){let a=e.data.length>n.value,o=e.data.length<n.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?w(i,{code:m.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&w(i,{code:m.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),r.dirty())}else if(n.kind==="email")rh.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"email",code:m.invalid_string,message:n.message}),r.dirty());else if(n.kind==="emoji")ga||(ga=new RegExp(ih,"u")),ga.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"emoji",code:m.invalid_string,message:n.message}),r.dirty());else if(n.kind==="uuid")Kd.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"uuid",code:m.invalid_string,message:n.message}),r.dirty());else if(n.kind==="nanoid")eh.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"nanoid",code:m.invalid_string,message:n.message}),r.dirty());else if(n.kind==="cuid")Jd.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"cuid",code:m.invalid_string,message:n.message}),r.dirty());else if(n.kind==="cuid2")Xd.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"cuid2",code:m.invalid_string,message:n.message}),r.dirty());else if(n.kind==="ulid")Qd.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"ulid",code:m.invalid_string,message:n.message}),r.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),w(i,{validation:"url",code:m.invalid_string,message:n.message}),r.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"regex",code:m.invalid_string,message:n.message}),r.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(i=this._getOrReturnCtx(e,i),w(i,{code:m.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),r.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(i=this._getOrReturnCtx(e,i),w(i,{code:m.invalid_string,validation:{startsWith:n.value},message:n.message}),r.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(i=this._getOrReturnCtx(e,i),w(i,{code:m.invalid_string,validation:{endsWith:n.value},message:n.message}),r.dirty()):n.kind==="datetime"?pc(n).test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{code:m.invalid_string,validation:"datetime",message:n.message}),r.dirty()):n.kind==="date"?dh.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{code:m.invalid_string,validation:"date",message:n.message}),r.dirty()):n.kind==="time"?hh(n).test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{code:m.invalid_string,validation:"time",message:n.message}),r.dirty()):n.kind==="duration"?sh.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"duration",code:m.invalid_string,message:n.message}),r.dirty()):n.kind==="ip"?ph(e.data,n.version)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"ip",code:m.invalid_string,message:n.message}),r.dirty()):n.kind==="jwt"?fh(e.data,n.alg)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"jwt",code:m.invalid_string,message:n.message}),r.dirty()):n.kind==="cidr"?gh(e.data,n.version)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"cidr",code:m.invalid_string,message:n.message}),r.dirty()):n.kind==="base64"?ch.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"base64",code:m.invalid_string,message:n.message}),r.dirty()):n.kind==="base64url"?uh.test(e.data)||(i=this._getOrReturnCtx(e,i),w(i,{validation:"base64url",code:m.invalid_string,message:n.message}),r.dirty()):F.assertNever(n);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(i=>e.test(i),{validation:t,code:m.invalid_string,...T.errToObj(r)})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...T.errToObj(e)})}url(e){return this._addCheck({kind:"url",...T.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...T.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...T.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...T.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...T.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...T.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...T.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...T.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...T.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...T.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...T.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...T.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...T.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...T.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...T.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...T.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...T.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...T.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...T.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...T.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...T.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...T.errToObj(t)})}nonempty(e){return this.min(1,T.errToObj(e))}trim(){return new s({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new s({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new s({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};_t.create=s=>new _t({checks:[],typeName:P.ZodString,coerce:s?.coerce??!1,...L(s)});function vh(s,e){let t=(s.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=t>r?t:r,n=Number.parseInt(s.toFixed(i).replace(".","")),a=Number.parseInt(e.toFixed(i).replace(".",""));return n%a/10**i}var Pt=class s extends ${constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==x.number){let n=this._getOrReturnCtx(e);return w(n,{code:m.invalid_type,expected:x.number,received:n.parsedType}),C}let r,i=new se;for(let n of this._def.checks)n.kind==="int"?F.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{code:m.invalid_type,expected:"integer",received:"float",message:n.message}),i.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(r=this._getOrReturnCtx(e,r),w(r,{code:m.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),i.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(r=this._getOrReturnCtx(e,r),w(r,{code:m.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),i.dirty()):n.kind==="multipleOf"?vh(e.data,n.value)!==0&&(r=this._getOrReturnCtx(e,r),w(r,{code:m.not_multiple_of,multipleOf:n.value,message:n.message}),i.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{code:m.not_finite,message:n.message}),i.dirty()):F.assertNever(n);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,T.toString(t))}gt(e,t){return this.setLimit("min",e,!1,T.toString(t))}lte(e,t){return this.setLimit("max",e,!0,T.toString(t))}lt(e,t){return this.setLimit("max",e,!1,T.toString(t))}setLimit(e,t,r,i){return new s({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:T.toString(i)}]})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:T.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:T.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:T.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:T.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:T.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:T.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:T.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:T.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:T.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&F.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}};Pt.create=s=>new Pt({checks:[],typeName:P.ZodNumber,coerce:s?.coerce||!1,...L(s)});var Ot=class s extends ${constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==x.bigint)return this._getInvalidInput(e);let r,i=new se;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(r=this._getOrReturnCtx(e,r),w(r,{code:m.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),i.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(r=this._getOrReturnCtx(e,r),w(r,{code:m.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),i.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),w(r,{code:m.not_multiple_of,multipleOf:n.value,message:n.message}),i.dirty()):F.assertNever(n);return{status:i.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return w(t,{code:m.invalid_type,expected:x.bigint,received:t.parsedType}),C}gte(e,t){return this.setLimit("min",e,!0,T.toString(t))}gt(e,t){return this.setLimit("min",e,!1,T.toString(t))}lte(e,t){return this.setLimit("max",e,!0,T.toString(t))}lt(e,t){return this.setLimit("max",e,!1,T.toString(t))}setLimit(e,t,r,i){return new s({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:T.toString(i)}]})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:T.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:T.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:T.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:T.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:T.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Ot.create=s=>new Ot({checks:[],typeName:P.ZodBigInt,coerce:s?.coerce??!1,...L(s)});var Dt=class extends ${_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==x.boolean){let r=this._getOrReturnCtx(e);return w(r,{code:m.invalid_type,expected:x.boolean,received:r.parsedType}),C}return ne(e.data)}};Dt.create=s=>new Dt({typeName:P.ZodBoolean,coerce:s?.coerce||!1,...L(s)});var Mt=class s extends ${_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==x.date){let n=this._getOrReturnCtx(e);return w(n,{code:m.invalid_type,expected:x.date,received:n.parsedType}),C}if(Number.isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return w(n,{code:m.invalid_date}),C}let r=new se,i;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(i=this._getOrReturnCtx(e,i),w(i,{code:m.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),r.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(i=this._getOrReturnCtx(e,i),w(i,{code:m.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),r.dirty()):F.assertNever(n);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:T.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:T.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};Mt.create=s=>new Mt({checks:[],coerce:s?.coerce||!1,typeName:P.ZodDate,...L(s)});var hs=class extends ${_parse(e){if(this._getType(e)!==x.symbol){let r=this._getOrReturnCtx(e);return w(r,{code:m.invalid_type,expected:x.symbol,received:r.parsedType}),C}return ne(e.data)}};hs.create=s=>new hs({typeName:P.ZodSymbol,...L(s)});var Lt=class extends ${_parse(e){if(this._getType(e)!==x.undefined){let r=this._getOrReturnCtx(e);return w(r,{code:m.invalid_type,expected:x.undefined,received:r.parsedType}),C}return ne(e.data)}};Lt.create=s=>new Lt({typeName:P.ZodUndefined,...L(s)});var $t=class extends ${_parse(e){if(this._getType(e)!==x.null){let r=this._getOrReturnCtx(e);return w(r,{code:m.invalid_type,expected:x.null,received:r.parsedType}),C}return ne(e.data)}};$t.create=s=>new $t({typeName:P.ZodNull,...L(s)});var yt=class extends ${constructor(){super(...arguments),this._any=!0}_parse(e){return ne(e.data)}};yt.create=s=>new yt({typeName:P.ZodAny,...L(s)});var st=class extends ${constructor(){super(...arguments),this._unknown=!0}_parse(e){return ne(e.data)}};st.create=s=>new st({typeName:P.ZodUnknown,...L(s)});var Oe=class extends ${_parse(e){let t=this._getOrReturnCtx(e);return w(t,{code:m.invalid_type,expected:x.never,received:t.parsedType}),C}};Oe.create=s=>new Oe({typeName:P.ZodNever,...L(s)});var ps=class extends ${_parse(e){if(this._getType(e)!==x.undefined){let r=this._getOrReturnCtx(e);return w(r,{code:m.invalid_type,expected:x.void,received:r.parsedType}),C}return ne(e.data)}};ps.create=s=>new ps({typeName:P.ZodVoid,...L(s)});var rt=class s extends ${_parse(e){let{ctx:t,status:r}=this._processInputParams(e),i=this._def;if(t.parsedType!==x.array)return w(t,{code:m.invalid_type,expected:x.array,received:t.parsedType}),C;if(i.exactLength!==null){let a=t.data.length>i.exactLength.value,o=t.data.length<i.exactLength.value;(a||o)&&(w(t,{code:a?m.too_big:m.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(w(t,{code:m.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(w(t,{code:m.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>i.type._parseAsync(new Re(t,a,t.path,o)))).then(a=>se.mergeArray(r,a));let n=[...t.data].map((a,o)=>i.type._parseSync(new Re(t,a,t.path,o)));return se.mergeArray(r,n)}get element(){return this._def.type}min(e,t){return new s({...this._def,minLength:{value:e,message:T.toString(t)}})}max(e,t){return new s({...this._def,maxLength:{value:e,message:T.toString(t)}})}length(e,t){return new s({...this._def,exactLength:{value:e,message:T.toString(t)}})}nonempty(e){return this.min(1,e)}};rt.create=(s,e)=>new rt({type:s,minLength:null,maxLength:null,exactLength:null,typeName:P.ZodArray,...L(e)});function ds(s){if(s instanceof fe){let e={};for(let t in s.shape){let r=s.shape[t];e[t]=Te.create(ds(r))}return new fe({...s._def,shape:()=>e})}else return s instanceof rt?new rt({...s._def,type:ds(s.element)}):s instanceof Te?Te.create(ds(s.unwrap())):s instanceof ze?ze.create(ds(s.unwrap())):s instanceof He?He.create(s.items.map(e=>ds(e))):s}var fe=class s extends ${constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=F.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==x.object){let c=this._getOrReturnCtx(e);return w(c,{code:m.invalid_type,expected:x.object,received:c.parsedType}),C}let{status:r,ctx:i}=this._processInputParams(e),{shape:n,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof Oe&&this._def.unknownKeys==="strip"))for(let c in i.data)a.includes(c)||o.push(c);let l=[];for(let c of a){let u=n[c],d=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Re(i,d,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof Oe){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(c==="strict")o.length>0&&(w(i,{code:m.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let c=this._def.catchall;for(let u of o){let d=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Re(i,d,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{let c=[];for(let u of l){let d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>se.mergeObjectSync(r,c)):se.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return T.errToObj,new s({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{let i=this._def.errorMap?.(t,r).message??r.defaultError;return t.code==="unrecognized_keys"?{message:T.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new s({...this._def,unknownKeys:"strip"})}passthrough(){return new s({...this._def,unknownKeys:"passthrough"})}extend(e){return new s({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new s({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:P.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new s({...this._def,catchall:e})}pick(e){let t={};for(let r of F.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new s({...this._def,shape:()=>t})}omit(e){let t={};for(let r of F.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new s({...this._def,shape:()=>t})}deepPartial(){return ds(this)}partial(e){let t={};for(let r of F.objectKeys(this.shape)){let i=this.shape[r];e&&!e[r]?t[r]=i:t[r]=i.optional()}return new s({...this._def,shape:()=>t})}required(e){let t={};for(let r of F.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let n=this.shape[r];for(;n instanceof Te;)n=n._def.innerType;t[r]=n}return new s({...this._def,shape:()=>t})}keyof(){return fc(F.objectKeys(this.shape))}};fe.create=(s,e)=>new fe({shape:()=>s,unknownKeys:"strip",catchall:Oe.create(),typeName:P.ZodObject,...L(e)});fe.strictCreate=(s,e)=>new fe({shape:()=>s,unknownKeys:"strict",catchall:Oe.create(),typeName:P.ZodObject,...L(e)});fe.lazycreate=(s,e)=>new fe({shape:s,unknownKeys:"strip",catchall:Oe.create(),typeName:P.ZodObject,...L(e)});var Nt=class extends ${_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;function i(n){for(let o of n)if(o.result.status==="valid")return o.result;for(let o of n)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;let a=n.map(o=>new pe(o.ctx.common.issues));return w(t,{code:m.invalid_union,unionErrors:a}),C}if(t.common.async)return Promise.all(r.map(async n=>{let a={...t,common:{...t.common,issues:[]},parent:null};return{result:await n._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(i);{let n,a=[];for(let l of r){let c={...t,common:{...t.common,issues:[]},parent:null},u=l._parseSync({data:t.data,path:t.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!n&&(n={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(n)return t.common.issues.push(...n.ctx.common.issues),n.result;let o=a.map(l=>new pe(l));return w(t,{code:m.invalid_union,unionErrors:o}),C}}get options(){return this._def.options}};Nt.create=(s,e)=>new Nt({options:s,typeName:P.ZodUnion,...L(e)});var tt=s=>s instanceof jt?tt(s.schema):s instanceof Ce?tt(s.innerType()):s instanceof Ut?[s.value]:s instanceof Bt?s.options:s instanceof qt?F.objectValues(s.enum):s instanceof Ht?tt(s._def.innerType):s instanceof Lt?[void 0]:s instanceof $t?[null]:s instanceof Te?[void 0,...tt(s.unwrap())]:s instanceof ze?[null,...tt(s.unwrap())]:s instanceof zs||s instanceof Wt?tt(s.unwrap()):s instanceof zt?tt(s._def.innerType):[],Vr=class s extends ${_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==x.object)return w(t,{code:m.invalid_type,expected:x.object,received:t.parsedType}),C;let r=this.discriminator,i=t.data[r],n=this.optionsMap.get(i);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):(w(t,{code:m.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),C)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let i=new Map;for(let n of t){let a=tt(n.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let o of a){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,n)}}return new s({typeName:P.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...L(r)})}};function va(s,e){let t=qe(s),r=qe(e);if(s===e)return{valid:!0,data:s};if(t===x.object&&r===x.object){let i=F.objectKeys(e),n=F.objectKeys(s).filter(o=>i.indexOf(o)!==-1),a={...s,...e};for(let o of n){let l=va(s[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(t===x.array&&r===x.array){if(s.length!==e.length)return{valid:!1};let i=[];for(let n=0;n<s.length;n++){let a=s[n],o=e[n],l=va(a,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return t===x.date&&r===x.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}var Ft=class extends ${_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=(n,a)=>{if(zr(n)||zr(a))return C;let o=va(n.value,a.value);return o.valid?((Wr(n)||Wr(a))&&t.dirty(),{status:t.value,value:o.data}):(w(r,{code:m.invalid_intersection_types}),C)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([n,a])=>i(n,a)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}};Ft.create=(s,e,t)=>new Ft({left:s,right:e,typeName:P.ZodIntersection,...L(t)});var He=class s extends ${_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==x.array)return w(r,{code:m.invalid_type,expected:x.array,received:r.parsedType}),C;if(r.data.length<this._def.items.length)return w(r,{code:m.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),C;!this._def.rest&&r.data.length>this._def.items.length&&(w(r,{code:m.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let n=[...r.data].map((a,o)=>{let l=this._def.items[o]||this._def.rest;return l?l._parse(new Re(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(n).then(a=>se.mergeArray(t,a)):se.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new s({...this._def,rest:e})}};He.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new He({items:s,typeName:P.ZodTuple,rest:null,...L(e)})};var Gr=class s extends ${get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==x.object)return w(r,{code:m.invalid_type,expected:x.object,received:r.parsedType}),C;let i=[],n=this._def.keyType,a=this._def.valueType;for(let o in r.data)i.push({key:n._parse(new Re(r,o,r.path,o)),value:a._parse(new Re(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?se.mergeObjectAsync(t,i):se.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof $?new s({keyType:e,valueType:t,typeName:P.ZodRecord,...L(r)}):new s({keyType:_t.create(),valueType:e,typeName:P.ZodRecord,...L(t)})}},fs=class extends ${get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==x.map)return w(r,{code:m.invalid_type,expected:x.map,received:r.parsedType}),C;let i=this._def.keyType,n=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:i._parse(new Re(r,o,r.path,[c,"key"])),value:n._parse(new Re(r,l,r.path,[c,"value"]))}));if(r.common.async){let o=new Map;return Promise.resolve().then(async()=>{for(let l of a){let c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return C;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(c.value,u.value)}return{status:t.value,value:o}})}else{let o=new Map;for(let l of a){let c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return C;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(c.value,u.value)}return{status:t.value,value:o}}}};fs.create=(s,e,t)=>new fs({valueType:e,keyType:s,typeName:P.ZodMap,...L(t)});var gs=class s extends ${_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==x.set)return w(r,{code:m.invalid_type,expected:x.set,received:r.parsedType}),C;let i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(w(r,{code:m.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(w(r,{code:m.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());let n=this._def.valueType;function a(l){let c=new Set;for(let u of l){if(u.status==="aborted")return C;u.status==="dirty"&&t.dirty(),c.add(u.value)}return{status:t.value,value:c}}let o=[...r.data.values()].map((l,c)=>n._parse(new Re(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,t){return new s({...this._def,minSize:{value:e,message:T.toString(t)}})}max(e,t){return new s({...this._def,maxSize:{value:e,message:T.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};gs.create=(s,e)=>new gs({valueType:s,minSize:null,maxSize:null,typeName:P.ZodSet,...L(e)});var Zr=class s extends ${constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==x.function)return w(t,{code:m.invalid_type,expected:x.function,received:t.parsedType}),C;function r(o,l){return Hs({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,cs(),et].filter(c=>!!c),issueData:{code:m.invalid_arguments,argumentsError:l}})}function i(o,l){return Hs({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,cs(),et].filter(c=>!!c),issueData:{code:m.invalid_return_type,returnTypeError:l}})}let n={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof bt){let o=this;return ne(async function(...l){let c=new pe([]),u=await o._def.args.parseAsync(l,n).catch(p=>{throw c.addIssue(r(l,p)),c}),d=await Reflect.apply(a,this,u);return await o._def.returns._def.type.parseAsync(d,n).catch(p=>{throw c.addIssue(i(d,p)),c})})}else{let o=this;return ne(function(...l){let c=o._def.args.safeParse(l,n);if(!c.success)throw new pe([r(l,c.error)]);let u=Reflect.apply(a,this,c.data),d=o._def.returns.safeParse(u,n);if(!d.success)throw new pe([i(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new s({...this._def,args:He.create(e).rest(st.create())})}returns(e){return new s({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new s({args:e||He.create([]).rest(st.create()),returns:t||st.create(),typeName:P.ZodFunction,...L(r)})}},jt=class extends ${get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};jt.create=(s,e)=>new jt({getter:s,typeName:P.ZodLazy,...L(e)});var Ut=class extends ${_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return w(t,{received:t.data,code:m.invalid_literal,expected:this._def.value}),C}return{status:"valid",value:e.data}}get value(){return this._def.value}};Ut.create=(s,e)=>new Ut({value:s,typeName:P.ZodLiteral,...L(e)});function fc(s,e){return new Bt({values:s,typeName:P.ZodEnum,...L(e)})}var Bt=class s extends ${_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),r=this._def.values;return w(t,{expected:F.joinValues(r),received:t.parsedType,code:m.invalid_type}),C}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return w(t,{received:t.data,code:m.invalid_enum_value,options:r}),C}return ne(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return s.create(e,{...this._def,...t})}exclude(e,t=this._def){return s.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}};Bt.create=fc;var qt=class extends ${_parse(e){let t=F.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==x.string&&r.parsedType!==x.number){let i=F.objectValues(t);return w(r,{expected:F.joinValues(i),received:r.parsedType,code:m.invalid_type}),C}if(this._cache||(this._cache=new Set(F.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let i=F.objectValues(t);return w(r,{received:r.data,code:m.invalid_enum_value,options:i}),C}return ne(e.data)}get enum(){return this._def.values}};qt.create=(s,e)=>new qt({values:s,typeName:P.ZodNativeEnum,...L(e)});var bt=class extends ${unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==x.promise&&t.common.async===!1)return w(t,{code:m.invalid_type,expected:x.promise,received:t.parsedType}),C;let r=t.parsedType===x.promise?t.data:Promise.resolve(t.data);return ne(r.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}};bt.create=(s,e)=>new bt({type:s,typeName:P.ZodPromise,...L(e)});var Ce=class extends ${innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===P.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,n={addIssue:a=>{w(r,a),a.fatal?t.abort():t.dirty()},get path(){return r.path}};if(n.addIssue=n.addIssue.bind(n),i.type==="preprocess"){let a=i.transform(r.data,n);if(r.common.async)return Promise.resolve(a).then(async o=>{if(t.value==="aborted")return C;let l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?C:l.status==="dirty"?It(l.value):t.value==="dirty"?It(l.value):l});{if(t.value==="aborted")return C;let o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?C:o.status==="dirty"?It(o.value):t.value==="dirty"?It(o.value):o}}if(i.type==="refinement"){let a=o=>{let l=i.refinement(o,n);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){let o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?C:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?C:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(i.type==="transform")if(r.common.async===!1){let a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!mt(a))return C;let o=i.transform(a.value,n);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>mt(a)?Promise.resolve(i.transform(a.value,n)).then(o=>({status:t.value,value:o})):C);F.assertNever(i)}};Ce.create=(s,e,t)=>new Ce({schema:s,typeName:P.ZodEffects,effect:e,...L(t)});Ce.createWithPreprocess=(s,e,t)=>new Ce({schema:e,effect:{type:"preprocess",transform:s},typeName:P.ZodEffects,...L(t)});var Te=class extends ${_parse(e){return this._getType(e)===x.undefined?ne(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Te.create=(s,e)=>new Te({innerType:s,typeName:P.ZodOptional,...L(e)});var ze=class extends ${_parse(e){return this._getType(e)===x.null?ne(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ze.create=(s,e)=>new ze({innerType:s,typeName:P.ZodNullable,...L(e)});var Ht=class extends ${_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===x.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};Ht.create=(s,e)=>new Ht({innerType:s,typeName:P.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...L(e)});var zt=class extends ${_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return us(i)?i.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new pe(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new pe(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}};zt.create=(s,e)=>new zt({innerType:s,typeName:P.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...L(e)});var vs=class extends ${_parse(e){if(this._getType(e)!==x.nan){let r=this._getOrReturnCtx(e);return w(r,{code:m.invalid_type,expected:x.nan,received:r.parsedType}),C}return{status:"valid",value:e.data}}};vs.create=s=>new vs({typeName:P.ZodNaN,...L(s)});var mh=Symbol("zod_brand"),zs=class extends ${_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}},Ws=class s extends ${_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return n.status==="aborted"?C:n.status==="dirty"?(t.dirty(),It(n.value)):this._def.out._parseAsync({data:n.value,path:r.path,parent:r})})();{let i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?C:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,t){return new s({in:e,out:t,typeName:P.ZodPipeline})}},Wt=class extends ${_parse(e){let t=this._def.innerType._parse(e),r=i=>(mt(i)&&(i.value=Object.freeze(i.value)),i);return us(t)?t.then(i=>r(i)):r(t)}unwrap(){return this._def.innerType}};Wt.create=(s,e)=>new Wt({innerType:s,typeName:P.ZodReadonly,...L(e)});function uc(s,e){let t=typeof s=="function"?s(e):typeof s=="string"?{message:s}:s;return typeof t=="string"?{message:t}:t}function gc(s,e={},t){return s?yt.create().superRefine((r,i)=>{let n=s(r);if(n instanceof Promise)return n.then(a=>{if(!a){let o=uc(e,r),l=o.fatal??t??!0;i.addIssue({code:"custom",...o,fatal:l})}});if(!n){let a=uc(e,r),o=a.fatal??t??!0;i.addIssue({code:"custom",...a,fatal:o})}}):yt.create()}var _h={object:fe.lazycreate},P;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(P||(P={}));var yh=(s,e={message:`Input not instance of ${s.name}`})=>gc(t=>t instanceof s,e),vc=_t.create,mc=Pt.create,bh=vs.create,wh=Ot.create,_c=Dt.create,Eh=Mt.create,xh=hs.create,kh=Lt.create,Sh=$t.create,Th=yt.create,Rh=st.create,Ch=Oe.create,Ah=ps.create,Ih=rt.create,Ph=fe.create,Oh=fe.strictCreate,Dh=Nt.create,Mh=Vr.create,Lh=Ft.create,$h=He.create,Nh=Gr.create,Fh=fs.create,jh=gs.create,Uh=Zr.create,Bh=jt.create,qh=Ut.create,Hh=Bt.create,zh=qt.create,Wh=bt.create,Vh=Ce.create,Gh=Te.create,Zh=ze.create,Yh=Ce.createWithPreprocess,Jh=Ws.create,Xh=()=>vc().optional(),Qh=()=>mc().optional(),Kh=()=>_c().optional(),ep={string:s=>_t.create({...s,coerce:!0}),number:s=>Pt.create({...s,coerce:!0}),boolean:s=>Dt.create({...s,coerce:!0}),bigint:s=>Ot.create({...s,coerce:!0}),date:s=>Mt.create({...s,coerce:!0})};var tp=C;var Zf=Vs.object({token:Vs.string().optional()});function Gs(s){let e=[];return JSON.stringify(s,(t,r)=>(e.push(t),r)),e.sort(),JSON.stringify(s,e)}function Yr(s,e){if(s===e)return!0;if(!s||!e)return!1;try{return Gs(s)===Gs(e)}catch{return JSON.stringify(s)===JSON.stringify(e)}}function ms(s,e,t={preserveNull:!1}){if(e===null)return Object.keys(s).length===0?s:{};if(!Jr(e)||Object.keys(e).length===0)return s;let r=!1,i={};for(let n in s)Object.prototype.hasOwnProperty.call(s,n)&&!Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=s[n]);for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let a=e[n],o=s[n];if(a===null&&!t.preserveNull){r=!0;continue}else if(a===null&&t.preserveNull){r=!0,i[n]=null;continue}if(!Jr(a))a!==o?(r=!0,i[n]=a):i[n]=o;else if(Jr(a))if(Jr(o)){let l=ms(o,a,t);l!==o&&(r=!0),i[n]=l}else r=!0,i[n]=ms({},a,t)}return r?i:s}function Jr(s){return s!==null&&typeof s=="object"&&!Array.isArray(s)}var sp=["close","error","message","open"];function rp(s){return sp.includes(s)}var ip=[];function np(s){let e={get(t,r,i){return r==="then"?(n,a)=>new Promise(l=>{let c=s.subscribe(u=>{l(u),queueMicrotask(()=>c())})}).then(n,a):Reflect.get(t,r,i)}};return new Proxy(s,e)}var Qr=class s extends EventTarget{CONNECTING=0;OPEN=1;CLOSING=2;CLOSED=3;binaryType="arraybuffer";bufferedAmount=0;extensions="";protocol="ws";readyState=this.CONNECTING;url="";_client={id:"",avatarUrl:"",username:""};static _requestIdPrefix=Math.random().toString(36).substring(2,6);static _requestIdCounter=0;static _pendingRequests=new Map;static _connectedPeers={};static _peersSubscriptions=new Set;static _presenceData={};static _presenceDataRef=null;static _presenceSubscriptions=new Set;static _collectionCaches=new Map;static _collectionEmptyListCaches=new Map;static _pendingCacheFetches=new Map;static _filteredCollections=new Map;static _filteredSubscriptions=new Map;static _roomState={};static _roomStateRef=null;static _roomStateSubscriptions=new Set;static _instance=null;_presenceThrottleTimeout=null;_pendingPresenceUpdates=null;_presenceThrottleMs=16;_roomStateThrottleTimeout=null;_pendingRoomStateUpdates=null;_roomStateThrottleMs=16;_initializePromise=null;static _presenceUpdateRequestSubscriptions=new Set;static _querySubscriptions=new Map;static _queryCaches=new Map;static _queryEmptyListCaches=new Map;static _pendingQueryFetches=new Map;static _queryAPIs=new Map;schema=null;constructor(e){if(s._instance)return s._instance;super(),this.createDatabaseRecord=this.createDatabaseRecord.bind(this),this.updateDatabaseRecord=this.updateDatabaseRecord.bind(this),this.upsertDatabaseRecord=this.upsertDatabaseRecord.bind(this),this.getDatabaseRecords=this.getDatabaseRecords.bind(this),this.deleteDatabaseRecord=this.deleteDatabaseRecord.bind(this),s._instance=this,this._initializePromise=this._initialize()}accept(){}serializeAttachment(){}deserializeAttachment(){}onclose=null;onerror=null;onmessage=null;onopen=null;dispatchEvent(e){return rp(e.type)&&this[`on${e.type}`]&&this[`on${e.type}`](e),super.dispatchEvent(e)}onPeersChanged=null;close(e,t){s._filteredSubscriptions.clear(),s._presenceSubscriptions.clear()}send(e){let t=typeof e=="string"?e:JSON.stringify(e);D.sendSocketMessage(t)}get party(){return{client:this._client,peers:s._connectedPeers,subscribe:e=>(s._peersSubscriptions.add(e),e(s._connectedPeers),()=>{s._peersSubscriptions.delete(e)}),get presence(){return s._presenceDataRef||(s._presenceDataRef={...s._presenceData}),s._presenceDataRef},updatePresence:e=>{let t=structuredClone(e);this._updatePresence(t)},subscribePresence:e=>(s._presenceSubscriptions.add(e),s._presenceDataRef||(s._presenceDataRef={...s._presenceData}),e(s._presenceDataRef),()=>{s._presenceSubscriptions.delete(e)}),get roomState(){return s._roomStateRef||(s._roomStateRef={...s._roomState}),s._roomStateRef}}}async _initialize(){try{let e=await D.connectSocket();if(e===null)throw new Error("Failed to connect to socket");let{stream:t,username:r,avatarUrl:i,connectionId:n}=e;this.readyState=this.OPEN,this._client={id:n,avatarUrl:i,username:r},this.dispatchEvent(new Event("open",{bubbles:!1,cancelable:!1})),s._presenceData[n]={},this.handleMessageStream(t),await Promise.all([this.getPresence(),this.getRoomState()])}catch(e){console.error("Error connecting to socket:",e)}}async handleMessageStream(e){let t=e.getReader(),r=new TextDecoder;for(;;){let{done:i,value:n}=await t.read();if(i)break;let a=JSON.parse(r.decode(n));if(a.requestId!==void 0){let o=s._pendingRequests.get(a.requestId);o&&(o(a.data),s._pendingRequests.delete(a.requestId))}switch(a.type){case"BUILTIN:GET_CONNECTED_CLIENTS":s._connectedPeers=a.clients,this.onPeersChanged?.(s._connectedPeers),s._peersSubscriptions.forEach(o=>o(s._connectedPeers));break;case"connected":s._connectedPeers[a.clientId]={avatarUrl:a.avatarUrl,username:a.username},s._presenceData[a.clientId]={},this.onPeersChanged?.(s._connectedPeers),s._peersSubscriptions.forEach(o=>o(s._connectedPeers));break;case"disconnected":delete s._connectedPeers[a.clientId],delete s._presenceData[a.clientId],this.onPeersChanged?.(s._connectedPeers),s._peersSubscriptions.forEach(o=>o(s._connectedPeers)),s._presenceSubscriptions.forEach(o=>o(s._presenceData));break;case"presence_updated":{let o=s._presenceData[a.clientId],l=a.presence;Yr(o,l)||(s._presenceData[a.clientId]=l,s._presenceDataRef={...s._presenceData},s._presenceSubscriptions.forEach(c=>{s._presenceDataRef&&c(s._presenceDataRef)}));break}case"PRESENCE:GET":{Yr(s._presenceData,a.presence)||(s._presenceData=a.presence,s._presenceDataRef={...s._presenceData},s._presenceSubscriptions.forEach(o=>{s._presenceDataRef&&o(s._presenceDataRef)}));break}case"reset":window.location.reload();break;case"schema_registered":a.data&&(this.schema=s.getExpandedSchema(a.data));break;case"RECORD:LIST":break;case"RECORD:QUERY":{let{query:o,params:l,data:c}=a,u=`${o}:${JSON.stringify(l??[])}`;s._queryCaches.set(u,c);let d=s._querySubscriptions.get(u);d&&d.forEach(h=>h(c))}break;case"RECORD:CREATE":this.handleSubscription({action:"create",record:a.data});break;case"RECORD:DELETE":this.handleSubscription({action:"delete",record:a.data});break;case"RECORD:UPDATE":this.handleSubscription({action:"update",record:a.data});break;case"RECORD:UPSERT":this.handleSubscription({action:"upsert",record:a.data});break;case"BUILTIN:REQUEST_ERROR":if(a.error=="Your message contains content that is not allowed."||a.error=="Anonymous users can only perform read operations")break;{let o=new Error(a.error);throw typeof window<"u"&&window.dispatchEvent(new ErrorEvent("error",{message:o.message,error:o})),o}case"room_state_updated":{let o=ms(s._roomState,a.state);s._roomState!==o&&(s._roomState=o,s._roomStateRef={...s._roomState},s._roomStateSubscriptions.forEach(l=>{s._roomStateRef&&l(s._roomStateRef)}));break}case"ROOM_STATE:GET":{s._roomState!==a.state&&(s._roomState=a.state,s._roomStateRef={...s._roomState},s._roomStateSubscriptions.forEach(o=>{s._roomStateRef&&o(s._roomStateRef)}));break}case"presence_update_requested":{s._presenceUpdateRequestSubscriptions.forEach(o=>{o(a.updateRequest,a.fromClientId)});break}default:{let o=new MessageEvent("message",{data:a,bubbles:!1,cancelable:!1});this.dispatchEvent(o);break}}}}handleSubscription({action:e,record:t}){let r=t.$type;s._collectionCaches.forEach((i,n)=>{if(n.startsWith(`${r}:`)){let a=n.substring(r.length+1),o=JSON.parse(a),l=this.applyFilters([t],o).length>0,c=i,u=!1;switch(e){case"create":l&&(c=[t,...c],u=!0);break;case"update":c.some(d=>d.id===t.id)?(l?c=c.map(d=>d.id===t.id?t:d):c=c.filter(d=>d.id!==t.id),u=!0):l&&(c=[t,...c],u=!0);break;case"upsert":{let d=c.findIndex(h=>h.id===t.id);d!==-1?(l?c[d]=t:c=c.filter(h=>h.id!==t.id),u=!0):l&&(c=[t,...c],u=!0);break}case"delete":c.some(d=>d.id===t.id)&&(c=c.filter(d=>d.id!==t.id),u=!0);break}if(u){s._collectionCaches.set(n,c);let d=s._filteredSubscriptions.get(n);d&&d.forEach(h=>h(c))}}})}async createDatabaseRecord(e){let{$type:t,...r}=e;return await this._sendRequest("RECORD:CREATE",{$type:t,data:r})}async updateDatabaseRecord(e,t){return await this._sendRequest("RECORD:UPDATE",{id:e,data:t})}async upsertDatabaseRecord(e,t){return await this._sendRequest("RECORD:UPSERT",{$type:e,data:t})}async deleteDatabaseRecord(e,t){await this._sendRequest("RECORD:DELETE",{id:e,$type:t})}async getDatabaseRecords({$type:e,...t}={}){return await this._sendRequest("RECORD:LIST",{$type:e,filters:t})}async getDatabaseQuery(e,t){return await this._sendRequest("RECORD:QUERY",{query:e,params:t,schema:this.schema})}_sendRequest(e,t,r=!0){let i=s._requestIdPrefix+s._requestIdCounter++;return new Promise((n,a)=>{r&&s._pendingRequests.set(i,n),this.send({requestId:i,type:e,payload:t}),r||n(null),setTimeout(()=>{s._pendingRequests.has(i)&&(s._pendingRequests.delete(i),a(new Error(`Request timed out for requestId ${i}`)))},3e4)})}query(e,t=[]){let r=`${e}:${JSON.stringify(t)}`;if(s._queryAPIs.has(r))return s._queryAPIs.get(r);let i=()=>{let u=s._queryCaches.get(r);if(u)return u;let d=s._queryEmptyListCaches.get(r);if(d)return d;let h=Xr([],a);return s._queryEmptyListCaches.set(r,h),h},n=async()=>await this.getDatabaseQuery(e,t),a=()=>{if(s._pendingQueryFetches.has(r))return s._pendingQueryFetches.get(r);let u=n();return s._pendingQueryFetches.set(r,u),u.then(d=>(s._pendingQueryFetches.delete(r),d)).catch(d=>{throw s._pendingQueryFetches.delete(r),d})},c=np({getList:i,subscribe:u=>{let d=s._querySubscriptions.get(r);d||(d=new Set,s._querySubscriptions.set(r,d)),d.add(u),d.size===1&&this._sendRequest("RECORD:QUERY_SUBSCRIBE",{query:e,params:t,schema:this.schema},!1);let h=s._queryCaches.get(r);return h?u(h):s._pendingQueryFetches.has(r)||a().then(p=>{let g=Array.isArray(p)?p:[];s._queryCaches.set(r,Xr(g,a));let v=s._querySubscriptions.get(r);return v&&v.forEach(_=>_(g)),g}).catch(p=>{console.error(`Error fetching data for query "${e}" with params ${JSON.stringify(t)}:`,p);let g=s._querySubscriptions.get(r);throw g&&g.forEach(v=>v(ip)),p}),()=>{let p=s._querySubscriptions.get(r);p&&(p.delete(u),p.size===0&&(this._sendRequest("RECORD:QUERY_UNSUBSCRIBE",{query:e,params:t},!1),s._querySubscriptions.delete(r),s._pendingQueryFetches.delete(r)))}}});return s._queryAPIs.set(r,c),c}collection(e){let t=(r={})=>{let i=Gs(r),n=`${e}:${i}`;if(s._filteredCollections.has(n))return s._filteredCollections.get(n);let a=()=>{let d=s._collectionCaches.get(n);if(d)return d;let h=s._collectionEmptyListCaches.get(n);if(h)return h;let p=Xr([],l);return s._collectionEmptyListCaches.set(n,p),p},o=async()=>await this.getDatabaseRecords({$type:e,...r}),l=()=>{if(s._pendingCacheFetches.has(n))return s._pendingCacheFetches.get(n);let d=o();return s._pendingCacheFetches.set(n,d),d.then(h=>(s._pendingCacheFetches.delete(n),h))},u={getList:a,create:async d=>{try{return await this.createDatabaseRecord({$type:e,...d})}catch(h){throw console.error("Error creating database record",h),h}},update:async(d,h)=>await this.updateDatabaseRecord(d,h),upsert:async d=>await this.upsertDatabaseRecord(e,d),delete:async d=>{await this.deleteDatabaseRecord(d,e)},subscribe:d=>{let h=s._filteredSubscriptions.get(n);h||(h=new Set,s._filteredSubscriptions.set(n,h)),h.add(d);let p=s._collectionCaches.get(n);return p?d(p):s._pendingCacheFetches.has(n)||l().then(g=>{s._collectionCaches.set(n,Xr(g,l));let v=s._filteredSubscriptions.get(n);v&&v.forEach(_=>_(g))}),()=>{h.delete(d),h.size===0&&s._filteredSubscriptions.delete(n)}},filter:d=>t({...r,...d})};return s._filteredCollections.set(n,u),u};return t()}applyFilters(e,t){return e.filter(r=>Object.entries(t).every(([i,n])=>{let a=r[i];return n==null?a==null:a==n}))}async _updatePresence(e){let t=this._client.id,r=s._presenceData[t]||{},i={...r,...e};Yr(r,i)||(s._presenceData[t]=i,s._presenceDataRef={...s._presenceData},s._presenceSubscriptions.forEach(n=>{s._presenceDataRef&&n(s._presenceDataRef)}),this._presenceThrottleTimeout===null?(this._sendPresenceToServer(e),this._startThrottleCycle()):(this._pendingPresenceUpdates||(this._pendingPresenceUpdates={}),this._pendingPresenceUpdates={...this._pendingPresenceUpdates,...e}))}_startThrottleCycle(){this._pendingPresenceUpdates={},this._presenceThrottleTimeout=window.setTimeout(()=>{let e=this._pendingPresenceUpdates;this._presenceThrottleTimeout=null,this._pendingPresenceUpdates=null,e&&Object.keys(e).length>0&&(this._sendPresenceToServer(e),this._startThrottleCycle())},this._presenceThrottleMs)}async _sendPresenceToServer(e){await this._sendRequest("PRESENCE:UPDATE",{presence:e},!1)}async getPresence(){await this._sendRequest("PRESENCE:GET",{})}async updateRoomState(e){let t=s._roomState,r=ms(t,e);s._roomState=r,s._roomStateRef={...s._roomState},s._roomStateSubscriptions.forEach(i=>{s._roomStateRef&&i(s._roomStateRef)}),this._roomStateThrottleTimeout===null?(this._sendRoomStateToServer(e),this._startRoomStateThrottleCycle()):(this._pendingRoomStateUpdates||(this._pendingRoomStateUpdates={}),this._pendingRoomStateUpdates=ms(this._pendingRoomStateUpdates,e,{preserveNull:!0}))}_startRoomStateThrottleCycle(){this._pendingRoomStateUpdates={},this._roomStateThrottleTimeout=window.setTimeout(()=>{let e=this._pendingRoomStateUpdates;this._roomStateThrottleTimeout=null,this._pendingRoomStateUpdates=null,e&&Object.keys(e).length>0&&(this._sendRoomStateToServer(e),this._startRoomStateThrottleCycle())},this._roomStateThrottleMs)}async _sendRoomStateToServer(e){await this._sendRequest("ROOM_STATE:UPDATE",{state:e},!1)}async getRoomState(){await this._sendRequest("ROOM_STATE:GET",{})}get clientId(){return this._client.id}get presence(){return this.party.presence}get roomState(){return this.party.roomState}get peers(){return{...s._connectedPeers,[this.clientId]:{avatarUrl:this._client.avatarUrl,username:this._client.username}}}async initialize(){return this._initializePromise||Promise.reject("WebsimSocket not initialized")}updatePresence(e){this.party.updatePresence(e)}subscribePresence(e){return this.party.subscribePresence(e)}subscribeRoomState(e){return s._roomStateSubscriptions.add(e),s._roomStateRef||(s._roomStateRef={...s._roomState}),e(s._roomStateRef),()=>{s._roomStateSubscriptions.delete(e)}}requestPresenceUpdate(e,t){let r=structuredClone(t);this._sendRequest("PRESENCE:REQUEST_UPDATE",{targetClientId:e,update:r},!1)}subscribePresenceUpdateRequests(e){return s._presenceUpdateRequestSubscriptions.add(e),()=>{s._presenceUpdateRequestSubscriptions.delete(e)}}static getExpandedSchema(e){return{...Object.fromEntries(Object.entries(e).map(([t,r])=>[t,{...r,user_id:"uuid",created_at:"timestamptz",updated_at:"timestamptz"}])),user:{id:"uuid",username:"text",avatar_url:"text",created_at:"timestamptz"}}}describeCollections(e){this.schema=s.getExpandedSchema(e)}};function Xr(s,e){let t={get(r,i,n){return i==="then"?(a,o)=>{let l;try{l=e()}catch(c){return Promise.reject(c).then(a,o)}return Promise.resolve(l).then(a,o)}:Reflect.get(r,i,n)}};return new Proxy(Array.isArray(s)?s:Array.from(s),t)}window.websim||(window.baseUrl=__WEBSIM_DATA__.baseUrl,oc(),__WEBSIM_DATA__.isTopLevelFrame||sc(),Vl(),Ul(),ic(),rc(),ap(),nc(),__WEBSIM_DATA__.isTopLevelFrame||jl(),ea(window.websim),window.WebsimSocket=Qr,tc());document.querySelectorAll("script.websim-injected").forEach(s=>{s.remove()});(async()=>{let s;try{s=await window.websim.getBootstrap()}catch(e){console.error(e)}finally{if(Kn.init("phc_VHMOlrdxAbgSZHeF0SdSf07LZLRLAg5pZuTHkJGn050",{api_host:"https://e.wbsm.ai",ui_host:"https://app.posthog.com",session_recording:{recordCrossOriginIframes:!0},capture_pageview:!1,...s?{bootstrap:{distinctID:s.distinct_id,sessionID:s.session_id}}:{}}),__WEBSIM_DATA__.home&&wa({distinctId:s?.distinct_id,sessionId:s?.session_id,apiOrigin:""}),Nl({distinctId:s?.distinct_id,sessionId:s?.session_id,apiOrigin:""}),__WEBSIM_DATA__.isTopLevelFrame&&Kn.capture("$pageview",{project_id:__WEBSIM_DATA__.project_id,[Ll]:__WEBSIM_DATA__.project_id}),__WEBSIM_DATA__.isTopLevelFrame){let e=await window.websim.getCreatedBy();Zl({author:e??void 0})}}})();function ap(){window.broadcastChannelPatched||(window.BroadcastChannel=Hr,window.broadcastChannelPatched=!0)}})();
//# sourceMappingURL=index.js.map
